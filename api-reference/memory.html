
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
      <meta name="description" content="Documentation for Amazon Bedrock AgentCore, primitives for building and running AI agents">
    
    
    
      <link rel="canonical" href="https://aws.github.io/bedrock-agentcore-starter-toolkit/api-reference/memory.html">
    
    
      <link rel="prev" href="identity.html">
    
    
      <link rel="next" href="tools.html">
    
    
    <link rel="icon" href=".." sizes="any">
    <link rel="icon" href="../assets/images/favicon.png" type="image/svg+xml">
    <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">

    
      
        <title>Memory - Amazon Bedrock AgentCore</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#memory" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Amazon Bedrock AgentCore" class="md-header__button md-logo" aria-label="Amazon Bedrock AgentCore" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Amazon Bedrock AgentCore
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Memory
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aws/bedrock-agentcore-starter-toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../index.html" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../examples/index.html" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://github.com/aws/bedrock-agentcore-sdk-python/blob/main/CONTRIBUTING.md" class="md-tabs__link">
        
  
  
    
  
  Contribute ❤️

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="runtime.html" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Amazon Bedrock AgentCore" class="md-nav__button md-logo" aria-label="Amazon Bedrock AgentCore" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Amazon Bedrock AgentCore
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aws/bedrock-agentcore-starter-toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Runtime
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Runtime
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/runtime/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/runtime/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/runtime/permissions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Permissions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/runtime/async.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Async Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/runtime/notebook.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Notebook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/runtime/a2a.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime A2A Server Deployment
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Gateway
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Gateway
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/gateway/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gateway Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Memory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            Memory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/memory/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Identity
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            Identity
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/identity/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Identity Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" >
        
          
          <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Built-in Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            Built-in Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/builtin-tools/quickstart-browser.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart Browser Tool
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/builtin-tools/quickstart-code-interpreter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart Code Interpreter
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7" >
        
          
          <label class="md-nav__link" for="__nav_1_7" id="__nav_1_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/security/vpc-interface-endpoints.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VPC Interface Endpoints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/security/agentcore-vpc.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AgentCore VPC Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/security/security-vpc-condition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VPC Condition Keys
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8" >
        
          
          <label class="md-nav__link" for="__nav_1_8" id="__nav_1_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Observability
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_8">
            <span class="md-nav__icon md-icon"></span>
            Observability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/observability/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Observability Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9" >
        
          
          <label class="md-nav__link" for="__nav_1_9" id="__nav_1_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Import Agent
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9">
            <span class="md-nav__icon md-icon"></span>
            Import Agent
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/import-agent/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Import Agent Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/import-agent/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Import Agent Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/import-agent/configuration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Import Agent Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/agentcore-quickstart-example.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Transform and Deploy Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/session-management.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Session Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/async-processing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Async Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/gateway-integration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gateway Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/memory_gateway_agent.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory Gateway Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/runtime-framework-agents.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Framework Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/semantic_search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Semantic Search
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/aws/bedrock-agentcore-sdk-python/blob/main/CONTRIBUTING.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contribute ❤️
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Bedrock AgentCore SDK
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Bedrock AgentCore SDK
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="runtime.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="identity.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Identity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Memory
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="memory.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Memory
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory" class="md-nav__link">
    <span class="md-ellipsis">
      memory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="memory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.Actor" class="md-nav__link">
    <span class="md-ellipsis">
      Actor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Actor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.Actor.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.Actor.list_sessions" class="md-nav__link">
    <span class="md-ellipsis">
      list_sessions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient" class="md-nav__link">
    <span class="md-ellipsis">
      MemoryClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MemoryClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__getattr__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.__getattr__--access-any-boto3-method-directly" class="md-nav__link">
    <span class="md-ellipsis">
      Access any boto3 method directly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.__getattr__--these-calls-are-forwarded-to-the-appropriate-boto3-client" class="md-nav__link">
    <span class="md-ellipsis">
      These calls are forwarded to the appropriate boto3 client
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_custom_semantic_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      add_custom_semantic_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_custom_semantic_strategy_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      add_custom_semantic_strategy_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_semantic_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      add_semantic_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_semantic_strategy_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      add_semantic_strategy_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      add_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_summary_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      add_summary_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_summary_strategy_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      add_summary_strategy_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_user_preference_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      add_user_preference_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_user_preference_strategy_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      add_user_preference_strategy_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_blob_event" class="md-nav__link">
    <span class="md-ellipsis">
      create_blob_event
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create_blob_event">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_blob_event--store-binary-data" class="md-nav__link">
    <span class="md-ellipsis">
      Store binary data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_event" class="md-nav__link">
    <span class="md-ellipsis">
      create_event
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create_event">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_event--continue-the-conversation" class="md-nav__link">
    <span class="md-ellipsis">
      Continue the conversation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_event--branch-the-conversation-so-that-the-previous-message-is-not-part-of-the-history" class="md-nav__link">
    <span class="md-ellipsis">
      branch the conversation so that the previous message is not part of the history
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_event--suppose-you-did-not-mean-to-ask-about-the-weather-tomorrow-and-want-to-undo" class="md-nav__link">
    <span class="md-ellipsis">
      (suppose you did not mean to ask about the weather tomorrow and want to undo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_event--that-and-replace-with-a-new-message" class="md-nav__link">
    <span class="md-ellipsis">
      that, and replace with a new message)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_memory" class="md-nav__link">
    <span class="md-ellipsis">
      create_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_memory_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      create_memory_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_or_get_memory" class="md-nav__link">
    <span class="md-ellipsis">
      create_or_get_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.delete_memory" class="md-nav__link">
    <span class="md-ellipsis">
      delete_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.delete_memory_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      delete_memory_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.delete_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      delete_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.fork_conversation" class="md-nav__link">
    <span class="md-ellipsis">
      fork_conversation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.get_conversation_tree" class="md-nav__link">
    <span class="md-ellipsis">
      get_conversation_tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.get_last_k_turns" class="md-nav__link">
    <span class="md-ellipsis">
      get_last_k_turns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.get_memory_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_memory_status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.get_memory_strategies" class="md-nav__link">
    <span class="md-ellipsis">
      get_memory_strategies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_branch_events" class="md-nav__link">
    <span class="md-ellipsis">
      list_branch_events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_branches" class="md-nav__link">
    <span class="md-ellipsis">
      list_branches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_events" class="md-nav__link">
    <span class="md-ellipsis">
      list_events
    </span>
  </a>
  
    <nav class="md-nav" aria-label="list_events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_events--get-all-events" class="md-nav__link">
    <span class="md-ellipsis">
      Get all events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_events--get-only-main-branch-events" class="md-nav__link">
    <span class="md-ellipsis">
      Get only main branch events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_events--get-events-from-a-specific-branch" class="md-nav__link">
    <span class="md-ellipsis">
      Get events from a specific branch
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_memories" class="md-nav__link">
    <span class="md-ellipsis">
      list_memories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.merge_branch_context" class="md-nav__link">
    <span class="md-ellipsis">
      merge_branch_context
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.modify_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      modify_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.process_turn" class="md-nav__link">
    <span class="md-ellipsis">
      process_turn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.process_turn_with_llm" class="md-nav__link">
    <span class="md-ellipsis">
      process_turn_with_llm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.retrieve_memories" class="md-nav__link">
    <span class="md-ellipsis">
      retrieve_memories
    </span>
  </a>
  
    <nav class="md-nav" aria-label="retrieve_memories">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.retrieve_memories--correct-exact-namespace" class="md-nav__link">
    <span class="md-ellipsis">
      Correct - exact namespace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.retrieve_memories--incorrect-wildcards-not-supported" class="md-nav__link">
    <span class="md-ellipsis">
      Incorrect - wildcards not supported
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.retrieve_memories--memories-clientretrieve_memories-namespacesupportfacts" class="md-nav__link">
    <span class="md-ellipsis">
      memories = client.retrieve_memories(..., namespace="support/facts/*", ...)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.save_conversation" class="md-nav__link">
    <span class="md-ellipsis">
      save_conversation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="save_conversation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.save_conversation--save-multi-turn-conversation" class="md-nav__link">
    <span class="md-ellipsis">
      Save multi-turn conversation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.save_conversation--continue-existing-branch-only-name-required" class="md-nav__link">
    <span class="md-ellipsis">
      Continue existing branch (only name required)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.save_turn" class="md-nav__link">
    <span class="md-ellipsis">
      save_turn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.update_memory_strategies" class="md-nav__link">
    <span class="md-ellipsis">
      update_memory_strategies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.update_memory_strategies_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      update_memory_strategies_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.wait_for_memories" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_memories
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient" class="md-nav__link">
    <span class="md-ellipsis">
      MemoryControlPlaneClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MemoryControlPlaneClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.add_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      add_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.create_memory" class="md-nav__link">
    <span class="md-ellipsis">
      create_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.delete_memory" class="md-nav__link">
    <span class="md-ellipsis">
      delete_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.get_memory" class="md-nav__link">
    <span class="md-ellipsis">
      get_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.get_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      get_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.list_memories" class="md-nav__link">
    <span class="md-ellipsis">
      list_memories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.remove_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      remove_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.update_memory" class="md-nav__link">
    <span class="md-ellipsis">
      update_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.update_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      update_strategy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession" class="md-nav__link">
    <span class="md-ellipsis">
      MemorySession
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MemorySession">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.add_turns" class="md-nav__link">
    <span class="md-ellipsis">
      add_turns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.delete_event" class="md-nav__link">
    <span class="md-ellipsis">
      delete_event
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.delete_memory_record" class="md-nav__link">
    <span class="md-ellipsis">
      delete_memory_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.fork_conversation" class="md-nav__link">
    <span class="md-ellipsis">
      fork_conversation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.get_actor" class="md-nav__link">
    <span class="md-ellipsis">
      get_actor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.get_event" class="md-nav__link">
    <span class="md-ellipsis">
      get_event
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.get_last_k_turns" class="md-nav__link">
    <span class="md-ellipsis">
      get_last_k_turns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.get_memory_record" class="md-nav__link">
    <span class="md-ellipsis">
      get_memory_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.list_actors" class="md-nav__link">
    <span class="md-ellipsis">
      list_actors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.list_branches" class="md-nav__link">
    <span class="md-ellipsis">
      list_branches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.list_events" class="md-nav__link">
    <span class="md-ellipsis">
      list_events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.list_long_term_memory_records" class="md-nav__link">
    <span class="md-ellipsis">
      list_long_term_memory_records
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.process_turn_with_llm" class="md-nav__link">
    <span class="md-ellipsis">
      process_turn_with_llm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.process_turn_with_llm_async" class="md-nav__link">
    <span class="md-ellipsis">
      process_turn_with_llm_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.search_long_term_memories" class="md-nav__link">
    <span class="md-ellipsis">
      search_long_term_memories
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager" class="md-nav__link">
    <span class="md-ellipsis">
      MemorySessionManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MemorySessionManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__getattr__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.__getattr__--access-any-boto3-method-directly" class="md-nav__link">
    <span class="md-ellipsis">
      Access any boto3 method directly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.__getattr__--these-calls-are-forwarded-to-the-appropriate-boto3-functions" class="md-nav__link">
    <span class="md-ellipsis">
      These calls are forwarded to the appropriate boto3 functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.add_turns" class="md-nav__link">
    <span class="md-ellipsis">
      add_turns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.create_memory_session" class="md-nav__link">
    <span class="md-ellipsis">
      create_memory_session
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.delete_event" class="md-nav__link">
    <span class="md-ellipsis">
      delete_event
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.delete_memory_record" class="md-nav__link">
    <span class="md-ellipsis">
      delete_memory_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.fork_conversation" class="md-nav__link">
    <span class="md-ellipsis">
      fork_conversation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.get_event" class="md-nav__link">
    <span class="md-ellipsis">
      get_event
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.get_last_k_turns" class="md-nav__link">
    <span class="md-ellipsis">
      get_last_k_turns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.get_memory_record" class="md-nav__link">
    <span class="md-ellipsis">
      get_memory_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_actor_sessions" class="md-nav__link">
    <span class="md-ellipsis">
      list_actor_sessions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_actors" class="md-nav__link">
    <span class="md-ellipsis">
      list_actors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_branches" class="md-nav__link">
    <span class="md-ellipsis">
      list_branches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_events" class="md-nav__link">
    <span class="md-ellipsis">
      list_events
    </span>
  </a>
  
    <nav class="md-nav" aria-label="list_events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-all-events" class="md-nav__link">
    <span class="md-ellipsis">
      Get all events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-only-main-branch-events" class="md-nav__link">
    <span class="md-ellipsis">
      Get only main branch events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-events-from-a-specific-branch" class="md-nav__link">
    <span class="md-ellipsis">
      Get events from a specific branch
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Get events from a specific branch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-events-with-event-metadata-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Get events with event metadata filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-events-with-event-metadata-filter-specific-branch-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Get events with event metadata filter + specific branch filter
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_long_term_memory_records" class="md-nav__link">
    <span class="md-ellipsis">
      list_long_term_memory_records
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.process_turn_with_llm" class="md-nav__link">
    <span class="md-ellipsis">
      process_turn_with_llm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.process_turn_with_llm_async" class="md-nav__link">
    <span class="md-ellipsis">
      process_turn_with_llm_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.search_long_term_memories" class="md-nav__link">
    <span class="md-ellipsis">
      search_long_term_memories
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tools.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Built-in Tools
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Bedrock AgentCore Starter Toolkit
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Bedrock AgentCore Starter Toolkit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cli.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AgentCore CLI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory" class="md-nav__link">
    <span class="md-ellipsis">
      memory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="memory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.Actor" class="md-nav__link">
    <span class="md-ellipsis">
      Actor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Actor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.Actor.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.Actor.list_sessions" class="md-nav__link">
    <span class="md-ellipsis">
      list_sessions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient" class="md-nav__link">
    <span class="md-ellipsis">
      MemoryClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MemoryClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__getattr__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.__getattr__--access-any-boto3-method-directly" class="md-nav__link">
    <span class="md-ellipsis">
      Access any boto3 method directly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.__getattr__--these-calls-are-forwarded-to-the-appropriate-boto3-client" class="md-nav__link">
    <span class="md-ellipsis">
      These calls are forwarded to the appropriate boto3 client
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_custom_semantic_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      add_custom_semantic_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_custom_semantic_strategy_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      add_custom_semantic_strategy_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_semantic_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      add_semantic_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_semantic_strategy_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      add_semantic_strategy_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      add_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_summary_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      add_summary_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_summary_strategy_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      add_summary_strategy_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_user_preference_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      add_user_preference_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.add_user_preference_strategy_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      add_user_preference_strategy_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_blob_event" class="md-nav__link">
    <span class="md-ellipsis">
      create_blob_event
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create_blob_event">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_blob_event--store-binary-data" class="md-nav__link">
    <span class="md-ellipsis">
      Store binary data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_event" class="md-nav__link">
    <span class="md-ellipsis">
      create_event
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create_event">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_event--continue-the-conversation" class="md-nav__link">
    <span class="md-ellipsis">
      Continue the conversation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_event--branch-the-conversation-so-that-the-previous-message-is-not-part-of-the-history" class="md-nav__link">
    <span class="md-ellipsis">
      branch the conversation so that the previous message is not part of the history
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_event--suppose-you-did-not-mean-to-ask-about-the-weather-tomorrow-and-want-to-undo" class="md-nav__link">
    <span class="md-ellipsis">
      (suppose you did not mean to ask about the weather tomorrow and want to undo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_event--that-and-replace-with-a-new-message" class="md-nav__link">
    <span class="md-ellipsis">
      that, and replace with a new message)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_memory" class="md-nav__link">
    <span class="md-ellipsis">
      create_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_memory_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      create_memory_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.create_or_get_memory" class="md-nav__link">
    <span class="md-ellipsis">
      create_or_get_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.delete_memory" class="md-nav__link">
    <span class="md-ellipsis">
      delete_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.delete_memory_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      delete_memory_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.delete_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      delete_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.fork_conversation" class="md-nav__link">
    <span class="md-ellipsis">
      fork_conversation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.get_conversation_tree" class="md-nav__link">
    <span class="md-ellipsis">
      get_conversation_tree
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.get_last_k_turns" class="md-nav__link">
    <span class="md-ellipsis">
      get_last_k_turns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.get_memory_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_memory_status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.get_memory_strategies" class="md-nav__link">
    <span class="md-ellipsis">
      get_memory_strategies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_branch_events" class="md-nav__link">
    <span class="md-ellipsis">
      list_branch_events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_branches" class="md-nav__link">
    <span class="md-ellipsis">
      list_branches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_events" class="md-nav__link">
    <span class="md-ellipsis">
      list_events
    </span>
  </a>
  
    <nav class="md-nav" aria-label="list_events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_events--get-all-events" class="md-nav__link">
    <span class="md-ellipsis">
      Get all events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_events--get-only-main-branch-events" class="md-nav__link">
    <span class="md-ellipsis">
      Get only main branch events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_events--get-events-from-a-specific-branch" class="md-nav__link">
    <span class="md-ellipsis">
      Get events from a specific branch
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.list_memories" class="md-nav__link">
    <span class="md-ellipsis">
      list_memories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.merge_branch_context" class="md-nav__link">
    <span class="md-ellipsis">
      merge_branch_context
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.modify_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      modify_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.process_turn" class="md-nav__link">
    <span class="md-ellipsis">
      process_turn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.process_turn_with_llm" class="md-nav__link">
    <span class="md-ellipsis">
      process_turn_with_llm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.retrieve_memories" class="md-nav__link">
    <span class="md-ellipsis">
      retrieve_memories
    </span>
  </a>
  
    <nav class="md-nav" aria-label="retrieve_memories">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.retrieve_memories--correct-exact-namespace" class="md-nav__link">
    <span class="md-ellipsis">
      Correct - exact namespace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.retrieve_memories--incorrect-wildcards-not-supported" class="md-nav__link">
    <span class="md-ellipsis">
      Incorrect - wildcards not supported
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.retrieve_memories--memories-clientretrieve_memories-namespacesupportfacts" class="md-nav__link">
    <span class="md-ellipsis">
      memories = client.retrieve_memories(..., namespace="support/facts/*", ...)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.save_conversation" class="md-nav__link">
    <span class="md-ellipsis">
      save_conversation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="save_conversation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.save_conversation--save-multi-turn-conversation" class="md-nav__link">
    <span class="md-ellipsis">
      Save multi-turn conversation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.save_conversation--continue-existing-branch-only-name-required" class="md-nav__link">
    <span class="md-ellipsis">
      Continue existing branch (only name required)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.save_turn" class="md-nav__link">
    <span class="md-ellipsis">
      save_turn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.update_memory_strategies" class="md-nav__link">
    <span class="md-ellipsis">
      update_memory_strategies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.update_memory_strategies_and_wait" class="md-nav__link">
    <span class="md-ellipsis">
      update_memory_strategies_and_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryClient.wait_for_memories" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_memories
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient" class="md-nav__link">
    <span class="md-ellipsis">
      MemoryControlPlaneClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MemoryControlPlaneClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.add_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      add_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.create_memory" class="md-nav__link">
    <span class="md-ellipsis">
      create_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.delete_memory" class="md-nav__link">
    <span class="md-ellipsis">
      delete_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.get_memory" class="md-nav__link">
    <span class="md-ellipsis">
      get_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.get_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      get_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.list_memories" class="md-nav__link">
    <span class="md-ellipsis">
      list_memories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.remove_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      remove_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.update_memory" class="md-nav__link">
    <span class="md-ellipsis">
      update_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.update_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      update_strategy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession" class="md-nav__link">
    <span class="md-ellipsis">
      MemorySession
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MemorySession">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.add_turns" class="md-nav__link">
    <span class="md-ellipsis">
      add_turns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.delete_event" class="md-nav__link">
    <span class="md-ellipsis">
      delete_event
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.delete_memory_record" class="md-nav__link">
    <span class="md-ellipsis">
      delete_memory_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.fork_conversation" class="md-nav__link">
    <span class="md-ellipsis">
      fork_conversation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.get_actor" class="md-nav__link">
    <span class="md-ellipsis">
      get_actor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.get_event" class="md-nav__link">
    <span class="md-ellipsis">
      get_event
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.get_last_k_turns" class="md-nav__link">
    <span class="md-ellipsis">
      get_last_k_turns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.get_memory_record" class="md-nav__link">
    <span class="md-ellipsis">
      get_memory_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.list_actors" class="md-nav__link">
    <span class="md-ellipsis">
      list_actors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.list_branches" class="md-nav__link">
    <span class="md-ellipsis">
      list_branches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.list_events" class="md-nav__link">
    <span class="md-ellipsis">
      list_events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.list_long_term_memory_records" class="md-nav__link">
    <span class="md-ellipsis">
      list_long_term_memory_records
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.process_turn_with_llm" class="md-nav__link">
    <span class="md-ellipsis">
      process_turn_with_llm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.process_turn_with_llm_async" class="md-nav__link">
    <span class="md-ellipsis">
      process_turn_with_llm_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySession.search_long_term_memories" class="md-nav__link">
    <span class="md-ellipsis">
      search_long_term_memories
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager" class="md-nav__link">
    <span class="md-ellipsis">
      MemorySessionManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MemorySessionManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__getattr__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.__getattr__--access-any-boto3-method-directly" class="md-nav__link">
    <span class="md-ellipsis">
      Access any boto3 method directly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.__getattr__--these-calls-are-forwarded-to-the-appropriate-boto3-functions" class="md-nav__link">
    <span class="md-ellipsis">
      These calls are forwarded to the appropriate boto3 functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.add_turns" class="md-nav__link">
    <span class="md-ellipsis">
      add_turns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.create_memory_session" class="md-nav__link">
    <span class="md-ellipsis">
      create_memory_session
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.delete_event" class="md-nav__link">
    <span class="md-ellipsis">
      delete_event
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.delete_memory_record" class="md-nav__link">
    <span class="md-ellipsis">
      delete_memory_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.fork_conversation" class="md-nav__link">
    <span class="md-ellipsis">
      fork_conversation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.get_event" class="md-nav__link">
    <span class="md-ellipsis">
      get_event
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.get_last_k_turns" class="md-nav__link">
    <span class="md-ellipsis">
      get_last_k_turns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.get_memory_record" class="md-nav__link">
    <span class="md-ellipsis">
      get_memory_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_actor_sessions" class="md-nav__link">
    <span class="md-ellipsis">
      list_actor_sessions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_actors" class="md-nav__link">
    <span class="md-ellipsis">
      list_actors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_branches" class="md-nav__link">
    <span class="md-ellipsis">
      list_branches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_events" class="md-nav__link">
    <span class="md-ellipsis">
      list_events
    </span>
  </a>
  
    <nav class="md-nav" aria-label="list_events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-all-events" class="md-nav__link">
    <span class="md-ellipsis">
      Get all events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-only-main-branch-events" class="md-nav__link">
    <span class="md-ellipsis">
      Get only main branch events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-events-from-a-specific-branch" class="md-nav__link">
    <span class="md-ellipsis">
      Get events from a specific branch
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Get events from a specific branch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-events-with-event-metadata-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Get events with event metadata filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-events-with-event-metadata-filter-specific-branch-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Get events with event metadata filter + specific branch filter
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.list_long_term_memory_records" class="md-nav__link">
    <span class="md-ellipsis">
      list_long_term_memory_records
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.process_turn_with_llm" class="md-nav__link">
    <span class="md-ellipsis">
      process_turn_with_llm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.process_turn_with_llm_async" class="md-nav__link">
    <span class="md-ellipsis">
      process_turn_with_llm_async
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bedrock_agentcore.memory.MemorySessionManager.search_long_term_memories" class="md-nav__link">
    <span class="md-ellipsis">
      search_long_term_memories
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="memory">Memory<a class="headerlink" href="#memory" title="Permanent link">&para;</a></h1>
<p>Memory management for Bedrock AgentCore SDK.</p>


<div class="doc doc-object doc-module">



<h2 id="bedrock_agentcore.memory" class="doc doc-heading">
            <code>bedrock_agentcore.memory</code>


<a href="#bedrock_agentcore.memory" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Bedrock AgentCore Memory module for agent memory management capabilities.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="bedrock_agentcore.memory.Actor" class="doc doc-heading">
            <code>Actor</code>


<a href="#bedrock_agentcore.memory.Actor" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="bedrock_agentcore.memory.models.DictWrapper">DictWrapper</span></code></p>


        <p>Represents an actor within a session.</p>








              <details class="quote">
                <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Actor</span><span class="p">(</span><span class="n">DictWrapper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents an actor within a session.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_manager</span><span class="p">:</span> <span class="n">MemorySessionManager</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Represents an actor within a session.</span>

<span class="sd">        :param actor_id: id of the actor</span>
<span class="sd">        :param session_manager: Behaviour manager for the operations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id</span> <span class="o">=</span> <span class="n">actor_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_manager</span> <span class="o">=</span> <span class="n">session_manager</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_construct_session_dict</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_construct_session_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructs a dictionary representing the actor.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_sessions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">SessionSummary</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to _session_manager.list_actor_sessions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_manager</span><span class="o">.</span><span class="n">list_actor_sessions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.Actor.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_manager</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.Actor.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Represents an actor within a session.</p>
<p>:param actor_id: id of the actor
:param session_manager: Behaviour manager for the operations</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_manager</span><span class="p">:</span> <span class="n">MemorySessionManager</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents an actor within a session.</span>

<span class="sd">    :param actor_id: id of the actor</span>
<span class="sd">    :param session_manager: Behaviour manager for the operations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_id</span> <span class="o">=</span> <span class="n">actor_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_session_manager</span> <span class="o">=</span> <span class="n">session_manager</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_construct_session_dict</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.Actor.list_sessions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_sessions</span><span class="p">()</span></code>

<a href="#bedrock_agentcore.memory.Actor.list_sessions" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to _session_manager.list_actor_sessions.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_sessions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">SessionSummary</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to _session_manager.list_actor_sessions.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_manager</span><span class="o">.</span><span class="n">list_actor_sessions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="bedrock_agentcore.memory.MemoryClient" class="doc doc-heading">
            <code>MemoryClient</code>


<a href="#bedrock_agentcore.memory.MemoryClient" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">


        <p>High-level Bedrock AgentCore Memory client with essential operations.</p>








              <details class="quote">
                <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MemoryClient</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;High-level Bedrock AgentCore Memory client with essential operations.&quot;&quot;&quot;</span>

    <span class="c1"># AgentCore Memory data plane methods</span>
    <span class="n">_ALLOWED_GMDP_METHODS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;retrieve_memory_records&quot;</span><span class="p">,</span>
        <span class="s2">&quot;get_memory_record&quot;</span><span class="p">,</span>
        <span class="s2">&quot;delete_memory_record&quot;</span><span class="p">,</span>
        <span class="s2">&quot;list_memory_records&quot;</span><span class="p">,</span>
        <span class="s2">&quot;create_event&quot;</span><span class="p">,</span>
        <span class="s2">&quot;get_event&quot;</span><span class="p">,</span>
        <span class="s2">&quot;delete_event&quot;</span><span class="p">,</span>
        <span class="s2">&quot;list_events&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># AgentCore Memory control plane methods</span>
    <span class="n">_ALLOWED_GMCP_METHODS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;create_memory&quot;</span><span class="p">,</span>
        <span class="s2">&quot;get_memory&quot;</span><span class="p">,</span>
        <span class="s2">&quot;list_memories&quot;</span><span class="p">,</span>
        <span class="s2">&quot;update_memory&quot;</span><span class="p">,</span>
        <span class="s2">&quot;delete_memory&quot;</span><span class="p">,</span>
        <span class="s2">&quot;list_memory_strategies&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Memory client.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region_name</span> <span class="o">=</span> <span class="n">region_name</span> <span class="ow">or</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span><span class="o">.</span><span class="n">region_name</span> <span class="ow">or</span> <span class="s2">&quot;us-west-2&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;bedrock-agentcore-control&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">region_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;bedrock-agentcore&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">region_name</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Initialized MemoryClient for control plane: </span><span class="si">%s</span><span class="s2">, data plane: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">region_name</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">region_name</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Dynamically forward method calls to the appropriate boto3 client.</span>

<span class="sd">        This method enables access to all boto3 client methods without explicitly</span>
<span class="sd">        defining them. Methods are looked up in the following order:</span>
<span class="sd">        1. gmdp_client (bedrock-agentcore) - for data plane operations</span>
<span class="sd">        2. gmcp_client (bedrock-agentcore-control) - for control plane operations</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The method name being accessed</span>

<span class="sd">        Returns:</span>
<span class="sd">            A callable method from the appropriate boto3 client</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: If the method doesn&#39;t exist on either client</span>

<span class="sd">        Example:</span>
<span class="sd">            # Access any boto3 method directly</span>
<span class="sd">            client = MemoryClient()</span>

<span class="sd">            # These calls are forwarded to the appropriate boto3 client</span>
<span class="sd">            response = client.list_memory_records(memoryId=&quot;mem-123&quot;, namespace=&quot;test&quot;)</span>
<span class="sd">            metadata = client.get_memory_metadata(memoryId=&quot;mem-123&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ALLOWED_GMDP_METHODS</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Forwarding method &#39;</span><span class="si">%s</span><span class="s2">&#39; to gmdp_client&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">method</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ALLOWED_GMCP_METHODS</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Forwarding method &#39;</span><span class="si">%s</span><span class="s2">&#39; to gmcp_client&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">method</span>

        <span class="c1"># Method not found on either client</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Method not found on gmdp_client or gmcp_client. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Available methods can be found in the boto3 documentation for &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;bedrock-agentcore&#39; and &#39;bedrock-agentcore-control&#39; services.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_memory</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_expiry_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span>
        <span class="n">memory_execution_role_arn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a memory with simplified configuration.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">strategies</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">strategies</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">processed_strategies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_default_namespaces</span><span class="p">(</span><span class="n">strategies</span><span class="p">)</span>

            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;eventExpiryDuration&quot;</span><span class="p">:</span> <span class="n">event_expiry_days</span><span class="p">,</span>
                <span class="s2">&quot;memoryStrategies&quot;</span><span class="p">:</span> <span class="n">processed_strategies</span><span class="p">,</span>  <span class="c1"># Using old field name for input</span>
                <span class="s2">&quot;clientToken&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

            <span class="k">if</span> <span class="n">memory_execution_role_arn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;memoryExecutionRoleArn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory_execution_role_arn</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">create_memory</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

            <span class="n">memory</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span>
            <span class="c1"># Normalize response to handle new field names</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_memory_response</span><span class="p">(</span><span class="n">memory</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;memoryId&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">memory</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to create memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_or_get_memory</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_expiry_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span>
        <span class="n">memory_execution_role_arn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a memory resource or fetch the existing memory details if it already exists.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Memory object, either newly created or existing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_memory_and_wait</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">strategies</span><span class="o">=</span><span class="n">strategies</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
                <span class="n">event_expiry_days</span><span class="o">=</span><span class="n">event_expiry_days</span><span class="p">,</span>
                <span class="n">memory_execution_role_arn</span><span class="o">=</span><span class="n">memory_execution_role_arn</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">memory</span>
        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;Error&quot;</span><span class="p">][</span><span class="s2">&quot;Code&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ValidationException&quot;</span> <span class="ow">and</span> <span class="s2">&quot;already exists&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                <span class="n">memories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_memories</span><span class="p">()</span>
                <span class="n">memory</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">memories</span> <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">name</span><span class="p">)),</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Memory already exists. Using existing memory ID: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">memory</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;ClientError: Failed to create or get memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_memory_and_wait</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">strategies</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_expiry_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span>
        <span class="n">memory_execution_role_arn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
        <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a memory and wait for it to become ACTIVE.</span>

<span class="sd">        This method creates a memory and polls until it reaches ACTIVE status,</span>
<span class="sd">        providing a convenient way to ensure the memory is ready for use.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name for the memory resource</span>
<span class="sd">            strategies: List of strategy configurations</span>
<span class="sd">            description: Optional description</span>
<span class="sd">            event_expiry_days: How long to retain events (default: 90 days)</span>
<span class="sd">            memory_execution_role_arn: IAM role ARN for memory execution</span>
<span class="sd">            max_wait: Maximum seconds to wait (default: 300)</span>
<span class="sd">            poll_interval: Seconds between status checks (default: 10)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created memory object in ACTIVE status</span>

<span class="sd">        Raises:</span>
<span class="sd">            TimeoutError: If memory doesn&#39;t become ACTIVE within max_wait</span>
<span class="sd">            RuntimeError: If memory creation fails</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create the memory</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_memory</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">strategies</span><span class="o">=</span><span class="n">strategies</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">event_expiry_days</span><span class="o">=</span><span class="n">event_expiry_days</span><span class="p">,</span>
            <span class="n">memory_execution_role_arn</span><span class="o">=</span><span class="n">memory_execution_role_arn</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">memory_id</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryId&quot;</span><span class="p">,</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">))</span>  <span class="c1"># Handle both field names</span>
        <span class="k">if</span> <span class="n">memory_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">memory_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created memory </span><span class="si">%s</span><span class="s2">, waiting for ACTIVE status...&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">max_wait</span><span class="p">:</span>
            <span class="n">elapsed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory_status</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">MemoryStatus</span><span class="o">.</span><span class="n">ACTIVE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> is now ACTIVE (took </span><span class="si">%d</span><span class="s2"> seconds)&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span>
                    <span class="c1"># Get fresh memory details</span>
                    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>  <span class="c1"># Input uses old field name</span>
                    <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_memory_response</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">])</span>
                    <span class="k">return</span> <span class="n">memory</span>
                <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="n">MemoryStatus</span><span class="o">.</span><span class="n">FAILED</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                    <span class="c1"># Get failure reason if available</span>
                    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>  <span class="c1"># Input uses old field name</span>
                    <span class="n">failure_reason</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;failureReason&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Memory creation failed: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">failure_reason</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Memory status: </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%d</span><span class="s2"> seconds elapsed)&quot;</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error checking memory status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">raise</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> did not become ACTIVE within </span><span class="si">%d</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">retrieve_memories</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve relevant memories from a namespace.</span>

<span class="sd">        Note: Wildcards (*) are NOT supported in namespaces. You must provide the</span>
<span class="sd">        exact namespace path with all variables resolved.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            namespace: Exact namespace path (no wildcards)</span>
<span class="sd">            query: Search query</span>
<span class="sd">            actor_id: Optional actor ID (deprecated, use namespace)</span>
<span class="sd">            top_k: Number of results to return</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of memory records</span>

<span class="sd">        Example:</span>
<span class="sd">            # Correct - exact namespace</span>
<span class="sd">            memories = client.retrieve_memories(</span>
<span class="sd">                memory_id=&quot;mem-123&quot;,</span>
<span class="sd">                namespace=&quot;support/facts/session-456&quot;,</span>
<span class="sd">                query=&quot;customer preferences&quot;</span>
<span class="sd">            )</span>

<span class="sd">            # Incorrect - wildcards not supported</span>
<span class="sd">            # memories = client.retrieve_memories(..., namespace=&quot;support/facts/*&quot;, ...)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;*&quot;</span> <span class="ow">in</span> <span class="n">namespace</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Wildcards are not supported in namespaces. Please provide exact namespace.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Let service handle all namespace validation</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">retrieve_memory_records</span><span class="p">(</span>
                <span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span> <span class="n">searchCriteria</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;searchQuery&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span> <span class="s2">&quot;topK&quot;</span><span class="p">:</span> <span class="n">top_k</span><span class="p">}</span>
            <span class="p">)</span>

            <span class="n">memories</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryRecordSummaries&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieved </span><span class="si">%d</span><span class="s2"> memories from namespace: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">memories</span><span class="p">),</span> <span class="n">namespace</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">memories</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error_code</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;Error&quot;</span><span class="p">][</span><span class="s2">&quot;Code&quot;</span><span class="p">]</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;Error&quot;</span><span class="p">][</span><span class="s2">&quot;Message&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">error_code</span> <span class="o">==</span> <span class="s2">&quot;ResourceNotFoundException&quot;</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Memory or namespace not found. Ensure memory </span><span class="si">%s</span><span class="s2"> exists and namespace &#39;</span><span class="si">%s</span><span class="s2">&#39; is configured&quot;</span><span class="p">,</span>
                    <span class="n">memory_id</span><span class="p">,</span>
                    <span class="n">namespace</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">error_code</span> <span class="o">==</span> <span class="s2">&quot;ValidationException&quot;</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid search parameters: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">error_msg</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">error_code</span> <span class="o">==</span> <span class="s2">&quot;ServiceException&quot;</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Service error: </span><span class="si">%s</span><span class="s2">. This may be temporary - try again later&quot;</span><span class="p">,</span> <span class="n">error_msg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Memory retrieval failed (</span><span class="si">%s</span><span class="s2">): </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">error_code</span><span class="p">,</span> <span class="n">error_msg</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_event</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">branch</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save an event of an agent interaction or conversation with a user.</span>

<span class="sd">        This is the basis of short-term memory. If you configured your Memory resource</span>
<span class="sd">        to have MemoryStrategies, then events that are saved in short-term memory via</span>
<span class="sd">        create_event will be used to extract long-term memory records.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            actor_id: Actor identifier (could be id of your user or an agent)</span>
<span class="sd">            session_id: Session identifier (meant to logically group a series of events)</span>
<span class="sd">            messages: List of (text, role) tuples. Role can be USER, ASSISTANT, TOOL, etc.</span>
<span class="sd">            event_timestamp: timestamp for the entire event (not per message)</span>
<span class="sd">            branch: Optional branch info. For new branches: {&quot;rootEventId&quot;: &quot;...&quot;, &quot;name&quot;: &quot;...&quot;}</span>
<span class="sd">                   For continuing existing branch: {&quot;name&quot;: &quot;...&quot;} or {&quot;name&quot;: &quot;...&quot;, &quot;rootEventId&quot;: &quot;...&quot;}</span>
<span class="sd">                   A branch is used when you want to have a different history of events.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created event</span>

<span class="sd">        Example:</span>
<span class="sd">            event = client.create_event(</span>
<span class="sd">                memory_id=memory.get(&quot;id&quot;),</span>
<span class="sd">                actor_id=&quot;weatherWorrier&quot;,</span>
<span class="sd">                session_id=&quot;WeatherSession&quot;,</span>
<span class="sd">                messages=[</span>
<span class="sd">                    (&quot;What&#39;s the weather?&quot;, &quot;USER&quot;),</span>
<span class="sd">                    (&quot;Today is sunny&quot;, &quot;ASSISTANT&quot;)</span>
<span class="sd">                ]</span>
<span class="sd">            )</span>
<span class="sd">            root_event_id = event.get(&quot;eventId&quot;)</span>
<span class="sd">            print(event)</span>

<span class="sd">            # Continue the conversation</span>
<span class="sd">            event = client.create_event(</span>
<span class="sd">                memory_id=memory.get(&quot;id&quot;),</span>
<span class="sd">                actor_id=&quot;weatherWorrier&quot;,</span>
<span class="sd">                session_id=&quot;WeatherSession&quot;,</span>
<span class="sd">                messages=[</span>
<span class="sd">                    (&quot;How about the weather tomorrow&quot;, &quot;USER&quot;),</span>
<span class="sd">                    (&quot;Tomorrow is cold!&quot;, &quot;ASSISTANT&quot;)</span>
<span class="sd">                ]</span>
<span class="sd">            )</span>
<span class="sd">            print(event)</span>

<span class="sd">            # branch the conversation so that the previous message is not part of the history</span>
<span class="sd">            # (suppose you did not mean to ask about the weather tomorrow and want to undo</span>
<span class="sd">            # that, and replace with a new message)</span>
<span class="sd">            event = client.create_event(</span>
<span class="sd">                memory_id=memory.get(&quot;id&quot;),</span>
<span class="sd">                actor_id=&quot;weatherWorrier&quot;,</span>
<span class="sd">                session_id=&quot;WeatherSession&quot;,</span>
<span class="sd">                branch={&quot;name&quot;: &quot;differentWeatherQuestion&quot;, &quot;rootEventId&quot;: root_event_id},</span>
<span class="sd">                messages=[</span>
<span class="sd">                    (&quot;How about the weather a year from now&quot;, &quot;USER&quot;),</span>
<span class="sd">                    (&quot;I can&#39;t predict that far into the future!&quot;, &quot;ASSISTANT&quot;)</span>
<span class="sd">                ]</span>
<span class="sd">            )</span>
<span class="sd">            print(event)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">messages</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one message is required&quot;</span><span class="p">)</span>

            <span class="n">payload</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each message must be (text, role)&quot;</span><span class="p">)</span>

                <span class="n">text</span><span class="p">,</span> <span class="n">role</span> <span class="o">=</span> <span class="n">msg</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">role_enum</span> <span class="o">=</span> <span class="n">MessageRole</span><span class="p">(</span><span class="n">role</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Invalid role &#39;</span><span class="si">%s</span><span class="s2">&#39;. Must be one of: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">role</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">MessageRole</span><span class="p">]))</span>
                    <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>

                <span class="n">payload</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;conversational&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">},</span> <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">role_enum</span><span class="o">.</span><span class="n">value</span><span class="p">}})</span>

            <span class="c1"># Use provided timestamp or current time</span>
            <span class="k">if</span> <span class="n">event_timestamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">event_timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span>
                <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
                <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
                <span class="s2">&quot;eventTimestamp&quot;</span><span class="p">:</span> <span class="n">event_timestamp</span><span class="p">,</span>
                <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">branch</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;branch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

            <span class="n">event</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;event&quot;</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">event</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to create event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_blob_event</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">blob_data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">branch</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save a blob event to AgentCore Memory.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            actor_id: Actor identifier</span>
<span class="sd">            session_id: Session identifier</span>
<span class="sd">            blob_data: Binary or structured data to store</span>
<span class="sd">            event_timestamp: Optional timestamp for the event</span>
<span class="sd">            branch: Optional branch info</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created event</span>

<span class="sd">        Example:</span>
<span class="sd">            # Store binary data</span>
<span class="sd">            event = client.create_blob_event(</span>
<span class="sd">                memory_id=&quot;mem-xyz&quot;,</span>
<span class="sd">                actor_id=&quot;user-123&quot;,</span>
<span class="sd">                session_id=&quot;session-456&quot;,</span>
<span class="sd">                blob_data={&quot;file_content&quot;: &quot;base64_encoded_data&quot;, &quot;metadata&quot;: {&quot;type&quot;: &quot;image&quot;}}</span>
<span class="sd">            )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;blob&quot;</span><span class="p">:</span> <span class="n">blob_data</span><span class="p">}]</span>

            <span class="k">if</span> <span class="n">event_timestamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">event_timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span>
                <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
                <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
                <span class="s2">&quot;eventTimestamp&quot;</span><span class="p">:</span> <span class="n">event_timestamp</span><span class="p">,</span>
                <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">branch</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;branch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

            <span class="n">event</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;event&quot;</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created blob event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">event</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to create blob event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_conversation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">branch</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;DEPRECATED: Use create_event() instead.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            actor_id: Actor identifier</span>
<span class="sd">            session_id: Session identifier</span>
<span class="sd">            messages: List of (text, role) tuples. Role can be USER, ASSISTANT, TOOL, etc.</span>
<span class="sd">            event_timestamp: Optional timestamp for the entire event (not per message)</span>
<span class="sd">            branch: Optional branch info. For new branches: {&quot;rootEventId&quot;: &quot;...&quot;, &quot;name&quot;: &quot;...&quot;}</span>
<span class="sd">                   For continuing existing branch: {&quot;name&quot;: &quot;...&quot;} or {&quot;name&quot;: &quot;...&quot;, &quot;rootEventId&quot;: &quot;...&quot;}</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created event</span>

<span class="sd">        Example:</span>
<span class="sd">            # Save multi-turn conversation</span>
<span class="sd">            event = client.save_conversation(</span>
<span class="sd">                memory_id=&quot;mem-xyz&quot;,</span>
<span class="sd">                actor_id=&quot;user-123&quot;,</span>
<span class="sd">                session_id=&quot;session-456&quot;,</span>
<span class="sd">                messages=[</span>
<span class="sd">                    (&quot;What&#39;s the weather?&quot;, &quot;USER&quot;),</span>
<span class="sd">                    (&quot;And tomorrow?&quot;, &quot;USER&quot;),</span>
<span class="sd">                    (&quot;Checking weather...&quot;, &quot;TOOL&quot;),</span>
<span class="sd">                    (&quot;Today sunny, tomorrow rain&quot;, &quot;ASSISTANT&quot;)</span>
<span class="sd">                ]</span>
<span class="sd">            )</span>

<span class="sd">            # Continue existing branch (only name required)</span>
<span class="sd">            event = client.save_conversation(</span>
<span class="sd">                memory_id=&quot;mem-xyz&quot;,</span>
<span class="sd">                actor_id=&quot;user-123&quot;,</span>
<span class="sd">                session_id=&quot;session-456&quot;,</span>
<span class="sd">                messages=[(&quot;Continue conversation&quot;, &quot;USER&quot;)],</span>
<span class="sd">                branch={&quot;name&quot;: &quot;existing-branch&quot;}</span>
<span class="sd">            )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">messages</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one message is required&quot;</span><span class="p">)</span>

            <span class="c1"># Build payload</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each message must be (text, role)&quot;</span><span class="p">)</span>

                <span class="n">text</span><span class="p">,</span> <span class="n">role</span> <span class="o">=</span> <span class="n">msg</span>

                <span class="c1"># Validate role</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">role_enum</span> <span class="o">=</span> <span class="n">MessageRole</span><span class="p">(</span><span class="n">role</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Invalid role &#39;</span><span class="si">%s</span><span class="s2">&#39;. Must be one of: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">role</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">MessageRole</span><span class="p">]))</span>
                    <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>

                <span class="n">payload</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;conversational&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">},</span> <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">role_enum</span><span class="o">.</span><span class="n">value</span><span class="p">}})</span>

            <span class="c1"># Use provided timestamp or current time</span>
            <span class="k">if</span> <span class="n">event_timestamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">event_timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span>
                <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
                <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
                <span class="s2">&quot;eventTimestamp&quot;</span><span class="p">:</span> <span class="n">event_timestamp</span><span class="p">,</span>
                <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
                <span class="s2">&quot;clientToken&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">branch</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;branch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

            <span class="n">event</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;event&quot;</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">event</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to create event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_turn</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">agent_response</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;DEPRECATED: Use save_conversation() for more flexibility.</span>

<span class="sd">        This method will be removed in v1.0.0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;save_turn() is deprecated and will be removed in v1.0.0. &quot;</span>
            <span class="s2">&quot;Use save_conversation() for flexible message handling.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">messages</span> <span class="o">=</span> <span class="p">[(</span><span class="n">user_input</span><span class="p">,</span> <span class="s2">&quot;USER&quot;</span><span class="p">),</span> <span class="p">(</span><span class="n">agent_response</span><span class="p">,</span> <span class="s2">&quot;ASSISTANT&quot;</span><span class="p">)]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span>
            <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
            <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
            <span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
            <span class="n">event_timestamp</span><span class="o">=</span><span class="n">event_timestamp</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_turn</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">agent_response</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">retrieval_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">retrieval_query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;DEPRECATED: Use retrieve_memories() and save_conversation() separately.</span>

<span class="sd">        This method will be removed in v1.0.0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;process_turn() is deprecated and will be removed in v1.0.0. &quot;</span>
            <span class="s2">&quot;Use retrieve_memories() and save_conversation() separately, or use process_turn_with_llm().&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">retrieved_memories</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">retrieval_namespace</span><span class="p">:</span>
            <span class="n">search_query</span> <span class="o">=</span> <span class="n">retrieval_query</span> <span class="ow">or</span> <span class="n">user_input</span>
            <span class="n">retrieved_memories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_memories</span><span class="p">(</span>
                <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">retrieval_namespace</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">search_query</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="n">top_k</span>
            <span class="p">)</span>

        <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_turn</span><span class="p">(</span>
            <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
            <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
            <span class="n">user_input</span><span class="o">=</span><span class="n">user_input</span><span class="p">,</span>
            <span class="n">agent_response</span><span class="o">=</span><span class="n">agent_response</span><span class="p">,</span>
            <span class="n">event_timestamp</span><span class="o">=</span><span class="n">event_timestamp</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">retrieved_memories</span><span class="p">,</span> <span class="n">event</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_turn_with_llm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">llm_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">retrieval_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">retrieval_query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Complete conversation turn with LLM callback integration.</span>

<span class="sd">        This method combines memory retrieval, LLM invocation, and response storage</span>
<span class="sd">        in a single call using a callback pattern.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            actor_id: Actor identifier (e.g., &quot;user-123&quot;)</span>
<span class="sd">            session_id: Session identifier</span>
<span class="sd">            user_input: The user&#39;s message</span>
<span class="sd">            llm_callback: Function that takes (user_input, memories) and returns agent_response</span>
<span class="sd">                         The callback receives the user input and retrieved memories,</span>
<span class="sd">                         and should return the agent&#39;s response string</span>
<span class="sd">            retrieval_namespace: Namespace to search for memories (optional)</span>
<span class="sd">            retrieval_query: Custom search query (defaults to user_input)</span>
<span class="sd">            top_k: Number of memories to retrieve</span>
<span class="sd">            event_timestamp: Optional timestamp for the event</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple of (retrieved_memories, agent_response, created_event)</span>

<span class="sd">        Example:</span>
<span class="sd">            def my_llm(user_input: str, memories: List[Dict]) -&gt; str:</span>
<span class="sd">                # Format context from memories</span>
<span class="sd">                context = &quot;\\n&quot;.join([m[&#39;content&#39;][&#39;text&#39;] for m in memories])</span>

<span class="sd">                # Call your LLM (Bedrock, OpenAI, etc.)</span>
<span class="sd">                response = bedrock.invoke_model(</span>
<span class="sd">                    messages=[</span>
<span class="sd">                        {&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: f&quot;Context: {context}&quot;},</span>
<span class="sd">                        {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: user_input}</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>
<span class="sd">                return response[&#39;content&#39;]</span>

<span class="sd">            memories, response, event = client.process_turn_with_llm(</span>
<span class="sd">                memory_id=&quot;mem-xyz&quot;,</span>
<span class="sd">                actor_id=&quot;user-123&quot;,</span>
<span class="sd">                session_id=&quot;session-456&quot;,</span>
<span class="sd">                user_input=&quot;What did we discuss yesterday?&quot;,</span>
<span class="sd">                llm_callback=my_llm,</span>
<span class="sd">                retrieval_namespace=&quot;support/facts/{sessionId}&quot;</span>
<span class="sd">            )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Step 1: Retrieve relevant memories</span>
        <span class="n">retrieved_memories</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">retrieval_namespace</span><span class="p">:</span>
            <span class="n">search_query</span> <span class="o">=</span> <span class="n">retrieval_query</span> <span class="ow">or</span> <span class="n">user_input</span>
            <span class="n">retrieved_memories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_memories</span><span class="p">(</span>
                <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">retrieval_namespace</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">search_query</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="n">top_k</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieved </span><span class="si">%d</span><span class="s2"> memories for LLM context&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">retrieved_memories</span><span class="p">))</span>

        <span class="c1"># Step 2: Invoke LLM callback</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">agent_response</span> <span class="o">=</span> <span class="n">llm_callback</span><span class="p">(</span><span class="n">user_input</span><span class="p">,</span> <span class="n">retrieved_memories</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agent_response</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;LLM callback must return a string response&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;LLM callback generated response&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;LLM callback failed: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

        <span class="c1"># Step 3: Save the conversation turn</span>
        <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span>
            <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
            <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
            <span class="n">messages</span><span class="o">=</span><span class="p">[(</span><span class="n">user_input</span><span class="p">,</span> <span class="s2">&quot;USER&quot;</span><span class="p">),</span> <span class="p">(</span><span class="n">agent_response</span><span class="p">,</span> <span class="s2">&quot;ASSISTANT&quot;</span><span class="p">)],</span>
            <span class="n">event_timestamp</span><span class="o">=</span><span class="n">event_timestamp</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Completed full conversation turn with LLM&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">retrieved_memories</span><span class="p">,</span> <span class="n">agent_response</span><span class="p">,</span> <span class="n">event</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_events</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_parent_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">include_payload</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List all events in a session with pagination support.</span>

<span class="sd">        This method provides direct access to the raw events API, allowing developers</span>
<span class="sd">        to retrieve all events without the turn grouping logic of get_last_k_turns.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            actor_id: Actor identifier</span>
<span class="sd">            session_id: Session identifier</span>
<span class="sd">            branch_name: Optional branch name to filter events (None for all branches)</span>
<span class="sd">            include_parent_branches: Whether to include parent branch events (only applies with branch_name)</span>
<span class="sd">            max_results: Maximum number of events to return</span>
<span class="sd">            include_payload: Whether to include event payloads in response</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of event dictionaries in chronological order</span>

<span class="sd">        Example:</span>
<span class="sd">            # Get all events</span>
<span class="sd">            events = client.list_events(memory_id, actor_id, session_id)</span>

<span class="sd">            # Get only main branch events</span>
<span class="sd">            main_events = client.list_events(memory_id, actor_id, session_id, branch_name=&quot;main&quot;)</span>

<span class="sd">            # Get events from a specific branch</span>
<span class="sd">            branch_events = client.list_events(memory_id, actor_id, session_id, branch_name=&quot;test-branch&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">all_events</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">next_token</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_results</span><span class="p">:</span>
                <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span>
                    <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
                    <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
                    <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_results</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">)),</span>
                    <span class="s2">&quot;includePayloads&quot;</span><span class="p">:</span> <span class="n">include_payload</span><span class="p">,</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="n">next_token</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>

                <span class="c1"># Add branch filter if specified (but not for &quot;main&quot;)</span>
                <span class="k">if</span> <span class="n">branch_name</span> <span class="ow">and</span> <span class="n">branch_name</span> <span class="o">!=</span> <span class="s2">&quot;main&quot;</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;branch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">,</span> <span class="s2">&quot;includeParentBranches&quot;</span><span class="p">:</span> <span class="n">include_parent_branches</span><span class="p">}</span>
                    <span class="p">}</span>

                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

                <span class="n">events</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[])</span>
                <span class="n">all_events</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">events</span><span class="p">)</span>

                <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">next_token</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">max_results</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieved total of </span><span class="si">%d</span><span class="s2"> events&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">all_events</span><span class="p">[:</span><span class="n">max_results</span><span class="p">]</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list events: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_branches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List all branches in a session.</span>

<span class="sd">        This method handles pagination automatically and provides a structured view</span>
<span class="sd">        of all conversation branches, which would require complex pagination and</span>
<span class="sd">        grouping logic if done with raw boto3 calls.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of branch information including name and root event</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Get all events - need to handle pagination for complete list</span>
            <span class="n">all_events</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">next_token</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span> <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span> <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span> <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>

                <span class="k">if</span> <span class="n">next_token</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>

                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
                <span class="n">all_events</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[]))</span>

                <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">next_token</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="n">branches</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">main_branch_events</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">all_events</span><span class="p">:</span>
                <span class="n">branch_info</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;branch&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">branch_info</span><span class="p">:</span>
                    <span class="n">branch_name</span> <span class="o">=</span> <span class="n">branch_info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">branch_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">:</span>
                        <span class="n">branches</span><span class="p">[</span><span class="n">branch_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">,</span>
                            <span class="s2">&quot;rootEventId&quot;</span><span class="p">:</span> <span class="n">branch_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rootEventId&quot;</span><span class="p">),</span>
                            <span class="s2">&quot;firstEventId&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">],</span>
                            <span class="s2">&quot;eventCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventTimestamp&quot;</span><span class="p">],</span>
                        <span class="p">}</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">branches</span><span class="p">[</span><span class="n">branch_name</span><span class="p">][</span><span class="s2">&quot;eventCount&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">main_branch_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

            <span class="c1"># Build result list</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="c1"># Only add main branch if there are actual events</span>
            <span class="k">if</span> <span class="n">main_branch_events</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;rootEventId&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;firstEventId&quot;</span><span class="p">:</span> <span class="n">main_branch_events</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;eventId&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;eventCount&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_branch_events</span><span class="p">),</span>
                        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="n">main_branch_events</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;eventTimestamp&quot;</span><span class="p">],</span>
                    <span class="p">}</span>
                <span class="p">)</span>

            <span class="c1"># Add other branches</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">branches</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Found </span><span class="si">%d</span><span class="s2"> branches in session </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="n">session_id</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list branches: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_branch_events</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_parent_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List events in a specific branch.</span>

<span class="sd">        This method provides complex filtering and pagination that would require</span>
<span class="sd">        significant boilerplate code with raw boto3. It handles:</span>
<span class="sd">        - Automatic pagination across multiple API calls</span>
<span class="sd">        - Branch filtering with parent event inclusion logic</span>
<span class="sd">        - Main branch isolation (events without branch info)</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            actor_id: Actor identifier</span>
<span class="sd">            session_id: Session identifier</span>
<span class="sd">            branch_name: Branch name (None for main branch)</span>
<span class="sd">            include_parent_branches: Whether to include events from parent branches</span>
<span class="sd">            max_results: Maximum events to return</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of events in the branch</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span>
                <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
                <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
                <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_results</span><span class="p">),</span>
            <span class="p">}</span>

            <span class="c1"># Only add filter when we have a specific branch name</span>
            <span class="k">if</span> <span class="n">branch_name</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;branch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">,</span> <span class="s2">&quot;includeParentBranches&quot;</span><span class="p">:</span> <span class="n">include_parent_branches</span><span class="p">}}</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
            <span class="n">events</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[])</span>

            <span class="c1"># Handle pagination</span>
            <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">next_token</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_results</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;maxResults&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_results</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">))</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
                <span class="n">events</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[]))</span>
                <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>

            <span class="c1"># Filter for main branch if no branch specified</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">branch_name</span><span class="p">:</span>
                <span class="n">events</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">events</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">e</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;branch&quot;</span><span class="p">)]</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieved </span><span class="si">%d</span><span class="s2"> events from branch &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">),</span> <span class="n">branch_name</span> <span class="ow">or</span> <span class="s2">&quot;main&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">events</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list branch events: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_conversation_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a tree structure of the conversation with all branches.</span>

<span class="sd">        This method transforms a flat list of events into a hierarchical tree structure,</span>
<span class="sd">        providing visualization-ready data that would be complex to build from raw events.</span>
<span class="sd">        It handles:</span>
<span class="sd">        - Full pagination to get all events</span>
<span class="sd">        - Grouping by branches</span>
<span class="sd">        - Message summarization</span>
<span class="sd">        - Tree structure building</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary representing the conversation tree structure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Get all events - need to handle pagination for complete list</span>
            <span class="n">all_events</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">next_token</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span> <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span> <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span> <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>

                <span class="k">if</span> <span class="n">next_token</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>

                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
                <span class="n">all_events</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[]))</span>

                <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">next_token</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="c1"># Build tree structure</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;session_id&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span> <span class="s2">&quot;actor_id&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span> <span class="s2">&quot;main_branch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;events&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;branches&quot;</span><span class="p">:</span> <span class="p">{}}}</span>

            <span class="c1"># Group events by branch</span>
            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">all_events</span><span class="p">:</span>
                <span class="n">event_summary</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;eventId&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">],</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventTimestamp&quot;</span><span class="p">],</span> <span class="s2">&quot;messages&quot;</span><span class="p">:</span> <span class="p">[]}</span>

                <span class="c1"># Extract message summaries</span>
                <span class="k">if</span> <span class="s2">&quot;payload&quot;</span> <span class="ow">in</span> <span class="n">event</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">payload_item</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;payload&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                        <span class="k">if</span> <span class="s2">&quot;conversational&quot;</span> <span class="ow">in</span> <span class="n">payload_item</span><span class="p">:</span>
                            <span class="n">conv</span> <span class="o">=</span> <span class="n">payload_item</span><span class="p">[</span><span class="s2">&quot;conversational&quot;</span><span class="p">]</span>
                            <span class="n">event_summary</span><span class="p">[</span><span class="s2">&quot;messages&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">conv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;role&quot;</span><span class="p">),</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">conv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)[:</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span><span class="p">}</span>
                            <span class="p">)</span>

                <span class="n">branch_info</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;branch&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">branch_info</span><span class="p">:</span>
                    <span class="n">branch_name</span> <span class="o">=</span> <span class="n">branch_info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                    <span class="n">root_event</span> <span class="o">=</span> <span class="n">branch_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rootEventId&quot;</span><span class="p">)</span>  <span class="c1"># Use .get() to handle missing field</span>

                    <span class="k">if</span> <span class="n">branch_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tree</span><span class="p">[</span><span class="s2">&quot;main_branch&quot;</span><span class="p">][</span><span class="s2">&quot;branches&quot;</span><span class="p">]:</span>
                        <span class="n">tree</span><span class="p">[</span><span class="s2">&quot;main_branch&quot;</span><span class="p">][</span><span class="s2">&quot;branches&quot;</span><span class="p">][</span><span class="n">branch_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;root_event_id&quot;</span><span class="p">:</span> <span class="n">root_event</span><span class="p">,</span> <span class="s2">&quot;events&quot;</span><span class="p">:</span> <span class="p">[]}</span>

                    <span class="n">tree</span><span class="p">[</span><span class="s2">&quot;main_branch&quot;</span><span class="p">][</span><span class="s2">&quot;branches&quot;</span><span class="p">][</span><span class="n">branch_name</span><span class="p">][</span><span class="s2">&quot;events&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event_summary</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tree</span><span class="p">[</span><span class="s2">&quot;main_branch&quot;</span><span class="p">][</span><span class="s2">&quot;events&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event_summary</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Built conversation tree with </span><span class="si">%d</span><span class="s2"> branches&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="s2">&quot;main_branch&quot;</span><span class="p">][</span><span class="s2">&quot;branches&quot;</span><span class="p">]))</span>
            <span class="k">return</span> <span class="n">tree</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to build conversation tree: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">merge_branch_context</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">include_parent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all messages from a branch for context building.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            actor_id: Actor identifier</span>
<span class="sd">            session_id: Session identifier</span>
<span class="sd">            branch_name: Branch to get context from</span>
<span class="sd">            include_parent: Whether to include parent branch events</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of all messages in chronological order</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_branch_events</span><span class="p">(</span>
            <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
            <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
            <span class="n">branch_name</span><span class="o">=</span><span class="n">branch_name</span><span class="p">,</span>
            <span class="n">include_parent_branches</span><span class="o">=</span><span class="n">include_parent</span><span class="p">,</span>
            <span class="n">max_results</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">messages</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;payload&quot;</span> <span class="ow">in</span> <span class="n">event</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">payload_item</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;payload&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                    <span class="k">if</span> <span class="s2">&quot;conversational&quot;</span> <span class="ow">in</span> <span class="n">payload_item</span><span class="p">:</span>
                        <span class="n">conv</span> <span class="o">=</span> <span class="n">payload_item</span><span class="p">[</span><span class="s2">&quot;conversational&quot;</span><span class="p">]</span>
                        <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventTimestamp&quot;</span><span class="p">],</span>
                                <span class="s2">&quot;eventId&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">],</span>
                                <span class="s2">&quot;branch&quot;</span><span class="p">:</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;branch&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;main&quot;</span><span class="p">),</span>
                                <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">conv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;role&quot;</span><span class="p">),</span>
                                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">conv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                            <span class="p">}</span>
                        <span class="p">)</span>

        <span class="c1"># Sort by timestamp</span>
        <span class="n">messages</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">])</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieved </span><span class="si">%d</span><span class="s2"> messages from branch &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">messages</span><span class="p">),</span> <span class="n">branch_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">messages</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_last_k_turns</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the last K conversation turns.</span>

<span class="sd">        A &quot;turn&quot; typically consists of a user message followed by assistant response(s).</span>
<span class="sd">        This method groups messages into logical turns for easier processing.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of turns, where each turn is a list of message dictionaries</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Use the new list_events method</span>
            <span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span>
                <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
                <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
                <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
                <span class="n">branch_name</span><span class="o">=</span><span class="n">branch_name</span><span class="p">,</span>
                <span class="n">include_parent_branches</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>

            <span class="c1"># Process events to group into turns</span>
            <span class="n">turns</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">current_turn</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">turns</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">:</span>
                    <span class="k">break</span>  <span class="c1"># Only need last K turns</span>
                <span class="k">for</span> <span class="n">payload_item</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;payload&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                    <span class="k">if</span> <span class="s2">&quot;conversational&quot;</span> <span class="ow">in</span> <span class="n">payload_item</span><span class="p">:</span>
                        <span class="n">role</span> <span class="o">=</span> <span class="n">payload_item</span><span class="p">[</span><span class="s2">&quot;conversational&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;role&quot;</span><span class="p">)</span>

                        <span class="c1"># Start new turn on USER message</span>
                        <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="n">Role</span><span class="o">.</span><span class="n">USER</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span> <span class="n">current_turn</span><span class="p">:</span>
                            <span class="n">turns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_turn</span><span class="p">)</span>
                            <span class="n">current_turn</span> <span class="o">=</span> <span class="p">[]</span>

                        <span class="n">current_turn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">payload_item</span><span class="p">[</span><span class="s2">&quot;conversational&quot;</span><span class="p">])</span>

            <span class="c1"># Don&#39;t forget the last turn</span>
            <span class="k">if</span> <span class="n">current_turn</span><span class="p">:</span>
                <span class="n">turns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_turn</span><span class="p">)</span>

            <span class="c1"># Return the last k turns</span>
            <span class="k">return</span> <span class="n">turns</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">turns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">k</span> <span class="k">else</span> <span class="n">turns</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get last K turns: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fork_conversation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">root_event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">branch_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">new_messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fork a conversation from a specific event to create a new branch.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">branch</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;rootEventId&quot;</span><span class="p">:</span> <span class="n">root_event_id</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">}</span>

            <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span>
                <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
                <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
                <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
                <span class="n">messages</span><span class="o">=</span><span class="n">new_messages</span><span class="p">,</span>
                <span class="n">branch</span><span class="o">=</span><span class="n">branch</span><span class="p">,</span>
                <span class="n">event_timestamp</span><span class="o">=</span><span class="n">event_timestamp</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created branch &#39;</span><span class="si">%s</span><span class="s2">&#39; from event </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">,</span> <span class="n">root_event_id</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">event</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to fork conversation: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_memory_strategies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all strategies for a memory.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>  <span class="c1"># Input uses old field name</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span>

            <span class="c1"># Handle both old and new field names in response</span>
            <span class="n">strategies</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategies&quot;</span><span class="p">,</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryStrategies&quot;</span><span class="p">,</span> <span class="p">[]))</span>

            <span class="c1"># Normalize strategy fields</span>
            <span class="n">normalized_strategies</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
                <span class="c1"># Create normalized version with both old and new field names</span>
                <span class="n">normalized</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

                <span class="c1"># Ensure both field name versions exist</span>
                <span class="k">if</span> <span class="s2">&quot;strategyId&quot;</span> <span class="ow">in</span> <span class="n">strategy</span> <span class="ow">and</span> <span class="s2">&quot;memoryStrategyId&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                    <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;strategyId&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s2">&quot;memoryStrategyId&quot;</span> <span class="ow">in</span> <span class="n">strategy</span> <span class="ow">and</span> <span class="s2">&quot;strategyId&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                    <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;strategyId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">]</span>

                <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">strategy</span> <span class="ow">and</span> <span class="s2">&quot;memoryStrategyType&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                    <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;memoryStrategyType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s2">&quot;memoryStrategyType&quot;</span> <span class="ow">in</span> <span class="n">strategy</span> <span class="ow">and</span> <span class="s2">&quot;type&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                    <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;memoryStrategyType&quot;</span><span class="p">]</span>

                <span class="n">normalized_strategies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">normalized</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">normalized_strategies</span>
        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get memory strategies: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_memory_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current memory status.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>  <span class="c1"># Input uses old field name</span>
            <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get memory status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_memories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List all memories for the account.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Ensure max_results doesn&#39;t exceed API limit per request</span>
            <span class="n">results_per_request</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_results</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">list_memories</span><span class="p">(</span><span class="n">maxResults</span><span class="o">=</span><span class="n">results_per_request</span><span class="p">)</span>
            <span class="n">memories</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memories&quot;</span><span class="p">,</span> <span class="p">[])</span>

            <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">next_token</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">memories</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_results</span><span class="p">:</span>
                <span class="n">remaining</span> <span class="o">=</span> <span class="n">max_results</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">memories</span><span class="p">)</span>
                <span class="n">results_per_request</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">remaining</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">list_memories</span><span class="p">(</span><span class="n">maxResults</span><span class="o">=</span><span class="n">results_per_request</span><span class="p">,</span> <span class="n">nextToken</span><span class="o">=</span><span class="n">next_token</span><span class="p">)</span>
                <span class="n">memories</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memories&quot;</span><span class="p">,</span> <span class="p">[]))</span>
                <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>

            <span class="c1"># Normalize memory summaries if they contain new field names</span>
            <span class="n">normalized_memories</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">memory</span> <span class="ow">in</span> <span class="n">memories</span><span class="p">[:</span><span class="n">max_results</span><span class="p">]:</span>
                <span class="n">normalized</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="c1"># Ensure both field name versions exist</span>
                <span class="k">if</span> <span class="s2">&quot;id&quot;</span> <span class="ow">in</span> <span class="n">memory</span> <span class="ow">and</span> <span class="s2">&quot;memoryId&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                    <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;memoryId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s2">&quot;memoryId&quot;</span> <span class="ow">in</span> <span class="n">memory</span> <span class="ow">and</span> <span class="s2">&quot;id&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                    <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;memoryId&quot;</span><span class="p">]</span>
                <span class="n">normalized_memories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">normalized</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">normalized_memories</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list memories: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete a memory resource.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">delete_memory</span><span class="p">(</span>
                <span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">clientToken</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
            <span class="p">)</span>  <span class="c1"># Input uses old field name</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Deleted memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to delete memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_memory_and_wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete a memory and wait for deletion to complete.</span>

<span class="sd">        This method deletes a memory and polls until it&#39;s fully deleted,</span>
<span class="sd">        ensuring clean resource cleanup.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID to delete</span>
<span class="sd">            max_wait: Maximum seconds to wait (default: 300)</span>
<span class="sd">            poll_interval: Seconds between checks (default: 10)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Final deletion response</span>

<span class="sd">        Raises:</span>
<span class="sd">            TimeoutError: If deletion doesn&#39;t complete within max_wait</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initiate deletion</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Initiated deletion of memory </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">max_wait</span><span class="p">:</span>
            <span class="n">elapsed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Try to get the memory - if it doesn&#39;t exist, deletion is complete</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>  <span class="c1"># Input uses old field name</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Memory still exists, waiting... (</span><span class="si">%d</span><span class="s2"> seconds elapsed)&quot;</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;Error&quot;</span><span class="p">][</span><span class="s2">&quot;Code&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ResourceNotFoundException&quot;</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> successfully deleted (took </span><span class="si">%d</span><span class="s2"> seconds)&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">response</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error checking memory status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                    <span class="k">raise</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> was not deleted within </span><span class="si">%d</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_semantic_strategy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a semantic memory strategy.</span>

<span class="sd">        Note: Configuration is no longer provided for built-in strategies as per API changes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strategy</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">StrategyType</span><span class="o">.</span><span class="n">SEMANTIC</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
            <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">SEMANTIC</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
        <span class="k">if</span> <span class="n">namespaces</span><span class="p">:</span>
            <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">SEMANTIC</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;namespaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">namespaces</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_semantic_strategy_and_wait</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
        <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a semantic strategy and wait for memory to return to ACTIVE state.</span>

<span class="sd">        This addresses the issue where adding a strategy puts the memory into</span>
<span class="sd">        CREATING state temporarily, preventing subsequent operations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Add the strategy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_semantic_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">namespaces</span><span class="p">)</span>

        <span class="c1"># Wait for memory to return to ACTIVE</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_summary_strategy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a summary memory strategy.</span>

<span class="sd">        Note: Configuration is no longer provided for built-in strategies as per API changes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strategy</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">StrategyType</span><span class="o">.</span><span class="n">SUMMARY</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
            <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">SUMMARY</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
        <span class="k">if</span> <span class="n">namespaces</span><span class="p">:</span>
            <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">SUMMARY</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;namespaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">namespaces</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_summary_strategy_and_wait</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
        <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a summary strategy and wait for memory to return to ACTIVE state.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_summary_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">namespaces</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_user_preference_strategy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a user preference memory strategy.</span>

<span class="sd">        Note: Configuration is no longer provided for built-in strategies as per API changes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strategy</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">StrategyType</span><span class="o">.</span><span class="n">USER_PREFERENCE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
            <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">USER_PREFERENCE</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
        <span class="k">if</span> <span class="n">namespaces</span><span class="p">:</span>
            <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">USER_PREFERENCE</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;namespaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">namespaces</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_user_preference_strategy_and_wait</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
        <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a user preference strategy and wait for memory to return to ACTIVE state.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_user_preference_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">namespaces</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_custom_semantic_strategy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">extraction_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">consolidation_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a custom semantic strategy with prompts.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            name: Strategy name</span>
<span class="sd">            extraction_config: Extraction configuration with prompt and model:</span>
<span class="sd">                {&quot;prompt&quot;: &quot;...&quot;, &quot;modelId&quot;: &quot;...&quot;}</span>
<span class="sd">            consolidation_config: Consolidation configuration with prompt and model:</span>
<span class="sd">                {&quot;prompt&quot;: &quot;...&quot;, &quot;modelId&quot;: &quot;...&quot;}</span>
<span class="sd">            description: Optional description</span>
<span class="sd">            namespaces: Optional namespaces list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">StrategyType</span><span class="o">.</span><span class="n">CUSTOM</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;configuration&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;semanticOverride&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;extraction&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;appendToPrompt&quot;</span><span class="p">:</span> <span class="n">extraction_config</span><span class="p">[</span><span class="s2">&quot;prompt&quot;</span><span class="p">],</span>
                            <span class="s2">&quot;modelId&quot;</span><span class="p">:</span> <span class="n">extraction_config</span><span class="p">[</span><span class="s2">&quot;modelId&quot;</span><span class="p">],</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;consolidation&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;appendToPrompt&quot;</span><span class="p">:</span> <span class="n">consolidation_config</span><span class="p">[</span><span class="s2">&quot;prompt&quot;</span><span class="p">],</span>
                            <span class="s2">&quot;modelId&quot;</span><span class="p">:</span> <span class="n">consolidation_config</span><span class="p">[</span><span class="s2">&quot;modelId&quot;</span><span class="p">],</span>
                        <span class="p">},</span>
                    <span class="p">}</span>
                <span class="p">},</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
            <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">CUSTOM</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
        <span class="k">if</span> <span class="n">namespaces</span><span class="p">:</span>
            <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">CUSTOM</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;namespaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">namespaces</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_custom_semantic_strategy_and_wait</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">extraction_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">consolidation_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
        <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a custom semantic strategy and wait for memory to return to ACTIVE state.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_custom_semantic_strategy</span><span class="p">(</span>
            <span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">extraction_config</span><span class="p">,</span> <span class="n">consolidation_config</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">namespaces</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">modify_strategy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">configuration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Modify a strategy with full control over configuration.&quot;&quot;&quot;</span>
        <span class="n">modify_config</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">:</span> <span class="n">strategy_id</span><span class="p">}</span>  <span class="c1"># Using old field name for input</span>

        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">modify_config</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
        <span class="k">if</span> <span class="n">namespaces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">modify_config</span><span class="p">[</span><span class="s2">&quot;namespaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">namespaces</span>
        <span class="k">if</span> <span class="n">configuration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">modify_config</span><span class="p">[</span><span class="s2">&quot;configuration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">configuration</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_memory_strategies</span><span class="p">(</span><span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">modify_strategies</span><span class="o">=</span><span class="p">[</span><span class="n">modify_config</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_strategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete a strategy from a memory.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_memory_strategies</span><span class="p">(</span><span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">delete_strategy_ids</span><span class="o">=</span><span class="p">[</span><span class="n">strategy_id</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_memory_strategies</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">add_strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">modify_strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">delete_strategy_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update memory strategies - add, modify, or delete.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">memory_strategies</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">if</span> <span class="n">add_strategies</span><span class="p">:</span>
                <span class="n">processed_add</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_default_namespaces</span><span class="p">(</span><span class="n">add_strategies</span><span class="p">)</span>
                <span class="n">memory_strategies</span><span class="p">[</span><span class="s2">&quot;addMemoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processed_add</span>  <span class="c1"># Using old field name for input</span>

            <span class="k">if</span> <span class="n">modify_strategies</span><span class="p">:</span>
                <span class="n">current_strategies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory_strategies</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>
                <span class="n">strategy_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">[</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">]:</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">current_strategies</span><span class="p">}</span>  <span class="c1"># Using normalized field</span>

                <span class="n">modify_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">modify_strategies</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;memoryStrategyId&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">strategy</span><span class="p">:</span>  <span class="c1"># Using old field name</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each modify strategy must include memoryStrategyId&quot;</span><span class="p">)</span>

                    <span class="n">strategy_id</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">]</span>  <span class="c1"># Using old field name</span>
                    <span class="n">strategy_info</span> <span class="o">=</span> <span class="n">strategy_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">strategy_id</span><span class="p">)</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">strategy_info</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Strategy </span><span class="si">%s</span><span class="s2"> not found in memory </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">strategy_id</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">))</span>

                    <span class="n">strategy_type</span> <span class="o">=</span> <span class="n">strategy_info</span><span class="p">[</span><span class="s2">&quot;memoryStrategyType&quot;</span><span class="p">]</span>  <span class="c1"># Using normalized field</span>
                    <span class="n">override_type</span> <span class="o">=</span> <span class="n">strategy_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;configuration&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>

                    <span class="n">strategy_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">strategy</span><span class="p">)</span>

                    <span class="k">if</span> <span class="s2">&quot;configuration&quot;</span> <span class="ow">in</span> <span class="n">strategy_copy</span><span class="p">:</span>
                        <span class="n">wrapped_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_configuration</span><span class="p">(</span>
                            <span class="n">strategy_copy</span><span class="p">[</span><span class="s2">&quot;configuration&quot;</span><span class="p">],</span> <span class="n">strategy_type</span><span class="p">,</span> <span class="n">override_type</span>
                        <span class="p">)</span>
                        <span class="n">strategy_copy</span><span class="p">[</span><span class="s2">&quot;configuration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wrapped_config</span>

                    <span class="n">modify_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">strategy_copy</span><span class="p">)</span>

                <span class="n">memory_strategies</span><span class="p">[</span><span class="s2">&quot;modifyMemoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">modify_list</span>  <span class="c1"># Using old field name for input</span>

            <span class="k">if</span> <span class="n">delete_strategy_ids</span><span class="p">:</span>
                <span class="n">delete_list</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">:</span> <span class="n">sid</span><span class="p">}</span> <span class="k">for</span> <span class="n">sid</span> <span class="ow">in</span> <span class="n">delete_strategy_ids</span><span class="p">]</span>  <span class="c1"># Using old field name</span>
                <span class="n">memory_strategies</span><span class="p">[</span><span class="s2">&quot;deleteMemoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">delete_list</span>  <span class="c1"># Using old field name for input</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">memory_strategies</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No strategy operations provided&quot;</span><span class="p">)</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">update_memory</span><span class="p">(</span>
                <span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
                <span class="n">memoryStrategies</span><span class="o">=</span><span class="n">memory_strategies</span><span class="p">,</span>
                <span class="n">clientToken</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>  <span class="c1"># Using old field names for input</span>
            <span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updated memory strategies for: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_memory_response</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">memory</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to update memory strategies: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_memory_strategies_and_wait</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">add_strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">modify_strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">delete_strategy_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
        <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update memory strategies and wait for memory to return to ACTIVE state.</span>

<span class="sd">        This method handles the temporary CREATING state that occurs when</span>
<span class="sd">        updating strategies, preventing subsequent update errors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Update strategies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_memory_strategies</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">add_strategies</span><span class="p">,</span> <span class="n">modify_strategies</span><span class="p">,</span> <span class="n">delete_strategy_ids</span><span class="p">)</span>

        <span class="c1"># Wait for memory to return to ACTIVE</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_memories</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">test_query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">180</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for memory extraction to complete by polling.</span>

<span class="sd">        IMPORTANT LIMITATIONS:</span>
<span class="sd">        1. This method only works reliably on empty namespaces. If there are already</span>
<span class="sd">           existing memories in the namespace, this method may return True immediately</span>
<span class="sd">           even if new extractions haven&#39;t completed.</span>
<span class="sd">        2. Wildcards (*) are NOT supported in namespaces. You must provide the exact</span>
<span class="sd">           namespace path with all variables resolved (e.g., &quot;support/facts/session-123&quot;</span>
<span class="sd">           not &quot;support/facts/*&quot;).</span>

<span class="sd">        For subsequent extractions in populated namespaces, use a fixed wait time:</span>
<span class="sd">            time.sleep(150)  # Wait 2.5 minutes for extraction</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            namespace: Exact namespace to check (no wildcards)</span>
<span class="sd">            test_query: Query to test with (default: &quot;test&quot;)</span>
<span class="sd">            max_wait: Maximum seconds to wait (default: 180)</span>
<span class="sd">            poll_interval: Seconds between checks (default: 15)</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if memories found, False if timeout</span>

<span class="sd">        Note:</span>
<span class="sd">            This method will be deprecated in future versions once the API</span>
<span class="sd">            provides extraction status or timestamps.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;*&quot;</span> <span class="ow">in</span> <span class="n">namespace</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Wildcards are not supported in namespaces. Please provide exact namespace.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;wait_for_memories() only works reliably on empty namespaces. &quot;</span>
            <span class="s2">&quot;For populated namespaces, consider using a fixed wait time instead.&quot;</span>
        <span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Waiting for memory extraction in namespace: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">service_errors</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">max_wait</span><span class="p">:</span>
            <span class="n">elapsed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">memories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_memories</span><span class="p">(</span><span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">test_query</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">memories</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Memory extraction complete after </span><span class="si">%d</span><span class="s2"> seconds&quot;</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">True</span>

                <span class="c1"># Reset service error count on successful call</span>
                <span class="n">service_errors</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;ServiceException&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                    <span class="n">service_errors</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">service_errors</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Multiple service errors - the service may be experiencing issues&quot;</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Retrieval attempt failed: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">max_wait</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No memories found after </span><span class="si">%d</span><span class="s2"> seconds&quot;</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">service_errors</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Note: Encountered </span><span class="si">%d</span><span class="s2"> service errors during polling&quot;</span><span class="p">,</span> <span class="n">service_errors</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_strategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a strategy to a memory (without waiting).</span>

<span class="sd">        WARNING: After adding a strategy, the memory enters CREATING state temporarily.</span>
<span class="sd">        Use add_*_strategy_and_wait() methods instead to avoid errors.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            strategy: Strategy configuration dictionary</span>

<span class="sd">        Returns:</span>
<span class="sd">            Updated memory response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;add_strategy() may leave memory in CREATING state. &quot;</span>
            <span class="s2">&quot;Use add_*_strategy_and_wait() methods to avoid subsequent errors.&quot;</span><span class="p">,</span>
            <span class="ne">UserWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>

    <span class="c1"># Private methods</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_normalize_memory_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Normalize memory response to include both old and new field names.</span>

<span class="sd">        The API returns new field names but SDK users might expect old ones.</span>
<span class="sd">        This ensures compatibility by providing both.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Ensure both versions of memory ID exist</span>
        <span class="k">if</span> <span class="s2">&quot;id&quot;</span> <span class="ow">in</span> <span class="n">memory</span> <span class="ow">and</span> <span class="s2">&quot;memoryId&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">memory</span><span class="p">:</span>
            <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;memoryId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;memoryId&quot;</span> <span class="ow">in</span> <span class="n">memory</span> <span class="ow">and</span> <span class="s2">&quot;id&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">memory</span><span class="p">:</span>
            <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;memoryId&quot;</span><span class="p">]</span>

        <span class="c1"># Ensure both versions of strategies exist</span>
        <span class="k">if</span> <span class="s2">&quot;strategies&quot;</span> <span class="ow">in</span> <span class="n">memory</span> <span class="ow">and</span> <span class="s2">&quot;memoryStrategies&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">memory</span><span class="p">:</span>
            <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;memoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;strategies&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;memoryStrategies&quot;</span> <span class="ow">in</span> <span class="n">memory</span> <span class="ow">and</span> <span class="s2">&quot;strategies&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">memory</span><span class="p">:</span>
            <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;strategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;memoryStrategies&quot;</span><span class="p">]</span>

        <span class="c1"># Normalize strategies within memory</span>
        <span class="k">if</span> <span class="s2">&quot;strategies&quot;</span> <span class="ow">in</span> <span class="n">memory</span><span class="p">:</span>
            <span class="n">normalized_strategies</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;strategies&quot;</span><span class="p">]:</span>
                <span class="n">normalized</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

                <span class="c1"># Ensure both field name versions exist for strategies</span>
                <span class="k">if</span> <span class="s2">&quot;strategyId&quot;</span> <span class="ow">in</span> <span class="n">strategy</span> <span class="ow">and</span> <span class="s2">&quot;memoryStrategyId&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                    <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;strategyId&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s2">&quot;memoryStrategyId&quot;</span> <span class="ow">in</span> <span class="n">strategy</span> <span class="ow">and</span> <span class="s2">&quot;strategyId&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                    <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;strategyId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">]</span>

                <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">strategy</span> <span class="ow">and</span> <span class="s2">&quot;memoryStrategyType&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                    <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;memoryStrategyType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s2">&quot;memoryStrategyType&quot;</span> <span class="ow">in</span> <span class="n">strategy</span> <span class="ow">and</span> <span class="s2">&quot;type&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                    <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;memoryStrategyType&quot;</span><span class="p">]</span>

                <span class="n">normalized_strategies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">normalized</span><span class="p">)</span>

            <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;strategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">normalized_strategies</span>
            <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;memoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">normalized_strategies</span>

        <span class="k">return</span> <span class="n">memory</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_add_strategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal method to add a single strategy.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_memory_strategies</span><span class="p">(</span><span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">add_strategies</span><span class="o">=</span><span class="p">[</span><span class="n">strategy</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_wait_for_memory_active</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for memory to return to ACTIVE state after strategy update.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Waiting for memory </span><span class="si">%s</span><span class="s2"> to return to ACTIVE state...&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">max_wait</span><span class="p">:</span>
            <span class="n">elapsed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory_status</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">MemoryStatus</span><span class="o">.</span><span class="n">ACTIVE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> is ACTIVE again (took </span><span class="si">%d</span><span class="s2"> seconds)&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span>
                    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>  <span class="c1"># Input uses old field name</span>
                    <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_memory_response</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">])</span>
                    <span class="k">return</span> <span class="n">memory</span>
                <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="n">MemoryStatus</span><span class="o">.</span><span class="n">FAILED</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>  <span class="c1"># Input uses old field name</span>
                    <span class="n">failure_reason</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;failureReason&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Memory update failed: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">failure_reason</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Memory status: </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%d</span><span class="s2"> seconds elapsed)&quot;</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error checking memory status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">raise</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> did not return to ACTIVE state within </span><span class="si">%d</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_add_default_namespaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strategies</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add default namespaces to strategies that don&#39;t have them.&quot;&quot;&quot;</span>
        <span class="n">processed</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
            <span class="n">strategy_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">strategy</span><span class="p">)</span>

            <span class="n">strategy_type_key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">strategy</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">strategy_config</span> <span class="o">=</span> <span class="n">strategy_copy</span><span class="p">[</span><span class="n">strategy_type_key</span><span class="p">]</span>

            <span class="k">if</span> <span class="s2">&quot;namespaces&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">strategy_config</span><span class="p">:</span>
                <span class="n">strategy_type</span> <span class="o">=</span> <span class="n">StrategyType</span><span class="p">(</span><span class="n">strategy_type_key</span><span class="p">)</span>
                <span class="n">strategy_config</span><span class="p">[</span><span class="s2">&quot;namespaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_NAMESPACES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">strategy_type</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;custom/</span><span class="si">{actorId}</span><span class="s2">/</span><span class="si">{sessionId}</span><span class="s2">&quot;</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_strategy_config</span><span class="p">(</span><span class="n">strategy_copy</span><span class="p">,</span> <span class="n">strategy_type_key</span><span class="p">)</span>

            <span class="n">processed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">strategy_copy</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">processed</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate namespace format - basic check only.&quot;&quot;&quot;</span>
        <span class="c1"># Only check for template variables in namespace definition</span>
        <span class="c1"># Note: Using memoryStrategyId (old name) as it&#39;s still used in input parameters</span>
        <span class="k">if</span> <span class="s2">&quot;{&quot;</span> <span class="ow">in</span> <span class="n">namespace</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">{actorId}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">namespace</span> <span class="ow">or</span> <span class="s2">&quot;</span><span class="si">{sessionId}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">namespace</span> <span class="ow">or</span> <span class="s2">&quot;</span><span class="si">{memoryStrategyId}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">namespace</span>
        <span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Namespace with templates should contain valid variables: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_strategy_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">strategy_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate strategy configuration parameters.&quot;&quot;&quot;</span>
        <span class="n">strategy_config</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="n">strategy_type</span><span class="p">]</span>

        <span class="n">namespaces</span> <span class="o">=</span> <span class="n">strategy_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;namespaces&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">for</span> <span class="n">namespace</span> <span class="ow">in</span> <span class="n">namespaces</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_namespace</span><span class="p">(</span><span class="n">namespace</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_wrap_configuration</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">strategy_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">override_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrap configuration based on strategy type.&quot;&quot;&quot;</span>
        <span class="n">wrapped_config</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="s2">&quot;extraction&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
            <span class="n">extraction</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;extraction&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="n">extraction</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;triggerEveryNMessages&quot;</span><span class="p">,</span> <span class="s2">&quot;historicalContextWindowSize&quot;</span><span class="p">]):</span>
                <span class="n">strategy_type_enum</span> <span class="o">=</span> <span class="n">MemoryStrategyTypeEnum</span><span class="p">(</span><span class="n">strategy_type</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">strategy_type</span> <span class="o">==</span> <span class="s2">&quot;SEMANTIC&quot;</span><span class="p">:</span>
                    <span class="n">wrapped_config</span><span class="p">[</span><span class="s2">&quot;extraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">EXTRACTION_WRAPPER_KEYS</span><span class="p">[</span><span class="n">strategy_type_enum</span><span class="p">]:</span> <span class="n">extraction</span><span class="p">}</span>
                <span class="k">elif</span> <span class="n">strategy_type</span> <span class="o">==</span> <span class="s2">&quot;USER_PREFERENCE&quot;</span><span class="p">:</span>
                    <span class="n">wrapped_config</span><span class="p">[</span><span class="s2">&quot;extraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">EXTRACTION_WRAPPER_KEYS</span><span class="p">[</span><span class="n">strategy_type_enum</span><span class="p">]:</span> <span class="n">extraction</span><span class="p">}</span>
                <span class="k">elif</span> <span class="n">strategy_type</span> <span class="o">==</span> <span class="s2">&quot;CUSTOM&quot;</span> <span class="ow">and</span> <span class="n">override_type</span><span class="p">:</span>
                    <span class="n">override_enum</span> <span class="o">=</span> <span class="n">OverrideType</span><span class="p">(</span><span class="n">override_type</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">override_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;SEMANTIC_OVERRIDE&quot;</span><span class="p">,</span> <span class="s2">&quot;USER_PREFERENCE_OVERRIDE&quot;</span><span class="p">]:</span>
                        <span class="n">wrapped_config</span><span class="p">[</span><span class="s2">&quot;extraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;customExtractionConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">CUSTOM_EXTRACTION_WRAPPER_KEYS</span><span class="p">[</span><span class="n">override_enum</span><span class="p">]:</span> <span class="n">extraction</span><span class="p">}</span>
                        <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">wrapped_config</span><span class="p">[</span><span class="s2">&quot;extraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">extraction</span>

        <span class="k">if</span> <span class="s2">&quot;consolidation&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
            <span class="n">consolidation</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;consolidation&quot;</span><span class="p">]</span>

            <span class="n">raw_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;triggerEveryNMessages&quot;</span><span class="p">,</span> <span class="s2">&quot;appendToPrompt&quot;</span><span class="p">,</span> <span class="s2">&quot;modelId&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="n">consolidation</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">raw_keys</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">strategy_type</span> <span class="o">==</span> <span class="s2">&quot;SUMMARIZATION&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;triggerEveryNMessages&quot;</span> <span class="ow">in</span> <span class="n">consolidation</span><span class="p">:</span>
                        <span class="n">wrapped_config</span><span class="p">[</span><span class="s2">&quot;consolidation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;summaryConsolidationConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;triggerEveryNMessages&quot;</span><span class="p">:</span> <span class="n">consolidation</span><span class="p">[</span><span class="s2">&quot;triggerEveryNMessages&quot;</span><span class="p">]</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                <span class="k">elif</span> <span class="n">strategy_type</span> <span class="o">==</span> <span class="s2">&quot;CUSTOM&quot;</span> <span class="ow">and</span> <span class="n">override_type</span><span class="p">:</span>
                    <span class="n">override_enum</span> <span class="o">=</span> <span class="n">OverrideType</span><span class="p">(</span><span class="n">override_type</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">override_enum</span> <span class="ow">in</span> <span class="n">CUSTOM_CONSOLIDATION_WRAPPER_KEYS</span><span class="p">:</span>
                        <span class="n">wrapped_config</span><span class="p">[</span><span class="s2">&quot;consolidation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;customConsolidationConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="n">CUSTOM_CONSOLIDATION_WRAPPER_KEYS</span><span class="p">[</span><span class="n">override_enum</span><span class="p">]:</span> <span class="n">consolidation</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">wrapped_config</span><span class="p">[</span><span class="s2">&quot;consolidation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">consolidation</span>

        <span class="k">return</span> <span class="n">wrapped_config</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.__getattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getattr__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.__getattr__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Dynamically forward method calls to the appropriate boto3 client.</p>
<p>This method enables access to all boto3 client methods without explicitly
defining them. Methods are looked up in the following order:
1. gmdp_client (bedrock-agentcore) - for data plane operations
2. gmcp_client (bedrock-agentcore-control) - for control plane operations</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The method name being accessed</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A callable method from the appropriate boto3 client</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the method doesn't exist on either client</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <h5 id="bedrock_agentcore.memory.MemoryClient.__getattr__--access-any-boto3-method-directly">Access any boto3 method directly<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.__getattr__--access-any-boto3-method-directly" title="Permanent link">&para;</a></h5>
<p>client = MemoryClient()</p>
<h5 id="bedrock_agentcore.memory.MemoryClient.__getattr__--these-calls-are-forwarded-to-the-appropriate-boto3-client">These calls are forwarded to the appropriate boto3 client<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.__getattr__--these-calls-are-forwarded-to-the-appropriate-boto3-client" title="Permanent link">&para;</a></h5>
<p>response = client.list_memory_records(memoryId="mem-123", namespace="test")
metadata = client.get_memory_metadata(memoryId="mem-123")</p>
</details>

            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dynamically forward method calls to the appropriate boto3 client.</span>

<span class="sd">    This method enables access to all boto3 client methods without explicitly</span>
<span class="sd">    defining them. Methods are looked up in the following order:</span>
<span class="sd">    1. gmdp_client (bedrock-agentcore) - for data plane operations</span>
<span class="sd">    2. gmcp_client (bedrock-agentcore-control) - for control plane operations</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The method name being accessed</span>

<span class="sd">    Returns:</span>
<span class="sd">        A callable method from the appropriate boto3 client</span>

<span class="sd">    Raises:</span>
<span class="sd">        AttributeError: If the method doesn&#39;t exist on either client</span>

<span class="sd">    Example:</span>
<span class="sd">        # Access any boto3 method directly</span>
<span class="sd">        client = MemoryClient()</span>

<span class="sd">        # These calls are forwarded to the appropriate boto3 client</span>
<span class="sd">        response = client.list_memory_records(memoryId=&quot;mem-123&quot;, namespace=&quot;test&quot;)</span>
<span class="sd">        metadata = client.get_memory_metadata(memoryId=&quot;mem-123&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ALLOWED_GMDP_METHODS</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Forwarding method &#39;</span><span class="si">%s</span><span class="s2">&#39; to gmdp_client&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">method</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ALLOWED_GMCP_METHODS</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Forwarding method &#39;</span><span class="si">%s</span><span class="s2">&#39; to gmcp_client&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">method</span>

    <span class="c1"># Method not found on either client</span>
    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Method not found on gmdp_client or gmcp_client. &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Available methods can be found in the boto3 documentation for &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;&#39;bedrock-agentcore&#39; and &#39;bedrock-agentcore-control&#39; services.&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">region_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize the Memory client.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the Memory client.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">region_name</span> <span class="o">=</span> <span class="n">region_name</span> <span class="ow">or</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span><span class="o">.</span><span class="n">region_name</span> <span class="ow">or</span> <span class="s2">&quot;us-west-2&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;bedrock-agentcore-control&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">region_name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;bedrock-agentcore&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">region_name</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;Initialized MemoryClient for control plane: </span><span class="si">%s</span><span class="s2">, data plane: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">region_name</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">region_name</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.add_custom_semantic_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_custom_semantic_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">extraction_config</span><span class="p">,</span> <span class="n">consolidation_config</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.add_custom_semantic_strategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add a custom semantic strategy with prompts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Strategy name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extraction_config</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p _..._="&quot;...&quot;" _modelId_:="&quot;modelId&quot;:" _prompt_:="&quot;prompt&quot;:">Extraction configuration with prompt and model:</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>consolidation_config</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p _..._="&quot;...&quot;" _modelId_:="&quot;modelId&quot;:" _prompt_:="&quot;prompt&quot;:">Consolidation configuration with prompt and model:</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional description</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespaces</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional namespaces list</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_custom_semantic_strategy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">extraction_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">consolidation_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a custom semantic strategy with prompts.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        name: Strategy name</span>
<span class="sd">        extraction_config: Extraction configuration with prompt and model:</span>
<span class="sd">            {&quot;prompt&quot;: &quot;...&quot;, &quot;modelId&quot;: &quot;...&quot;}</span>
<span class="sd">        consolidation_config: Consolidation configuration with prompt and model:</span>
<span class="sd">            {&quot;prompt&quot;: &quot;...&quot;, &quot;modelId&quot;: &quot;...&quot;}</span>
<span class="sd">        description: Optional description</span>
<span class="sd">        namespaces: Optional namespaces list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">strategy</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">StrategyType</span><span class="o">.</span><span class="n">CUSTOM</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;configuration&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;semanticOverride&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;extraction&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;appendToPrompt&quot;</span><span class="p">:</span> <span class="n">extraction_config</span><span class="p">[</span><span class="s2">&quot;prompt&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;modelId&quot;</span><span class="p">:</span> <span class="n">extraction_config</span><span class="p">[</span><span class="s2">&quot;modelId&quot;</span><span class="p">],</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;consolidation&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;appendToPrompt&quot;</span><span class="p">:</span> <span class="n">consolidation_config</span><span class="p">[</span><span class="s2">&quot;prompt&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;modelId&quot;</span><span class="p">:</span> <span class="n">consolidation_config</span><span class="p">[</span><span class="s2">&quot;modelId&quot;</span><span class="p">],</span>
                    <span class="p">},</span>
                <span class="p">}</span>
            <span class="p">},</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">CUSTOM</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
    <span class="k">if</span> <span class="n">namespaces</span><span class="p">:</span>
        <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">CUSTOM</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;namespaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">namespaces</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.add_custom_semantic_strategy_and_wait" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_custom_semantic_strategy_and_wait</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">extraction_config</span><span class="p">,</span> <span class="n">consolidation_config</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.add_custom_semantic_strategy_and_wait" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add a custom semantic strategy and wait for memory to return to ACTIVE state.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_custom_semantic_strategy_and_wait</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">extraction_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">consolidation_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a custom semantic strategy and wait for memory to return to ACTIVE state.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_custom_semantic_strategy</span><span class="p">(</span>
        <span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">extraction_config</span><span class="p">,</span> <span class="n">consolidation_config</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">namespaces</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.add_semantic_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_semantic_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.add_semantic_strategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add a semantic memory strategy.</p>
<p>Note: Configuration is no longer provided for built-in strategies as per API changes.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_semantic_strategy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a semantic memory strategy.</span>

<span class="sd">    Note: Configuration is no longer provided for built-in strategies as per API changes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">strategy</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">StrategyType</span><span class="o">.</span><span class="n">SEMANTIC</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">SEMANTIC</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
    <span class="k">if</span> <span class="n">namespaces</span><span class="p">:</span>
        <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">SEMANTIC</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;namespaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">namespaces</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.add_semantic_strategy_and_wait" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_semantic_strategy_and_wait</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.add_semantic_strategy_and_wait" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add a semantic strategy and wait for memory to return to ACTIVE state.</p>
<p>This addresses the issue where adding a strategy puts the memory into
CREATING state temporarily, preventing subsequent operations.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_semantic_strategy_and_wait</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a semantic strategy and wait for memory to return to ACTIVE state.</span>

<span class="sd">    This addresses the issue where adding a strategy puts the memory into</span>
<span class="sd">    CREATING state temporarily, preventing subsequent operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Add the strategy</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_semantic_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">namespaces</span><span class="p">)</span>

    <span class="c1"># Wait for memory to return to ACTIVE</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.add_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.add_strategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add a strategy to a memory (without waiting).</p>
<p>WARNING: After adding a strategy, the memory enters CREATING state temporarily.
Use add_*_strategy_and_wait() methods instead to avoid errors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strategy</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Strategy configuration dictionary</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Updated memory response</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_strategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a strategy to a memory (without waiting).</span>

<span class="sd">    WARNING: After adding a strategy, the memory enters CREATING state temporarily.</span>
<span class="sd">    Use add_*_strategy_and_wait() methods instead to avoid errors.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        strategy: Strategy configuration dictionary</span>

<span class="sd">    Returns:</span>
<span class="sd">        Updated memory response</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">&quot;add_strategy() may leave memory in CREATING state. &quot;</span>
        <span class="s2">&quot;Use add_*_strategy_and_wait() methods to avoid subsequent errors.&quot;</span><span class="p">,</span>
        <span class="ne">UserWarning</span><span class="p">,</span>
        <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.add_summary_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_summary_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.add_summary_strategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add a summary memory strategy.</p>
<p>Note: Configuration is no longer provided for built-in strategies as per API changes.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_summary_strategy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a summary memory strategy.</span>

<span class="sd">    Note: Configuration is no longer provided for built-in strategies as per API changes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">strategy</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">StrategyType</span><span class="o">.</span><span class="n">SUMMARY</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">SUMMARY</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
    <span class="k">if</span> <span class="n">namespaces</span><span class="p">:</span>
        <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">SUMMARY</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;namespaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">namespaces</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.add_summary_strategy_and_wait" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_summary_strategy_and_wait</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.add_summary_strategy_and_wait" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add a summary strategy and wait for memory to return to ACTIVE state.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_summary_strategy_and_wait</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a summary strategy and wait for memory to return to ACTIVE state.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_summary_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">namespaces</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.add_user_preference_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_user_preference_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.add_user_preference_strategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add a user preference memory strategy.</p>
<p>Note: Configuration is no longer provided for built-in strategies as per API changes.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_user_preference_strategy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a user preference memory strategy.</span>

<span class="sd">    Note: Configuration is no longer provided for built-in strategies as per API changes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">strategy</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">StrategyType</span><span class="o">.</span><span class="n">USER_PREFERENCE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">USER_PREFERENCE</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
    <span class="k">if</span> <span class="n">namespaces</span><span class="p">:</span>
        <span class="n">strategy</span><span class="p">[</span><span class="n">StrategyType</span><span class="o">.</span><span class="n">USER_PREFERENCE</span><span class="o">.</span><span class="n">value</span><span class="p">][</span><span class="s2">&quot;namespaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">namespaces</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.add_user_preference_strategy_and_wait" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_user_preference_strategy_and_wait</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.add_user_preference_strategy_and_wait" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add a user preference strategy and wait for memory to return to ACTIVE state.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_user_preference_strategy_and_wait</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a user preference strategy and wait for memory to return to ACTIVE state.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_user_preference_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">namespaces</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.create_blob_event" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_blob_event</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">blob_data</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">branch</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.create_blob_event" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Save a blob event to AgentCore Memory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Actor identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>blob_data</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary or structured data to store</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_timestamp</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="datetime.datetime">datetime</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional timestamp for the event</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>branch</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional branch info</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Created event</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <h5 id="bedrock_agentcore.memory.MemoryClient.create_blob_event--store-binary-data">Store binary data<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.create_blob_event--store-binary-data" title="Permanent link">&para;</a></h5>
<p>event = client.create_blob_event(
    memory_id="mem-xyz",
    actor_id="user-123",
    session_id="session-456",
    blob_data={"file_content": "base64_encoded_data", "metadata": {"type": "image"}}
)</p>
</details>

            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_blob_event</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">blob_data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">branch</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save a blob event to AgentCore Memory.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        actor_id: Actor identifier</span>
<span class="sd">        session_id: Session identifier</span>
<span class="sd">        blob_data: Binary or structured data to store</span>
<span class="sd">        event_timestamp: Optional timestamp for the event</span>
<span class="sd">        branch: Optional branch info</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created event</span>

<span class="sd">    Example:</span>
<span class="sd">        # Store binary data</span>
<span class="sd">        event = client.create_blob_event(</span>
<span class="sd">            memory_id=&quot;mem-xyz&quot;,</span>
<span class="sd">            actor_id=&quot;user-123&quot;,</span>
<span class="sd">            session_id=&quot;session-456&quot;,</span>
<span class="sd">            blob_data={&quot;file_content&quot;: &quot;base64_encoded_data&quot;, &quot;metadata&quot;: {&quot;type&quot;: &quot;image&quot;}}</span>
<span class="sd">        )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;blob&quot;</span><span class="p">:</span> <span class="n">blob_data</span><span class="p">}]</span>

        <span class="k">if</span> <span class="n">event_timestamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">event_timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span>
            <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
            <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
            <span class="s2">&quot;eventTimestamp&quot;</span><span class="p">:</span> <span class="n">event_timestamp</span><span class="p">,</span>
            <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">branch</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;branch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="n">event</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;event&quot;</span><span class="p">]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created blob event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">event</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to create blob event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.create_event" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_event</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">messages</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">branch</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.create_event" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Save an event of an agent interaction or conversation with a user.</p>
<p>This is the basis of short-term memory. If you configured your Memory resource
to have MemoryStrategies, then events that are saved in short-term memory via
create_event will be used to extract long-term memory records.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Actor identifier (could be id of your user or an agent)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session identifier (meant to logically group a series of events)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>messages</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of (text, role) tuples. Role can be USER, ASSISTANT, TOOL, etc.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_timestamp</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="datetime.datetime">datetime</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>timestamp for the entire event (not per message)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>branch</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional branch info. For new branches: {"rootEventId": "...", "name": "..."}
   For continuing existing branch: {"name": "..."} or {"name": "...", "rootEventId": "..."}
   A branch is used when you want to have a different history of events.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Created event</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>event = client.create_event(
    memory_id=memory.get("id"),
    actor_id="weatherWorrier",
    session_id="WeatherSession",
    messages=[
        ("What's the weather?", "USER"),
        ("Today is sunny", "ASSISTANT")
    ]
)
root_event_id = event.get("eventId")
print(event)</p>
<h5 id="bedrock_agentcore.memory.MemoryClient.create_event--continue-the-conversation">Continue the conversation<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.create_event--continue-the-conversation" title="Permanent link">&para;</a></h5>
<p>event = client.create_event(
    memory_id=memory.get("id"),
    actor_id="weatherWorrier",
    session_id="WeatherSession",
    messages=[
        ("How about the weather tomorrow", "USER"),
        ("Tomorrow is cold!", "ASSISTANT")
    ]
)
print(event)</p>
<h5 id="bedrock_agentcore.memory.MemoryClient.create_event--branch-the-conversation-so-that-the-previous-message-is-not-part-of-the-history">branch the conversation so that the previous message is not part of the history<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.create_event--branch-the-conversation-so-that-the-previous-message-is-not-part-of-the-history" title="Permanent link">&para;</a></h5>
<h5 id="bedrock_agentcore.memory.MemoryClient.create_event--suppose-you-did-not-mean-to-ask-about-the-weather-tomorrow-and-want-to-undo">(suppose you did not mean to ask about the weather tomorrow and want to undo<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.create_event--suppose-you-did-not-mean-to-ask-about-the-weather-tomorrow-and-want-to-undo" title="Permanent link">&para;</a></h5>
<h5 id="bedrock_agentcore.memory.MemoryClient.create_event--that-and-replace-with-a-new-message">that, and replace with a new message)<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.create_event--that-and-replace-with-a-new-message" title="Permanent link">&para;</a></h5>
<p>event = client.create_event(
    memory_id=memory.get("id"),
    actor_id="weatherWorrier",
    session_id="WeatherSession",
    branch={"name": "differentWeatherQuestion", "rootEventId": root_event_id},
    messages=[
        ("How about the weather a year from now", "USER"),
        ("I can't predict that far into the future!", "ASSISTANT")
    ]
)
print(event)</p>
</details>

            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_event</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">branch</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save an event of an agent interaction or conversation with a user.</span>

<span class="sd">    This is the basis of short-term memory. If you configured your Memory resource</span>
<span class="sd">    to have MemoryStrategies, then events that are saved in short-term memory via</span>
<span class="sd">    create_event will be used to extract long-term memory records.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        actor_id: Actor identifier (could be id of your user or an agent)</span>
<span class="sd">        session_id: Session identifier (meant to logically group a series of events)</span>
<span class="sd">        messages: List of (text, role) tuples. Role can be USER, ASSISTANT, TOOL, etc.</span>
<span class="sd">        event_timestamp: timestamp for the entire event (not per message)</span>
<span class="sd">        branch: Optional branch info. For new branches: {&quot;rootEventId&quot;: &quot;...&quot;, &quot;name&quot;: &quot;...&quot;}</span>
<span class="sd">               For continuing existing branch: {&quot;name&quot;: &quot;...&quot;} or {&quot;name&quot;: &quot;...&quot;, &quot;rootEventId&quot;: &quot;...&quot;}</span>
<span class="sd">               A branch is used when you want to have a different history of events.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created event</span>

<span class="sd">    Example:</span>
<span class="sd">        event = client.create_event(</span>
<span class="sd">            memory_id=memory.get(&quot;id&quot;),</span>
<span class="sd">            actor_id=&quot;weatherWorrier&quot;,</span>
<span class="sd">            session_id=&quot;WeatherSession&quot;,</span>
<span class="sd">            messages=[</span>
<span class="sd">                (&quot;What&#39;s the weather?&quot;, &quot;USER&quot;),</span>
<span class="sd">                (&quot;Today is sunny&quot;, &quot;ASSISTANT&quot;)</span>
<span class="sd">            ]</span>
<span class="sd">        )</span>
<span class="sd">        root_event_id = event.get(&quot;eventId&quot;)</span>
<span class="sd">        print(event)</span>

<span class="sd">        # Continue the conversation</span>
<span class="sd">        event = client.create_event(</span>
<span class="sd">            memory_id=memory.get(&quot;id&quot;),</span>
<span class="sd">            actor_id=&quot;weatherWorrier&quot;,</span>
<span class="sd">            session_id=&quot;WeatherSession&quot;,</span>
<span class="sd">            messages=[</span>
<span class="sd">                (&quot;How about the weather tomorrow&quot;, &quot;USER&quot;),</span>
<span class="sd">                (&quot;Tomorrow is cold!&quot;, &quot;ASSISTANT&quot;)</span>
<span class="sd">            ]</span>
<span class="sd">        )</span>
<span class="sd">        print(event)</span>

<span class="sd">        # branch the conversation so that the previous message is not part of the history</span>
<span class="sd">        # (suppose you did not mean to ask about the weather tomorrow and want to undo</span>
<span class="sd">        # that, and replace with a new message)</span>
<span class="sd">        event = client.create_event(</span>
<span class="sd">            memory_id=memory.get(&quot;id&quot;),</span>
<span class="sd">            actor_id=&quot;weatherWorrier&quot;,</span>
<span class="sd">            session_id=&quot;WeatherSession&quot;,</span>
<span class="sd">            branch={&quot;name&quot;: &quot;differentWeatherQuestion&quot;, &quot;rootEventId&quot;: root_event_id},</span>
<span class="sd">            messages=[</span>
<span class="sd">                (&quot;How about the weather a year from now&quot;, &quot;USER&quot;),</span>
<span class="sd">                (&quot;I can&#39;t predict that far into the future!&quot;, &quot;ASSISTANT&quot;)</span>
<span class="sd">            ]</span>
<span class="sd">        )</span>
<span class="sd">        print(event)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">messages</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one message is required&quot;</span><span class="p">)</span>

        <span class="n">payload</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each message must be (text, role)&quot;</span><span class="p">)</span>

            <span class="n">text</span><span class="p">,</span> <span class="n">role</span> <span class="o">=</span> <span class="n">msg</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">role_enum</span> <span class="o">=</span> <span class="n">MessageRole</span><span class="p">(</span><span class="n">role</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Invalid role &#39;</span><span class="si">%s</span><span class="s2">&#39;. Must be one of: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">role</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">MessageRole</span><span class="p">]))</span>
                <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>

            <span class="n">payload</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;conversational&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">},</span> <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">role_enum</span><span class="o">.</span><span class="n">value</span><span class="p">}})</span>

        <span class="c1"># Use provided timestamp or current time</span>
        <span class="k">if</span> <span class="n">event_timestamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">event_timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span>
            <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
            <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
            <span class="s2">&quot;eventTimestamp&quot;</span><span class="p">:</span> <span class="n">event_timestamp</span><span class="p">,</span>
            <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">branch</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;branch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="n">event</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;event&quot;</span><span class="p">]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">event</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to create event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.create_memory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_memory</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">strategies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_expiry_days</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">memory_execution_role_arn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.create_memory" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create a memory with simplified configuration.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_memory</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">event_expiry_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span>
    <span class="n">memory_execution_role_arn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a memory with simplified configuration.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">strategies</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">strategies</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">processed_strategies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_default_namespaces</span><span class="p">(</span><span class="n">strategies</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;eventExpiryDuration&quot;</span><span class="p">:</span> <span class="n">event_expiry_days</span><span class="p">,</span>
            <span class="s2">&quot;memoryStrategies&quot;</span><span class="p">:</span> <span class="n">processed_strategies</span><span class="p">,</span>  <span class="c1"># Using old field name for input</span>
            <span class="s2">&quot;clientToken&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

        <span class="k">if</span> <span class="n">memory_execution_role_arn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;memoryExecutionRoleArn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory_execution_role_arn</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">create_memory</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="n">memory</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span>
        <span class="c1"># Normalize response to handle new field names</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_memory_response</span><span class="p">(</span><span class="n">memory</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;memoryId&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">memory</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to create memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.create_memory_and_wait" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_memory_and_wait</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">strategies</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_expiry_days</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">memory_execution_role_arn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.create_memory_and_wait" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create a memory and wait for it to become ACTIVE.</p>
<p>This method creates a memory and polls until it reaches ACTIVE status,
providing a convenient way to ensure the memory is ready for use.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name for the memory resource</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strategies</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of strategy configurations</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional description</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_expiry_days</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How long to retain events (default: 90 days)</p>
              </div>
            </td>
            <td>
                  <code>90</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>memory_execution_role_arn</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>IAM role ARN for memory execution</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_wait</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum seconds to wait (default: 300)</p>
              </div>
            </td>
            <td>
                  <code>300</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>poll_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seconds between status checks (default: 10)</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Created memory object in ACTIVE status</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TimeoutError">TimeoutError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If memory doesn't become ACTIVE within max_wait</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If memory creation fails</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_memory_and_wait</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">strategies</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">event_expiry_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span>
    <span class="n">memory_execution_role_arn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a memory and wait for it to become ACTIVE.</span>

<span class="sd">    This method creates a memory and polls until it reaches ACTIVE status,</span>
<span class="sd">    providing a convenient way to ensure the memory is ready for use.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: Name for the memory resource</span>
<span class="sd">        strategies: List of strategy configurations</span>
<span class="sd">        description: Optional description</span>
<span class="sd">        event_expiry_days: How long to retain events (default: 90 days)</span>
<span class="sd">        memory_execution_role_arn: IAM role ARN for memory execution</span>
<span class="sd">        max_wait: Maximum seconds to wait (default: 300)</span>
<span class="sd">        poll_interval: Seconds between status checks (default: 10)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created memory object in ACTIVE status</span>

<span class="sd">    Raises:</span>
<span class="sd">        TimeoutError: If memory doesn&#39;t become ACTIVE within max_wait</span>
<span class="sd">        RuntimeError: If memory creation fails</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create the memory</span>
    <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_memory</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">strategies</span><span class="o">=</span><span class="n">strategies</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="n">event_expiry_days</span><span class="o">=</span><span class="n">event_expiry_days</span><span class="p">,</span>
        <span class="n">memory_execution_role_arn</span><span class="o">=</span><span class="n">memory_execution_role_arn</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">memory_id</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryId&quot;</span><span class="p">,</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">))</span>  <span class="c1"># Handle both field names</span>
    <span class="k">if</span> <span class="n">memory_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">memory_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created memory </span><span class="si">%s</span><span class="s2">, waiting for ACTIVE status...&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">max_wait</span><span class="p">:</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory_status</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">MemoryStatus</span><span class="o">.</span><span class="n">ACTIVE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> is now ACTIVE (took </span><span class="si">%d</span><span class="s2"> seconds)&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span>
                <span class="c1"># Get fresh memory details</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>  <span class="c1"># Input uses old field name</span>
                <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_memory_response</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">memory</span>
            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="n">MemoryStatus</span><span class="o">.</span><span class="n">FAILED</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                <span class="c1"># Get failure reason if available</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>  <span class="c1"># Input uses old field name</span>
                <span class="n">failure_reason</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;failureReason&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Memory creation failed: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">failure_reason</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Memory status: </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%d</span><span class="s2"> seconds elapsed)&quot;</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error checking memory status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>

    <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> did not become ACTIVE within </span><span class="si">%d</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.create_or_get_memory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_or_get_memory</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">strategies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_expiry_days</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">memory_execution_role_arn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.create_or_get_memory" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create a memory resource or fetch the existing memory details if it already exists.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory object, either newly created or existing</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_or_get_memory</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">event_expiry_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span>
    <span class="n">memory_execution_role_arn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a memory resource or fetch the existing memory details if it already exists.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Memory object, either newly created or existing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_memory_and_wait</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">strategies</span><span class="o">=</span><span class="n">strategies</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">event_expiry_days</span><span class="o">=</span><span class="n">event_expiry_days</span><span class="p">,</span>
            <span class="n">memory_execution_role_arn</span><span class="o">=</span><span class="n">memory_execution_role_arn</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">memory</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;Error&quot;</span><span class="p">][</span><span class="s2">&quot;Code&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ValidationException&quot;</span> <span class="ow">and</span> <span class="s2">&quot;already exists&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
            <span class="n">memories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_memories</span><span class="p">()</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">memories</span> <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">name</span><span class="p">)),</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Memory already exists. Using existing memory ID: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">memory</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;ClientError: Failed to create or get memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.delete_memory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.delete_memory" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delete a memory resource.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete a memory resource.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">delete_memory</span><span class="p">(</span>
            <span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">clientToken</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
        <span class="p">)</span>  <span class="c1"># Input uses old field name</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Deleted memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to delete memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.delete_memory_and_wait" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_memory_and_wait</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.delete_memory_and_wait" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delete a memory and wait for deletion to complete.</p>
<p>This method deletes a memory and polls until it's fully deleted,
ensuring clean resource cleanup.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID to delete</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_wait</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum seconds to wait (default: 300)</p>
              </div>
            </td>
            <td>
                  <code>300</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>poll_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seconds between checks (default: 10)</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Final deletion response</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TimeoutError">TimeoutError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If deletion doesn't complete within max_wait</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_memory_and_wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete a memory and wait for deletion to complete.</span>

<span class="sd">    This method deletes a memory and polls until it&#39;s fully deleted,</span>
<span class="sd">    ensuring clean resource cleanup.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID to delete</span>
<span class="sd">        max_wait: Maximum seconds to wait (default: 300)</span>
<span class="sd">        poll_interval: Seconds between checks (default: 10)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Final deletion response</span>

<span class="sd">    Raises:</span>
<span class="sd">        TimeoutError: If deletion doesn&#39;t complete within max_wait</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initiate deletion</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Initiated deletion of memory </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">max_wait</span><span class="p">:</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Try to get the memory - if it doesn&#39;t exist, deletion is complete</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>  <span class="c1"># Input uses old field name</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Memory still exists, waiting... (</span><span class="si">%d</span><span class="s2"> seconds elapsed)&quot;</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;Error&quot;</span><span class="p">][</span><span class="s2">&quot;Code&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ResourceNotFoundException&quot;</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> successfully deleted (took </span><span class="si">%d</span><span class="s2"> seconds)&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">response</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error checking memory status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">raise</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>

    <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> was not deleted within </span><span class="si">%d</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.delete_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.delete_strategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delete a strategy from a memory.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_strategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete a strategy from a memory.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_memory_strategies</span><span class="p">(</span><span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">delete_strategy_ids</span><span class="o">=</span><span class="p">[</span><span class="n">strategy_id</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.fork_conversation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fork_conversation</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">root_event_id</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">,</span> <span class="n">new_messages</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.fork_conversation" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Fork a conversation from a specific event to create a new branch.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fork_conversation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">root_event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">branch_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">new_messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fork a conversation from a specific event to create a new branch.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">branch</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;rootEventId&quot;</span><span class="p">:</span> <span class="n">root_event_id</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">}</span>

        <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span>
            <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
            <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
            <span class="n">messages</span><span class="o">=</span><span class="n">new_messages</span><span class="p">,</span>
            <span class="n">branch</span><span class="o">=</span><span class="n">branch</span><span class="p">,</span>
            <span class="n">event_timestamp</span><span class="o">=</span><span class="n">event_timestamp</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created branch &#39;</span><span class="si">%s</span><span class="s2">&#39; from event </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">,</span> <span class="n">root_event_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">event</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to fork conversation: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.get_conversation_tree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_conversation_tree</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.get_conversation_tree" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get a tree structure of the conversation with all branches.</p>
<p>This method transforms a flat list of events into a hierarchical tree structure,
providing visualization-ready data that would be complex to build from raw events.
It handles:
- Full pagination to get all events
- Grouping by branches
- Message summarization
- Tree structure building</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary representing the conversation tree structure</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_conversation_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a tree structure of the conversation with all branches.</span>

<span class="sd">    This method transforms a flat list of events into a hierarchical tree structure,</span>
<span class="sd">    providing visualization-ready data that would be complex to build from raw events.</span>
<span class="sd">    It handles:</span>
<span class="sd">    - Full pagination to get all events</span>
<span class="sd">    - Grouping by branches</span>
<span class="sd">    - Message summarization</span>
<span class="sd">    - Tree structure building</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary representing the conversation tree structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get all events - need to handle pagination for complete list</span>
        <span class="n">all_events</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">next_token</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span> <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span> <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span> <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>

            <span class="k">if</span> <span class="n">next_token</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
            <span class="n">all_events</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[]))</span>

            <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">next_token</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="c1"># Build tree structure</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;session_id&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span> <span class="s2">&quot;actor_id&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span> <span class="s2">&quot;main_branch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;events&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;branches&quot;</span><span class="p">:</span> <span class="p">{}}}</span>

        <span class="c1"># Group events by branch</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">all_events</span><span class="p">:</span>
            <span class="n">event_summary</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;eventId&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">],</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventTimestamp&quot;</span><span class="p">],</span> <span class="s2">&quot;messages&quot;</span><span class="p">:</span> <span class="p">[]}</span>

            <span class="c1"># Extract message summaries</span>
            <span class="k">if</span> <span class="s2">&quot;payload&quot;</span> <span class="ow">in</span> <span class="n">event</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">payload_item</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;payload&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                    <span class="k">if</span> <span class="s2">&quot;conversational&quot;</span> <span class="ow">in</span> <span class="n">payload_item</span><span class="p">:</span>
                        <span class="n">conv</span> <span class="o">=</span> <span class="n">payload_item</span><span class="p">[</span><span class="s2">&quot;conversational&quot;</span><span class="p">]</span>
                        <span class="n">event_summary</span><span class="p">[</span><span class="s2">&quot;messages&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">conv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;role&quot;</span><span class="p">),</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">conv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)[:</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span><span class="p">}</span>
                        <span class="p">)</span>

            <span class="n">branch_info</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;branch&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">branch_info</span><span class="p">:</span>
                <span class="n">branch_name</span> <span class="o">=</span> <span class="n">branch_info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                <span class="n">root_event</span> <span class="o">=</span> <span class="n">branch_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rootEventId&quot;</span><span class="p">)</span>  <span class="c1"># Use .get() to handle missing field</span>

                <span class="k">if</span> <span class="n">branch_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tree</span><span class="p">[</span><span class="s2">&quot;main_branch&quot;</span><span class="p">][</span><span class="s2">&quot;branches&quot;</span><span class="p">]:</span>
                    <span class="n">tree</span><span class="p">[</span><span class="s2">&quot;main_branch&quot;</span><span class="p">][</span><span class="s2">&quot;branches&quot;</span><span class="p">][</span><span class="n">branch_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;root_event_id&quot;</span><span class="p">:</span> <span class="n">root_event</span><span class="p">,</span> <span class="s2">&quot;events&quot;</span><span class="p">:</span> <span class="p">[]}</span>

                <span class="n">tree</span><span class="p">[</span><span class="s2">&quot;main_branch&quot;</span><span class="p">][</span><span class="s2">&quot;branches&quot;</span><span class="p">][</span><span class="n">branch_name</span><span class="p">][</span><span class="s2">&quot;events&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event_summary</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tree</span><span class="p">[</span><span class="s2">&quot;main_branch&quot;</span><span class="p">][</span><span class="s2">&quot;events&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event_summary</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Built conversation tree with </span><span class="si">%d</span><span class="s2"> branches&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="s2">&quot;main_branch&quot;</span><span class="p">][</span><span class="s2">&quot;branches&quot;</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">tree</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to build conversation tree: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.get_last_k_turns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_last_k_turns</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">branch_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_branches</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.get_last_k_turns" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the last K conversation turns.</p>
<p>A "turn" typically consists of a user message followed by assistant response(s).
This method groups messages into logical turns for easier processing.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of turns, where each turn is a list of message dictionaries</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_last_k_turns</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the last K conversation turns.</span>

<span class="sd">    A &quot;turn&quot; typically consists of a user message followed by assistant response(s).</span>
<span class="sd">    This method groups messages into logical turns for easier processing.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of turns, where each turn is a list of message dictionaries</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Use the new list_events method</span>
        <span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span>
            <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
            <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
            <span class="n">branch_name</span><span class="o">=</span><span class="n">branch_name</span><span class="p">,</span>
            <span class="n">include_parent_branches</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="c1"># Process events to group into turns</span>
        <span class="n">turns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_turn</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">turns</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">:</span>
                <span class="k">break</span>  <span class="c1"># Only need last K turns</span>
            <span class="k">for</span> <span class="n">payload_item</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;payload&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                <span class="k">if</span> <span class="s2">&quot;conversational&quot;</span> <span class="ow">in</span> <span class="n">payload_item</span><span class="p">:</span>
                    <span class="n">role</span> <span class="o">=</span> <span class="n">payload_item</span><span class="p">[</span><span class="s2">&quot;conversational&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;role&quot;</span><span class="p">)</span>

                    <span class="c1"># Start new turn on USER message</span>
                    <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="n">Role</span><span class="o">.</span><span class="n">USER</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span> <span class="n">current_turn</span><span class="p">:</span>
                        <span class="n">turns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_turn</span><span class="p">)</span>
                        <span class="n">current_turn</span> <span class="o">=</span> <span class="p">[]</span>

                    <span class="n">current_turn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">payload_item</span><span class="p">[</span><span class="s2">&quot;conversational&quot;</span><span class="p">])</span>

        <span class="c1"># Don&#39;t forget the last turn</span>
        <span class="k">if</span> <span class="n">current_turn</span><span class="p">:</span>
            <span class="n">turns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_turn</span><span class="p">)</span>

        <span class="c1"># Return the last k turns</span>
        <span class="k">return</span> <span class="n">turns</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">turns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">k</span> <span class="k">else</span> <span class="n">turns</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get last K turns: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.get_memory_status" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_memory_status</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.get_memory_status" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get current memory status.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_memory_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get current memory status.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>  <span class="c1"># Input uses old field name</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get memory status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.get_memory_strategies" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_memory_strategies</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.get_memory_strategies" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get all strategies for a memory.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_memory_strategies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all strategies for a memory.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>  <span class="c1"># Input uses old field name</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span>

        <span class="c1"># Handle both old and new field names in response</span>
        <span class="n">strategies</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategies&quot;</span><span class="p">,</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryStrategies&quot;</span><span class="p">,</span> <span class="p">[]))</span>

        <span class="c1"># Normalize strategy fields</span>
        <span class="n">normalized_strategies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
            <span class="c1"># Create normalized version with both old and new field names</span>
            <span class="n">normalized</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="c1"># Ensure both field name versions exist</span>
            <span class="k">if</span> <span class="s2">&quot;strategyId&quot;</span> <span class="ow">in</span> <span class="n">strategy</span> <span class="ow">and</span> <span class="s2">&quot;memoryStrategyId&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;strategyId&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="s2">&quot;memoryStrategyId&quot;</span> <span class="ow">in</span> <span class="n">strategy</span> <span class="ow">and</span> <span class="s2">&quot;strategyId&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;strategyId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">strategy</span> <span class="ow">and</span> <span class="s2">&quot;memoryStrategyType&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;memoryStrategyType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="s2">&quot;memoryStrategyType&quot;</span> <span class="ow">in</span> <span class="n">strategy</span> <span class="ow">and</span> <span class="s2">&quot;type&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;memoryStrategyType&quot;</span><span class="p">]</span>

            <span class="n">normalized_strategies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">normalized</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">normalized_strategies</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get memory strategies: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.list_branch_events" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_branch_events</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">branch_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_parent_branches</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.list_branch_events" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>List events in a specific branch.</p>
<p>This method provides complex filtering and pagination that would require
significant boilerplate code with raw boto3. It handles:
- Automatic pagination across multiple API calls
- Branch filtering with parent event inclusion logic
- Main branch isolation (events without branch info)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Actor identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>branch_name</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Branch name (None for main branch)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_parent_branches</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include events from parent branches</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_results</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum events to return</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of events in the branch</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_branch_events</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_parent_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List events in a specific branch.</span>

<span class="sd">    This method provides complex filtering and pagination that would require</span>
<span class="sd">    significant boilerplate code with raw boto3. It handles:</span>
<span class="sd">    - Automatic pagination across multiple API calls</span>
<span class="sd">    - Branch filtering with parent event inclusion logic</span>
<span class="sd">    - Main branch isolation (events without branch info)</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        actor_id: Actor identifier</span>
<span class="sd">        session_id: Session identifier</span>
<span class="sd">        branch_name: Branch name (None for main branch)</span>
<span class="sd">        include_parent_branches: Whether to include events from parent branches</span>
<span class="sd">        max_results: Maximum events to return</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of events in the branch</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span>
            <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
            <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
            <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_results</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="c1"># Only add filter when we have a specific branch name</span>
        <span class="k">if</span> <span class="n">branch_name</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;branch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">,</span> <span class="s2">&quot;includeParentBranches&quot;</span><span class="p">:</span> <span class="n">include_parent_branches</span><span class="p">}}</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">events</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="c1"># Handle pagination</span>
        <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">next_token</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_results</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;maxResults&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_results</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">))</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
            <span class="n">events</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[]))</span>
            <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>

        <span class="c1"># Filter for main branch if no branch specified</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">branch_name</span><span class="p">:</span>
            <span class="n">events</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">events</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">e</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;branch&quot;</span><span class="p">)]</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieved </span><span class="si">%d</span><span class="s2"> events from branch &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">),</span> <span class="n">branch_name</span> <span class="ow">or</span> <span class="s2">&quot;main&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">events</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list branch events: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.list_branches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_branches</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.list_branches" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>List all branches in a session.</p>
<p>This method handles pagination automatically and provides a structured view
of all conversation branches, which would require complex pagination and
grouping logic if done with raw boto3 calls.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of branch information including name and root event</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_branches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all branches in a session.</span>

<span class="sd">    This method handles pagination automatically and provides a structured view</span>
<span class="sd">    of all conversation branches, which would require complex pagination and</span>
<span class="sd">    grouping logic if done with raw boto3 calls.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of branch information including name and root event</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get all events - need to handle pagination for complete list</span>
        <span class="n">all_events</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">next_token</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span> <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span> <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span> <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>

            <span class="k">if</span> <span class="n">next_token</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
            <span class="n">all_events</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[]))</span>

            <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">next_token</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="n">branches</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">main_branch_events</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">all_events</span><span class="p">:</span>
            <span class="n">branch_info</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;branch&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">branch_info</span><span class="p">:</span>
                <span class="n">branch_name</span> <span class="o">=</span> <span class="n">branch_info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">branch_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">:</span>
                    <span class="n">branches</span><span class="p">[</span><span class="n">branch_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">,</span>
                        <span class="s2">&quot;rootEventId&quot;</span><span class="p">:</span> <span class="n">branch_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rootEventId&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;firstEventId&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;eventCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventTimestamp&quot;</span><span class="p">],</span>
                    <span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">branches</span><span class="p">[</span><span class="n">branch_name</span><span class="p">][</span><span class="s2">&quot;eventCount&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">main_branch_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

        <span class="c1"># Build result list</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Only add main branch if there are actual events</span>
        <span class="k">if</span> <span class="n">main_branch_events</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;rootEventId&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;firstEventId&quot;</span><span class="p">:</span> <span class="n">main_branch_events</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;eventId&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;eventCount&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_branch_events</span><span class="p">),</span>
                    <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="n">main_branch_events</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;eventTimestamp&quot;</span><span class="p">],</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="c1"># Add other branches</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">branches</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Found </span><span class="si">%d</span><span class="s2"> branches in session </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="n">session_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list branches: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.list_events" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_events</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">branch_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_parent_branches</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">include_payload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.list_events" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>List all events in a session with pagination support.</p>
<p>This method provides direct access to the raw events API, allowing developers
to retrieve all events without the turn grouping logic of get_last_k_turns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Actor identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>branch_name</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional branch name to filter events (None for all branches)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_parent_branches</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include parent branch events (only applies with branch_name)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_results</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of events to return</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_payload</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include event payloads in response</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of event dictionaries in chronological order</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <h5 id="bedrock_agentcore.memory.MemoryClient.list_events--get-all-events">Get all events<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.list_events--get-all-events" title="Permanent link">&para;</a></h5>
<p>events = client.list_events(memory_id, actor_id, session_id)</p>
<h5 id="bedrock_agentcore.memory.MemoryClient.list_events--get-only-main-branch-events">Get only main branch events<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.list_events--get-only-main-branch-events" title="Permanent link">&para;</a></h5>
<p>main_events = client.list_events(memory_id, actor_id, session_id, branch_name="main")</p>
<h5 id="bedrock_agentcore.memory.MemoryClient.list_events--get-events-from-a-specific-branch">Get events from a specific branch<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.list_events--get-events-from-a-specific-branch" title="Permanent link">&para;</a></h5>
<p>branch_events = client.list_events(memory_id, actor_id, session_id, branch_name="test-branch")</p>
</details>

            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_events</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_parent_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">include_payload</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all events in a session with pagination support.</span>

<span class="sd">    This method provides direct access to the raw events API, allowing developers</span>
<span class="sd">    to retrieve all events without the turn grouping logic of get_last_k_turns.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        actor_id: Actor identifier</span>
<span class="sd">        session_id: Session identifier</span>
<span class="sd">        branch_name: Optional branch name to filter events (None for all branches)</span>
<span class="sd">        include_parent_branches: Whether to include parent branch events (only applies with branch_name)</span>
<span class="sd">        max_results: Maximum number of events to return</span>
<span class="sd">        include_payload: Whether to include event payloads in response</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of event dictionaries in chronological order</span>

<span class="sd">    Example:</span>
<span class="sd">        # Get all events</span>
<span class="sd">        events = client.list_events(memory_id, actor_id, session_id)</span>

<span class="sd">        # Get only main branch events</span>
<span class="sd">        main_events = client.list_events(memory_id, actor_id, session_id, branch_name=&quot;main&quot;)</span>

<span class="sd">        # Get events from a specific branch</span>
<span class="sd">        branch_events = client.list_events(memory_id, actor_id, session_id, branch_name=&quot;test-branch&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">all_events</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">next_token</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_results</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span>
                <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
                <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
                <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_results</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">)),</span>
                <span class="s2">&quot;includePayloads&quot;</span><span class="p">:</span> <span class="n">include_payload</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">next_token</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>

            <span class="c1"># Add branch filter if specified (but not for &quot;main&quot;)</span>
            <span class="k">if</span> <span class="n">branch_name</span> <span class="ow">and</span> <span class="n">branch_name</span> <span class="o">!=</span> <span class="s2">&quot;main&quot;</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;branch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">,</span> <span class="s2">&quot;includeParentBranches&quot;</span><span class="p">:</span> <span class="n">include_parent_branches</span><span class="p">}</span>
                <span class="p">}</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

            <span class="n">events</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">all_events</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">events</span><span class="p">)</span>

            <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">next_token</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">max_results</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieved total of </span><span class="si">%d</span><span class="s2"> events&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">all_events</span><span class="p">[:</span><span class="n">max_results</span><span class="p">]</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list events: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.list_memories" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_memories</span><span class="p">(</span><span class="n">max_results</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.list_memories" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>List all memories for the account.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_memories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all memories for the account.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Ensure max_results doesn&#39;t exceed API limit per request</span>
        <span class="n">results_per_request</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_results</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">list_memories</span><span class="p">(</span><span class="n">maxResults</span><span class="o">=</span><span class="n">results_per_request</span><span class="p">)</span>
        <span class="n">memories</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memories&quot;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">next_token</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">memories</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_results</span><span class="p">:</span>
            <span class="n">remaining</span> <span class="o">=</span> <span class="n">max_results</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">memories</span><span class="p">)</span>
            <span class="n">results_per_request</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">remaining</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">list_memories</span><span class="p">(</span><span class="n">maxResults</span><span class="o">=</span><span class="n">results_per_request</span><span class="p">,</span> <span class="n">nextToken</span><span class="o">=</span><span class="n">next_token</span><span class="p">)</span>
            <span class="n">memories</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memories&quot;</span><span class="p">,</span> <span class="p">[]))</span>
            <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>

        <span class="c1"># Normalize memory summaries if they contain new field names</span>
        <span class="n">normalized_memories</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">memory</span> <span class="ow">in</span> <span class="n">memories</span><span class="p">[:</span><span class="n">max_results</span><span class="p">]:</span>
            <span class="n">normalized</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="c1"># Ensure both field name versions exist</span>
            <span class="k">if</span> <span class="s2">&quot;id&quot;</span> <span class="ow">in</span> <span class="n">memory</span> <span class="ow">and</span> <span class="s2">&quot;memoryId&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;memoryId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="s2">&quot;memoryId&quot;</span> <span class="ow">in</span> <span class="n">memory</span> <span class="ow">and</span> <span class="s2">&quot;id&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
                <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;memoryId&quot;</span><span class="p">]</span>
            <span class="n">normalized_memories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">normalized</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">normalized_memories</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list memories: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.merge_branch_context" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">merge_branch_context</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">,</span> <span class="n">include_parent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.merge_branch_context" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get all messages from a branch for context building.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Actor identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>branch_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Branch to get context from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_parent</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include parent branch events</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of all messages in chronological order</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">merge_branch_context</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">include_parent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all messages from a branch for context building.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        actor_id: Actor identifier</span>
<span class="sd">        session_id: Session identifier</span>
<span class="sd">        branch_name: Branch to get context from</span>
<span class="sd">        include_parent: Whether to include parent branch events</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of all messages in chronological order</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_branch_events</span><span class="p">(</span>
        <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
        <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
        <span class="n">branch_name</span><span class="o">=</span><span class="n">branch_name</span><span class="p">,</span>
        <span class="n">include_parent_branches</span><span class="o">=</span><span class="n">include_parent</span><span class="p">,</span>
        <span class="n">max_results</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">messages</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;payload&quot;</span> <span class="ow">in</span> <span class="n">event</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">payload_item</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;payload&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                <span class="k">if</span> <span class="s2">&quot;conversational&quot;</span> <span class="ow">in</span> <span class="n">payload_item</span><span class="p">:</span>
                    <span class="n">conv</span> <span class="o">=</span> <span class="n">payload_item</span><span class="p">[</span><span class="s2">&quot;conversational&quot;</span><span class="p">]</span>
                    <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventTimestamp&quot;</span><span class="p">],</span>
                            <span class="s2">&quot;eventId&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">],</span>
                            <span class="s2">&quot;branch&quot;</span><span class="p">:</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;branch&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;main&quot;</span><span class="p">),</span>
                            <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">conv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;role&quot;</span><span class="p">),</span>
                            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">conv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                        <span class="p">}</span>
                    <span class="p">)</span>

    <span class="c1"># Sort by timestamp</span>
    <span class="n">messages</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">])</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieved </span><span class="si">%d</span><span class="s2"> messages from branch &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">messages</span><span class="p">),</span> <span class="n">branch_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">messages</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.modify_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">modify_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">configuration</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.modify_strategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Modify a strategy with full control over configuration.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">modify_strategy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">configuration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Modify a strategy with full control over configuration.&quot;&quot;&quot;</span>
    <span class="n">modify_config</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">:</span> <span class="n">strategy_id</span><span class="p">}</span>  <span class="c1"># Using old field name for input</span>

    <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">modify_config</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>
    <span class="k">if</span> <span class="n">namespaces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">modify_config</span><span class="p">[</span><span class="s2">&quot;namespaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">namespaces</span>
    <span class="k">if</span> <span class="n">configuration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">modify_config</span><span class="p">[</span><span class="s2">&quot;configuration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">configuration</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_memory_strategies</span><span class="p">(</span><span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">modify_strategies</span><span class="o">=</span><span class="p">[</span><span class="n">modify_config</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.process_turn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_turn</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">user_input</span><span class="p">,</span> <span class="n">agent_response</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retrieval_namespace</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retrieval_query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.process_turn" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>DEPRECATED: Use retrieve_memories() and save_conversation() separately.</p>
<p>This method will be removed in v1.0.0.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_turn</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">agent_response</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retrieval_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retrieval_query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;DEPRECATED: Use retrieve_memories() and save_conversation() separately.</span>

<span class="sd">    This method will be removed in v1.0.0.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">&quot;process_turn() is deprecated and will be removed in v1.0.0. &quot;</span>
        <span class="s2">&quot;Use retrieve_memories() and save_conversation() separately, or use process_turn_with_llm().&quot;</span><span class="p">,</span>
        <span class="ne">DeprecationWarning</span><span class="p">,</span>
        <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">retrieved_memories</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">retrieval_namespace</span><span class="p">:</span>
        <span class="n">search_query</span> <span class="o">=</span> <span class="n">retrieval_query</span> <span class="ow">or</span> <span class="n">user_input</span>
        <span class="n">retrieved_memories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_memories</span><span class="p">(</span>
            <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">retrieval_namespace</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">search_query</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="n">top_k</span>
        <span class="p">)</span>

    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_turn</span><span class="p">(</span>
        <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
        <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
        <span class="n">user_input</span><span class="o">=</span><span class="n">user_input</span><span class="p">,</span>
        <span class="n">agent_response</span><span class="o">=</span><span class="n">agent_response</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="o">=</span><span class="n">event_timestamp</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">retrieved_memories</span><span class="p">,</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.process_turn_with_llm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_turn_with_llm</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">user_input</span><span class="p">,</span> <span class="n">llm_callback</span><span class="p">,</span> <span class="n">retrieval_namespace</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retrieval_query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.process_turn_with_llm" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Complete conversation turn with LLM callback integration.</p>
<p>This method combines memory retrieval, LLM invocation, and response storage
in a single call using a callback pattern.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Actor identifier (e.g., "user-123")</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>user_input</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The user's message</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>llm_callback</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]], <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function that takes (user_input, memories) and returns agent_response
         The callback receives the user input and retrieved memories,
         and should return the agent's response string</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>retrieval_namespace</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Namespace to search for memories (optional)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>retrieval_query</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom search query (defaults to user_input)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>top_k</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of memories to retrieve</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_timestamp</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="datetime.datetime">datetime</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional timestamp for the event</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]], <span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (retrieved_memories, agent_response, created_event)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>def my_llm(user_input: str, memories: List[Dict]) -&gt; str:
    # Format context from memories
    context = "\n".join([m['content']['text'] for m in memories])</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Call your LLM (Bedrock, OpenAI, etc.)</span>
<span class="n">response</span> = <span class="n">bedrock</span>.<span class="n">invoke_model</span>(
    <span class="n">messages</span>=[
        {<span class="s">&quot;role&quot;</span>: <span class="s">&quot;system&quot;</span>, <span class="s">&quot;content&quot;</span>: <span class="nb">f</span><span class="s">&quot;Context: {context}&quot;</span>},
        {<span class="s">&quot;role&quot;</span>: <span class="s">&quot;user&quot;</span>, <span class="s">&quot;content&quot;</span>: <span class="n">user_input</span>}
    ]
)
<span class="k">return</span> <span class="n">response</span>[<span class="s">&#39;content&#39;</span>]
</code></pre></div>

<p>memories, response, event = client.process_turn_with_llm(
    memory_id="mem-xyz",
    actor_id="user-123",
    session_id="session-456",
    user_input="What did we discuss yesterday?",
    llm_callback=my_llm,
    retrieval_namespace="support/facts/{sessionId}"
)</p>
</details>

            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_turn_with_llm</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">llm_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">retrieval_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retrieval_query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Complete conversation turn with LLM callback integration.</span>

<span class="sd">    This method combines memory retrieval, LLM invocation, and response storage</span>
<span class="sd">    in a single call using a callback pattern.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        actor_id: Actor identifier (e.g., &quot;user-123&quot;)</span>
<span class="sd">        session_id: Session identifier</span>
<span class="sd">        user_input: The user&#39;s message</span>
<span class="sd">        llm_callback: Function that takes (user_input, memories) and returns agent_response</span>
<span class="sd">                     The callback receives the user input and retrieved memories,</span>
<span class="sd">                     and should return the agent&#39;s response string</span>
<span class="sd">        retrieval_namespace: Namespace to search for memories (optional)</span>
<span class="sd">        retrieval_query: Custom search query (defaults to user_input)</span>
<span class="sd">        top_k: Number of memories to retrieve</span>
<span class="sd">        event_timestamp: Optional timestamp for the event</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (retrieved_memories, agent_response, created_event)</span>

<span class="sd">    Example:</span>
<span class="sd">        def my_llm(user_input: str, memories: List[Dict]) -&gt; str:</span>
<span class="sd">            # Format context from memories</span>
<span class="sd">            context = &quot;\\n&quot;.join([m[&#39;content&#39;][&#39;text&#39;] for m in memories])</span>

<span class="sd">            # Call your LLM (Bedrock, OpenAI, etc.)</span>
<span class="sd">            response = bedrock.invoke_model(</span>
<span class="sd">                messages=[</span>
<span class="sd">                    {&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: f&quot;Context: {context}&quot;},</span>
<span class="sd">                    {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: user_input}</span>
<span class="sd">                ]</span>
<span class="sd">            )</span>
<span class="sd">            return response[&#39;content&#39;]</span>

<span class="sd">        memories, response, event = client.process_turn_with_llm(</span>
<span class="sd">            memory_id=&quot;mem-xyz&quot;,</span>
<span class="sd">            actor_id=&quot;user-123&quot;,</span>
<span class="sd">            session_id=&quot;session-456&quot;,</span>
<span class="sd">            user_input=&quot;What did we discuss yesterday?&quot;,</span>
<span class="sd">            llm_callback=my_llm,</span>
<span class="sd">            retrieval_namespace=&quot;support/facts/{sessionId}&quot;</span>
<span class="sd">        )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Step 1: Retrieve relevant memories</span>
    <span class="n">retrieved_memories</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">retrieval_namespace</span><span class="p">:</span>
        <span class="n">search_query</span> <span class="o">=</span> <span class="n">retrieval_query</span> <span class="ow">or</span> <span class="n">user_input</span>
        <span class="n">retrieved_memories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_memories</span><span class="p">(</span>
            <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">retrieval_namespace</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">search_query</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="n">top_k</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieved </span><span class="si">%d</span><span class="s2"> memories for LLM context&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">retrieved_memories</span><span class="p">))</span>

    <span class="c1"># Step 2: Invoke LLM callback</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">agent_response</span> <span class="o">=</span> <span class="n">llm_callback</span><span class="p">(</span><span class="n">user_input</span><span class="p">,</span> <span class="n">retrieved_memories</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agent_response</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;LLM callback must return a string response&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;LLM callback generated response&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;LLM callback failed: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>

    <span class="c1"># Step 3: Save the conversation turn</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span>
        <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
        <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
        <span class="n">messages</span><span class="o">=</span><span class="p">[(</span><span class="n">user_input</span><span class="p">,</span> <span class="s2">&quot;USER&quot;</span><span class="p">),</span> <span class="p">(</span><span class="n">agent_response</span><span class="p">,</span> <span class="s2">&quot;ASSISTANT&quot;</span><span class="p">)],</span>
        <span class="n">event_timestamp</span><span class="o">=</span><span class="n">event_timestamp</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Completed full conversation turn with LLM&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">retrieved_memories</span><span class="p">,</span> <span class="n">agent_response</span><span class="p">,</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.retrieve_memories" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">retrieve_memories</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">actor_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.retrieve_memories" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Retrieve relevant memories from a namespace.</p>
<p>Note: Wildcards (*) are NOT supported in namespaces. You must provide the
exact namespace path with all variables resolved.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespace</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exact namespace path (no wildcards)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search query</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor_id</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional actor ID (deprecated, use namespace)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>top_k</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of results to return</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of memory records</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <h5 id="bedrock_agentcore.memory.MemoryClient.retrieve_memories--correct-exact-namespace">Correct - exact namespace<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.retrieve_memories--correct-exact-namespace" title="Permanent link">&para;</a></h5>
<p>memories = client.retrieve_memories(
    memory_id="mem-123",
    namespace="support/facts/session-456",
    query="customer preferences"
)</p>
<h5 id="bedrock_agentcore.memory.MemoryClient.retrieve_memories--incorrect-wildcards-not-supported">Incorrect - wildcards not supported<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.retrieve_memories--incorrect-wildcards-not-supported" title="Permanent link">&para;</a></h5>
<h5 id="bedrock_agentcore.memory.MemoryClient.retrieve_memories--memories-clientretrieve_memories-namespacesupportfacts">memories = client.retrieve_memories(..., namespace="support/facts/*", ...)<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.retrieve_memories--memories-clientretrieve_memories-namespacesupportfacts" title="Permanent link">&para;</a></h5>
</details>

            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">retrieve_memories</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve relevant memories from a namespace.</span>

<span class="sd">    Note: Wildcards (*) are NOT supported in namespaces. You must provide the</span>
<span class="sd">    exact namespace path with all variables resolved.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        namespace: Exact namespace path (no wildcards)</span>
<span class="sd">        query: Search query</span>
<span class="sd">        actor_id: Optional actor ID (deprecated, use namespace)</span>
<span class="sd">        top_k: Number of results to return</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of memory records</span>

<span class="sd">    Example:</span>
<span class="sd">        # Correct - exact namespace</span>
<span class="sd">        memories = client.retrieve_memories(</span>
<span class="sd">            memory_id=&quot;mem-123&quot;,</span>
<span class="sd">            namespace=&quot;support/facts/session-456&quot;,</span>
<span class="sd">            query=&quot;customer preferences&quot;</span>
<span class="sd">        )</span>

<span class="sd">        # Incorrect - wildcards not supported</span>
<span class="sd">        # memories = client.retrieve_memories(..., namespace=&quot;support/facts/*&quot;, ...)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;*&quot;</span> <span class="ow">in</span> <span class="n">namespace</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Wildcards are not supported in namespaces. Please provide exact namespace.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Let service handle all namespace validation</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">retrieve_memory_records</span><span class="p">(</span>
            <span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span> <span class="n">searchCriteria</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;searchQuery&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span> <span class="s2">&quot;topK&quot;</span><span class="p">:</span> <span class="n">top_k</span><span class="p">}</span>
        <span class="p">)</span>

        <span class="n">memories</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryRecordSummaries&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieved </span><span class="si">%d</span><span class="s2"> memories from namespace: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">memories</span><span class="p">),</span> <span class="n">namespace</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">memories</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error_code</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;Error&quot;</span><span class="p">][</span><span class="s2">&quot;Code&quot;</span><span class="p">]</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;Error&quot;</span><span class="p">][</span><span class="s2">&quot;Message&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">error_code</span> <span class="o">==</span> <span class="s2">&quot;ResourceNotFoundException&quot;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Memory or namespace not found. Ensure memory </span><span class="si">%s</span><span class="s2"> exists and namespace &#39;</span><span class="si">%s</span><span class="s2">&#39; is configured&quot;</span><span class="p">,</span>
                <span class="n">memory_id</span><span class="p">,</span>
                <span class="n">namespace</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">error_code</span> <span class="o">==</span> <span class="s2">&quot;ValidationException&quot;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid search parameters: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">error_msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">error_code</span> <span class="o">==</span> <span class="s2">&quot;ServiceException&quot;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Service error: </span><span class="si">%s</span><span class="s2">. This may be temporary - try again later&quot;</span><span class="p">,</span> <span class="n">error_msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Memory retrieval failed (</span><span class="si">%s</span><span class="s2">): </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">error_code</span><span class="p">,</span> <span class="n">error_msg</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.save_conversation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_conversation</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">messages</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">branch</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.save_conversation" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>DEPRECATED: Use create_event() instead.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Actor identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>messages</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of (text, role) tuples. Role can be USER, ASSISTANT, TOOL, etc.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_timestamp</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="datetime.datetime">datetime</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional timestamp for the entire event (not per message)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>branch</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional branch info. For new branches: {"rootEventId": "...", "name": "..."}
   For continuing existing branch: {"name": "..."} or {"name": "...", "rootEventId": "..."}</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Created event</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <h5 id="bedrock_agentcore.memory.MemoryClient.save_conversation--save-multi-turn-conversation">Save multi-turn conversation<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.save_conversation--save-multi-turn-conversation" title="Permanent link">&para;</a></h5>
<p>event = client.save_conversation(
    memory_id="mem-xyz",
    actor_id="user-123",
    session_id="session-456",
    messages=[
        ("What's the weather?", "USER"),
        ("And tomorrow?", "USER"),
        ("Checking weather...", "TOOL"),
        ("Today sunny, tomorrow rain", "ASSISTANT")
    ]
)</p>
<h5 id="bedrock_agentcore.memory.MemoryClient.save_conversation--continue-existing-branch-only-name-required">Continue existing branch (only name required)<a class="headerlink" href="#bedrock_agentcore.memory.MemoryClient.save_conversation--continue-existing-branch-only-name-required" title="Permanent link">&para;</a></h5>
<p>event = client.save_conversation(
    memory_id="mem-xyz",
    actor_id="user-123",
    session_id="session-456",
    messages=[("Continue conversation", "USER")],
    branch={"name": "existing-branch"}
)</p>
</details>

            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_conversation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">branch</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;DEPRECATED: Use create_event() instead.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        actor_id: Actor identifier</span>
<span class="sd">        session_id: Session identifier</span>
<span class="sd">        messages: List of (text, role) tuples. Role can be USER, ASSISTANT, TOOL, etc.</span>
<span class="sd">        event_timestamp: Optional timestamp for the entire event (not per message)</span>
<span class="sd">        branch: Optional branch info. For new branches: {&quot;rootEventId&quot;: &quot;...&quot;, &quot;name&quot;: &quot;...&quot;}</span>
<span class="sd">               For continuing existing branch: {&quot;name&quot;: &quot;...&quot;} or {&quot;name&quot;: &quot;...&quot;, &quot;rootEventId&quot;: &quot;...&quot;}</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created event</span>

<span class="sd">    Example:</span>
<span class="sd">        # Save multi-turn conversation</span>
<span class="sd">        event = client.save_conversation(</span>
<span class="sd">            memory_id=&quot;mem-xyz&quot;,</span>
<span class="sd">            actor_id=&quot;user-123&quot;,</span>
<span class="sd">            session_id=&quot;session-456&quot;,</span>
<span class="sd">            messages=[</span>
<span class="sd">                (&quot;What&#39;s the weather?&quot;, &quot;USER&quot;),</span>
<span class="sd">                (&quot;And tomorrow?&quot;, &quot;USER&quot;),</span>
<span class="sd">                (&quot;Checking weather...&quot;, &quot;TOOL&quot;),</span>
<span class="sd">                (&quot;Today sunny, tomorrow rain&quot;, &quot;ASSISTANT&quot;)</span>
<span class="sd">            ]</span>
<span class="sd">        )</span>

<span class="sd">        # Continue existing branch (only name required)</span>
<span class="sd">        event = client.save_conversation(</span>
<span class="sd">            memory_id=&quot;mem-xyz&quot;,</span>
<span class="sd">            actor_id=&quot;user-123&quot;,</span>
<span class="sd">            session_id=&quot;session-456&quot;,</span>
<span class="sd">            messages=[(&quot;Continue conversation&quot;, &quot;USER&quot;)],</span>
<span class="sd">            branch={&quot;name&quot;: &quot;existing-branch&quot;}</span>
<span class="sd">        )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">messages</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one message is required&quot;</span><span class="p">)</span>

        <span class="c1"># Build payload</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each message must be (text, role)&quot;</span><span class="p">)</span>

            <span class="n">text</span><span class="p">,</span> <span class="n">role</span> <span class="o">=</span> <span class="n">msg</span>

            <span class="c1"># Validate role</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">role_enum</span> <span class="o">=</span> <span class="n">MessageRole</span><span class="p">(</span><span class="n">role</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Invalid role &#39;</span><span class="si">%s</span><span class="s2">&#39;. Must be one of: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">role</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">r</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">MessageRole</span><span class="p">]))</span>
                <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>

            <span class="n">payload</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;conversational&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">},</span> <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">role_enum</span><span class="o">.</span><span class="n">value</span><span class="p">}})</span>

        <span class="c1"># Use provided timestamp or current time</span>
        <span class="k">if</span> <span class="n">event_timestamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">event_timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span>
            <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
            <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
            <span class="s2">&quot;eventTimestamp&quot;</span><span class="p">:</span> <span class="n">event_timestamp</span><span class="p">,</span>
            <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
            <span class="s2">&quot;clientToken&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">branch</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;branch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmdp_client</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="n">event</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;event&quot;</span><span class="p">]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">event</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to create event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.save_turn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_turn</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">user_input</span><span class="p">,</span> <span class="n">agent_response</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.save_turn" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>DEPRECATED: Use save_conversation() for more flexibility.</p>
<p>This method will be removed in v1.0.0.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_turn</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">agent_response</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;DEPRECATED: Use save_conversation() for more flexibility.</span>

<span class="sd">    This method will be removed in v1.0.0.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">&quot;save_turn() is deprecated and will be removed in v1.0.0. &quot;</span>
        <span class="s2">&quot;Use save_conversation() for flexible message handling.&quot;</span><span class="p">,</span>
        <span class="ne">DeprecationWarning</span><span class="p">,</span>
        <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">messages</span> <span class="o">=</span> <span class="p">[(</span><span class="n">user_input</span><span class="p">,</span> <span class="s2">&quot;USER&quot;</span><span class="p">),</span> <span class="p">(</span><span class="n">agent_response</span><span class="p">,</span> <span class="s2">&quot;ASSISTANT&quot;</span><span class="p">)]</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span>
        <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
        <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
        <span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="o">=</span><span class="n">event_timestamp</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.update_memory_strategies" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_memory_strategies</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">add_strategies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_strategies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delete_strategy_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.update_memory_strategies" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Update memory strategies - add, modify, or delete.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_memory_strategies</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">add_strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">modify_strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delete_strategy_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update memory strategies - add, modify, or delete.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">memory_strategies</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">add_strategies</span><span class="p">:</span>
            <span class="n">processed_add</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_default_namespaces</span><span class="p">(</span><span class="n">add_strategies</span><span class="p">)</span>
            <span class="n">memory_strategies</span><span class="p">[</span><span class="s2">&quot;addMemoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processed_add</span>  <span class="c1"># Using old field name for input</span>

        <span class="k">if</span> <span class="n">modify_strategies</span><span class="p">:</span>
            <span class="n">current_strategies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory_strategies</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>
            <span class="n">strategy_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">[</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">]:</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">current_strategies</span><span class="p">}</span>  <span class="c1"># Using normalized field</span>

            <span class="n">modify_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">modify_strategies</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;memoryStrategyId&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">strategy</span><span class="p">:</span>  <span class="c1"># Using old field name</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each modify strategy must include memoryStrategyId&quot;</span><span class="p">)</span>

                <span class="n">strategy_id</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">]</span>  <span class="c1"># Using old field name</span>
                <span class="n">strategy_info</span> <span class="o">=</span> <span class="n">strategy_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">strategy_id</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">strategy_info</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Strategy </span><span class="si">%s</span><span class="s2"> not found in memory </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">strategy_id</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">))</span>

                <span class="n">strategy_type</span> <span class="o">=</span> <span class="n">strategy_info</span><span class="p">[</span><span class="s2">&quot;memoryStrategyType&quot;</span><span class="p">]</span>  <span class="c1"># Using normalized field</span>
                <span class="n">override_type</span> <span class="o">=</span> <span class="n">strategy_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;configuration&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>

                <span class="n">strategy_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">strategy</span><span class="p">)</span>

                <span class="k">if</span> <span class="s2">&quot;configuration&quot;</span> <span class="ow">in</span> <span class="n">strategy_copy</span><span class="p">:</span>
                    <span class="n">wrapped_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_configuration</span><span class="p">(</span>
                        <span class="n">strategy_copy</span><span class="p">[</span><span class="s2">&quot;configuration&quot;</span><span class="p">],</span> <span class="n">strategy_type</span><span class="p">,</span> <span class="n">override_type</span>
                    <span class="p">)</span>
                    <span class="n">strategy_copy</span><span class="p">[</span><span class="s2">&quot;configuration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wrapped_config</span>

                <span class="n">modify_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">strategy_copy</span><span class="p">)</span>

            <span class="n">memory_strategies</span><span class="p">[</span><span class="s2">&quot;modifyMemoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">modify_list</span>  <span class="c1"># Using old field name for input</span>

        <span class="k">if</span> <span class="n">delete_strategy_ids</span><span class="p">:</span>
            <span class="n">delete_list</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">:</span> <span class="n">sid</span><span class="p">}</span> <span class="k">for</span> <span class="n">sid</span> <span class="ow">in</span> <span class="n">delete_strategy_ids</span><span class="p">]</span>  <span class="c1"># Using old field name</span>
            <span class="n">memory_strategies</span><span class="p">[</span><span class="s2">&quot;deleteMemoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">delete_list</span>  <span class="c1"># Using old field name for input</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">memory_strategies</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No strategy operations provided&quot;</span><span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcp_client</span><span class="o">.</span><span class="n">update_memory</span><span class="p">(</span>
            <span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
            <span class="n">memoryStrategies</span><span class="o">=</span><span class="n">memory_strategies</span><span class="p">,</span>
            <span class="n">clientToken</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>  <span class="c1"># Using old field names for input</span>
        <span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updated memory strategies for: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_memory_response</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">memory</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to update memory strategies: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.update_memory_strategies_and_wait" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_memory_strategies_and_wait</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">add_strategies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_strategies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delete_strategy_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.update_memory_strategies_and_wait" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Update memory strategies and wait for memory to return to ACTIVE state.</p>
<p>This method handles the temporary CREATING state that occurs when
updating strategies, preventing subsequent update errors.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_memory_strategies_and_wait</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">add_strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">modify_strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delete_strategy_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update memory strategies and wait for memory to return to ACTIVE state.</span>

<span class="sd">    This method handles the temporary CREATING state that occurs when</span>
<span class="sd">    updating strategies, preventing subsequent update errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Update strategies</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_memory_strategies</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">add_strategies</span><span class="p">,</span> <span class="n">modify_strategies</span><span class="p">,</span> <span class="n">delete_strategy_ids</span><span class="p">)</span>

    <span class="c1"># Wait for memory to return to ACTIVE</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryClient.wait_for_memories" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wait_for_memories</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">test_query</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryClient.wait_for_memories" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Wait for memory extraction to complete by polling.</p>
<p>IMPORTANT LIMITATIONS:
1. This method only works reliably on empty namespaces. If there are already
   existing memories in the namespace, this method may return True immediately
   even if new extractions haven't completed.
2. Wildcards (<em>) are NOT supported in namespaces. You must provide the exact
   namespace path with all variables resolved (e.g., "support/facts/session-123"
   not "support/facts/</em>").</p>
<p>For subsequent extractions in populated namespaces, use a fixed wait time:
    time.sleep(150)  # Wait 2.5 minutes for extraction</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespace</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exact namespace to check (no wildcards)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test_query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Query to test with (default: "test")</p>
              </div>
            </td>
            <td>
                  <code>&#39;test&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_wait</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum seconds to wait (default: 180)</p>
              </div>
            </td>
            <td>
                  <code>180</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>poll_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seconds between checks (default: 15)</p>
              </div>
            </td>
            <td>
                  <code>15</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if memories found, False if timeout</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This method will be deprecated in future versions once the API
provides extraction status or timestamps.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">wait_for_memories</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">test_query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">180</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wait for memory extraction to complete by polling.</span>

<span class="sd">    IMPORTANT LIMITATIONS:</span>
<span class="sd">    1. This method only works reliably on empty namespaces. If there are already</span>
<span class="sd">       existing memories in the namespace, this method may return True immediately</span>
<span class="sd">       even if new extractions haven&#39;t completed.</span>
<span class="sd">    2. Wildcards (*) are NOT supported in namespaces. You must provide the exact</span>
<span class="sd">       namespace path with all variables resolved (e.g., &quot;support/facts/session-123&quot;</span>
<span class="sd">       not &quot;support/facts/*&quot;).</span>

<span class="sd">    For subsequent extractions in populated namespaces, use a fixed wait time:</span>
<span class="sd">        time.sleep(150)  # Wait 2.5 minutes for extraction</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        namespace: Exact namespace to check (no wildcards)</span>
<span class="sd">        test_query: Query to test with (default: &quot;test&quot;)</span>
<span class="sd">        max_wait: Maximum seconds to wait (default: 180)</span>
<span class="sd">        poll_interval: Seconds between checks (default: 15)</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if memories found, False if timeout</span>

<span class="sd">    Note:</span>
<span class="sd">        This method will be deprecated in future versions once the API</span>
<span class="sd">        provides extraction status or timestamps.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;*&quot;</span> <span class="ow">in</span> <span class="n">namespace</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Wildcards are not supported in namespaces. Please provide exact namespace.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
        <span class="s2">&quot;wait_for_memories() only works reliably on empty namespaces. &quot;</span>
        <span class="s2">&quot;For populated namespaces, consider using a fixed wait time instead.&quot;</span>
    <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Waiting for memory extraction in namespace: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">service_errors</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">max_wait</span><span class="p">:</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">memories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_memories</span><span class="p">(</span><span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">test_query</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">memories</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Memory extraction complete after </span><span class="si">%d</span><span class="s2"> seconds&quot;</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="c1"># Reset service error count on successful call</span>
            <span class="n">service_errors</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;ServiceException&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                <span class="n">service_errors</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">service_errors</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Multiple service errors - the service may be experiencing issues&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Retrieval attempt failed: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">max_wait</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No memories found after </span><span class="si">%d</span><span class="s2"> seconds&quot;</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">service_errors</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Note: Encountered </span><span class="si">%d</span><span class="s2"> service errors during polling&quot;</span><span class="p">,</span> <span class="n">service_errors</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="bedrock_agentcore.memory.MemoryControlPlaneClient" class="doc doc-heading">
            <code>MemoryControlPlaneClient</code>


<a href="#bedrock_agentcore.memory.MemoryControlPlaneClient" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">


        <p>Client for Bedrock AgentCore Memory control plane operations.</p>








              <details class="quote">
                <summary>Source code in <code>bedrock_agentcore/memory/controlplane.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MemoryControlPlaneClient</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Client for Bedrock AgentCore Memory control plane operations.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;us-west-2&quot;</span><span class="p">,</span> <span class="n">environment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;prod&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Memory Control Plane client.</span>

<span class="sd">        Args:</span>
<span class="sd">            region_name: AWS region name</span>
<span class="sd">            environment: Environment name (prod, gamma, etc.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region_name</span> <span class="o">=</span> <span class="n">region_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="o">=</span> <span class="n">environment</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
            <span class="s2">&quot;BEDROCK_AGENTCORE_CONTROL_ENDPOINT&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;https://bedrock-agentcore-control.</span><span class="si">{</span><span class="n">region_name</span><span class="si">}</span><span class="s2">.amazonaws.com&quot;</span>
        <span class="p">)</span>

        <span class="n">service_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;BEDROCK_AGENTCORE_CONTROL_SERVICE&quot;</span><span class="p">,</span> <span class="s2">&quot;bedrock-agentcore-control&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="n">service_name</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">region_name</span><span class="p">,</span> <span class="n">endpoint_url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Initialized MemoryControlPlaneClient for </span><span class="si">%s</span><span class="s2"> in </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">environment</span><span class="p">,</span> <span class="n">region_name</span><span class="p">)</span>

    <span class="c1"># ==================== MEMORY OPERATIONS ====================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_memory</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">event_expiry_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">memory_execution_role_arn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">wait_for_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
        <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a memory resource with optional strategies.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Name for the memory resource</span>
<span class="sd">            event_expiry_days: How long to retain events (default: 90 days)</span>
<span class="sd">            description: Optional description</span>
<span class="sd">            memory_execution_role_arn: IAM role ARN for memory execution</span>
<span class="sd">            strategies: Optional list of strategy configurations</span>
<span class="sd">            wait_for_active: Whether to wait for memory to become ACTIVE</span>
<span class="sd">            max_wait: Maximum seconds to wait if wait_for_active is True</span>
<span class="sd">            poll_interval: Seconds between status checks if wait_for_active is True</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created memory object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;eventExpiryDuration&quot;</span><span class="p">:</span> <span class="n">event_expiry_days</span><span class="p">,</span>
            <span class="s2">&quot;clientToken&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

        <span class="k">if</span> <span class="n">memory_execution_role_arn</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;memoryExecutionRoleArn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory_execution_role_arn</span>

        <span class="k">if</span> <span class="n">strategies</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;memoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategies</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">create_memory</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span>
            <span class="n">memory_id</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">wait_for_active</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">memory</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to create memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">include_strategies</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a memory resource by ID.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            include_strategies: Whether to include strategy details in response</span>

<span class="sd">        Returns:</span>
<span class="sd">            Memory resource details</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span>

            <span class="c1"># Add strategy count</span>
            <span class="n">strategies</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategies&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;strategyCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">strategies</span><span class="p">)</span>

            <span class="c1"># Remove strategies if not requested</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">include_strategies</span> <span class="ow">and</span> <span class="s2">&quot;strategies&quot;</span> <span class="ow">in</span> <span class="n">memory</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;strategies&quot;</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">memory</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_memories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List all memories for the account with pagination support.</span>

<span class="sd">        Args:</span>
<span class="sd">            max_results: Maximum number of memories to return</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of memory summaries</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">memories</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">next_token</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">memories</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_results</span><span class="p">:</span>
                <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_results</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">memories</span><span class="p">))}</span>
                <span class="k">if</span> <span class="n">next_token</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>

                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">list_memories</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
                <span class="n">batch</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memories&quot;</span><span class="p">,</span> <span class="p">[])</span>
                <span class="n">memories</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

                <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">next_token</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">memories</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">max_results</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="c1"># Add strategy count to each memory summary</span>
            <span class="k">for</span> <span class="n">memory</span> <span class="ow">in</span> <span class="n">memories</span><span class="p">:</span>
                <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;strategyCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># List memories doesn&#39;t include strategies</span>

            <span class="k">return</span> <span class="n">memories</span><span class="p">[:</span><span class="n">max_results</span><span class="p">]</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list memories: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_memory</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_expiry_days</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">memory_execution_role_arn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">add_strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">modify_strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">delete_strategy_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">wait_for_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
        <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update a memory resource properties and/or strategies.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            description: Optional new description</span>
<span class="sd">            event_expiry_days: Optional new event expiry duration</span>
<span class="sd">            memory_execution_role_arn: Optional new execution role ARN</span>
<span class="sd">            add_strategies: Optional list of strategies to add</span>
<span class="sd">            modify_strategies: Optional list of strategies to modify</span>
<span class="sd">            delete_strategy_ids: Optional list of strategy IDs to delete</span>
<span class="sd">            wait_for_active: Whether to wait for memory to become ACTIVE</span>
<span class="sd">            max_wait: Maximum seconds to wait if wait_for_active is True</span>
<span class="sd">            poll_interval: Seconds between status checks if wait_for_active is True</span>

<span class="sd">        Returns:</span>
<span class="sd">            Updated memory object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span>
            <span class="s2">&quot;clientToken&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
        <span class="p">}</span>

        <span class="c1"># Add memory properties if provided</span>
        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

        <span class="k">if</span> <span class="n">event_expiry_days</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;eventExpiryDuration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">event_expiry_days</span>

        <span class="k">if</span> <span class="n">memory_execution_role_arn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;memoryExecutionRoleArn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory_execution_role_arn</span>

        <span class="c1"># Add strategy operations if provided</span>
        <span class="n">memory_strategies</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">add_strategies</span><span class="p">:</span>
            <span class="n">memory_strategies</span><span class="p">[</span><span class="s2">&quot;addMemoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">add_strategies</span>

        <span class="k">if</span> <span class="n">modify_strategies</span><span class="p">:</span>
            <span class="n">memory_strategies</span><span class="p">[</span><span class="s2">&quot;modifyMemoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">modify_strategies</span>

        <span class="k">if</span> <span class="n">delete_strategy_ids</span><span class="p">:</span>
            <span class="n">memory_strategies</span><span class="p">[</span><span class="s2">&quot;deleteMemoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">{</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">:</span> <span class="n">strategy_id</span><span class="p">}</span> <span class="k">for</span> <span class="n">strategy_id</span> <span class="ow">in</span> <span class="n">delete_strategy_ids</span>
            <span class="p">]</span>

        <span class="k">if</span> <span class="n">memory_strategies</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;memoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory_strategies</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">update_memory</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updated memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">wait_for_active</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">memory</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to update memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_memory</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">wait_for_deletion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">wait_for_strategies</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># Changed default to False</span>
        <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
        <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete a memory resource.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID to delete</span>
<span class="sd">            wait_for_deletion: Whether to wait for complete deletion</span>
<span class="sd">            wait_for_strategies: Whether to wait for strategies to become ACTIVE before deletion</span>
<span class="sd">            max_wait: Maximum seconds to wait if wait_for_deletion is True</span>
<span class="sd">            poll_interval: Seconds between checks if wait_for_deletion is True</span>

<span class="sd">        Returns:</span>
<span class="sd">            Deletion response</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># If requested, wait for all strategies to become ACTIVE before deletion</span>
            <span class="k">if</span> <span class="n">wait_for_strategies</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>
                    <span class="n">strategies</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategies&quot;</span><span class="p">,</span> <span class="p">[])</span>

                    <span class="c1"># Check if any strategies are in a transitional state</span>
                    <span class="n">transitional_strategies</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">s</span>
                        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strategies</span>
                        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">MemoryStatus</span><span class="o">.</span><span class="n">ACTIVE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">MemoryStatus</span><span class="o">.</span><span class="n">FAILED</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
                    <span class="p">]</span>

                    <span class="k">if</span> <span class="n">transitional_strategies</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                            <span class="s2">&quot;Waiting for </span><span class="si">%d</span><span class="s2"> strategies to become ACTIVE before deletion&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">transitional_strategies</span><span class="p">)</span>
                        <span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_status</span><span class="p">(</span>
                            <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
                            <span class="n">target_status</span><span class="o">=</span><span class="n">MemoryStatus</span><span class="o">.</span><span class="n">ACTIVE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                            <span class="n">max_wait</span><span class="o">=</span><span class="n">max_wait</span><span class="p">,</span>
                            <span class="n">poll_interval</span><span class="o">=</span><span class="n">poll_interval</span><span class="p">,</span>
                            <span class="n">check_strategies</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Error waiting for strategies to become ACTIVE: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

            <span class="c1"># Now delete the memory</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">delete_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">clientToken</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()))</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Initiated deletion of memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">wait_for_deletion</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">response</span>

            <span class="c1"># Wait for deletion to complete</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">max_wait</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;Error&quot;</span><span class="p">][</span><span class="s2">&quot;Code&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ResourceNotFoundException&quot;</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> successfully deleted&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>
                        <span class="k">return</span> <span class="n">response</span>
                    <span class="k">raise</span>

            <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory </span><span class="si">{</span><span class="n">memory_id</span><span class="si">}</span><span class="s2"> was not deleted within </span><span class="si">{</span><span class="n">max_wait</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to delete memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="c1"># ==================== STRATEGY OPERATIONS ====================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_strategy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">strategy</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">wait_for_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
        <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a strategy to a memory resource.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            strategy: Strategy configuration dictionary</span>
<span class="sd">            wait_for_active: Whether to wait for strategy to become ACTIVE</span>
<span class="sd">            max_wait: Maximum seconds to wait if wait_for_active is True</span>
<span class="sd">            poll_interval: Seconds between status checks if wait_for_active is True</span>

<span class="sd">        Returns:</span>
<span class="sd">            Updated memory object with strategyId field</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the strategy type and name for identification</span>
        <span class="n">strategy_type</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">strategy</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># e.g., &#39;semanticMemoryStrategy&#39;</span>
        <span class="n">strategy_name</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="n">strategy_type</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Adding strategy </span><span class="si">%s</span><span class="s2"> of type </span><span class="si">%s</span><span class="s2"> to memory </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">strategy_name</span><span class="p">,</span> <span class="n">strategy_type</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

        <span class="c1"># Use update_memory with add_strategies parameter but don&#39;t wait for memory</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_memory</span><span class="p">(</span>
            <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
            <span class="n">add_strategies</span><span class="o">=</span><span class="p">[</span><span class="n">strategy</span><span class="p">],</span>
            <span class="n">wait_for_active</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Don&#39;t wait for memory, we&#39;ll check strategy specifically</span>
        <span class="p">)</span>

        <span class="c1"># If we need to wait for the strategy to become active</span>
        <span class="k">if</span> <span class="n">wait_for_active</span><span class="p">:</span>
            <span class="c1"># First, get the memory again to ensure we have the latest state</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>

            <span class="c1"># Find the newly added strategy by matching name</span>
            <span class="n">strategies</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategies&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">strategy_id</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
                <span class="c1"># Match by name since that&#39;s unique within a memory</span>
                <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">strategy_name</span><span class="p">:</span>
                    <span class="n">strategy_id</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategyId&quot;</span><span class="p">)</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Found newly added strategy </span><span class="si">%s</span><span class="s2"> with ID </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">strategy_name</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">)</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="n">strategy_id</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_strategy_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Could not identify newly added strategy </span><span class="si">%s</span><span class="s2"> to wait for activation&quot;</span><span class="p">,</span> <span class="n">strategy_name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">memory</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_strategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a specific strategy from a memory resource.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            strategy_id: Strategy ID</span>

<span class="sd">        Returns:</span>
<span class="sd">            Strategy details</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>
            <span class="n">strategies</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategies&quot;</span><span class="p">,</span> <span class="p">[])</span>

            <span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategyId&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">strategy_id</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">strategy</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Strategy </span><span class="si">{</span><span class="n">strategy_id</span><span class="si">}</span><span class="s2"> not found in memory </span><span class="si">{</span><span class="n">memory_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get strategy: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_strategy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">configuration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">wait_for_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
        <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update a strategy in a memory resource.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            strategy_id: Strategy ID to update</span>
<span class="sd">            description: Optional new description</span>
<span class="sd">            namespaces: Optional new namespaces list</span>
<span class="sd">            configuration: Optional new configuration</span>
<span class="sd">            wait_for_active: Whether to wait for strategy to become ACTIVE</span>
<span class="sd">            max_wait: Maximum seconds to wait if wait_for_active is True</span>
<span class="sd">            poll_interval: Seconds between status checks if wait_for_active is True</span>

<span class="sd">        Returns:</span>
<span class="sd">            Updated memory object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Note: API expects memoryStrategyId for input but returns strategyId in response</span>
        <span class="n">modify_config</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">:</span> <span class="n">strategy_id</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">modify_config</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

        <span class="k">if</span> <span class="n">namespaces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">modify_config</span><span class="p">[</span><span class="s2">&quot;namespaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">namespaces</span>

        <span class="k">if</span> <span class="n">configuration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">modify_config</span><span class="p">[</span><span class="s2">&quot;configuration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">configuration</span>

        <span class="c1"># Use update_memory with modify_strategies parameter but don&#39;t wait for memory</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_memory</span><span class="p">(</span>
            <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
            <span class="n">modify_strategies</span><span class="o">=</span><span class="p">[</span><span class="n">modify_config</span><span class="p">],</span>
            <span class="n">wait_for_active</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Don&#39;t wait for memory, we&#39;ll check strategy specifically</span>
        <span class="p">)</span>

        <span class="c1"># If we need to wait for the strategy to become active</span>
        <span class="k">if</span> <span class="n">wait_for_active</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_strategy_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">memory</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_strategy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">wait_for_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
        <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove a strategy from a memory resource.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: Memory resource ID</span>
<span class="sd">            strategy_id: Strategy ID to remove</span>
<span class="sd">            wait_for_active: Whether to wait for memory to become ACTIVE</span>
<span class="sd">            max_wait: Maximum seconds to wait if wait_for_active is True</span>
<span class="sd">            poll_interval: Seconds between status checks if wait_for_active is True</span>

<span class="sd">        Returns:</span>
<span class="sd">            Updated memory object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># For remove_strategy, we only need to wait for memory to be active</span>
        <span class="c1"># since the strategy will be gone</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_memory</span><span class="p">(</span>
            <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
            <span class="n">delete_strategy_ids</span><span class="o">=</span><span class="p">[</span><span class="n">strategy_id</span><span class="p">],</span>
            <span class="n">wait_for_active</span><span class="o">=</span><span class="n">wait_for_active</span><span class="p">,</span>
            <span class="n">max_wait</span><span class="o">=</span><span class="n">max_wait</span><span class="p">,</span>
            <span class="n">poll_interval</span><span class="o">=</span><span class="n">poll_interval</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># ==================== HELPER METHODS ====================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_wait_for_memory_active</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for memory to return to ACTIVE state.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Waiting for memory </span><span class="si">%s</span><span class="s2"> to become ACTIVE...&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_status</span><span class="p">(</span>
            <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">target_status</span><span class="o">=</span><span class="n">MemoryStatus</span><span class="o">.</span><span class="n">ACTIVE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="n">poll_interval</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_wait_for_strategy_active</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for specific memory strategy to become ACTIVE.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Waiting for strategy </span><span class="si">%s</span><span class="s2"> to become ACTIVE (max wait: </span><span class="si">%d</span><span class="s2"> seconds)...&quot;</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">)</span>

        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">last_status</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">max_wait</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>
                <span class="n">strategies</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategies&quot;</span><span class="p">,</span> <span class="p">[])</span>

                <span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategyId&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">strategy_id</span><span class="p">:</span>
                        <span class="n">status</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span>

                        <span class="c1"># Log status changes</span>
                        <span class="k">if</span> <span class="n">status</span> <span class="o">!=</span> <span class="n">last_status</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Strategy </span><span class="si">%s</span><span class="s2"> status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
                            <span class="n">last_status</span> <span class="o">=</span> <span class="n">status</span>

                        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">MemoryStatus</span><span class="o">.</span><span class="n">ACTIVE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                            <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Strategy </span><span class="si">%s</span><span class="s2"> is now ACTIVE (took </span><span class="si">%.1f</span><span class="s2"> seconds)&quot;</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">elapsed</span><span class="p">)</span>
                            <span class="k">return</span> <span class="n">memory</span>
                        <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="n">MemoryStatus</span><span class="o">.</span><span class="n">FAILED</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                            <span class="n">failure_reason</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;failureReason&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>
                            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Strategy </span><span class="si">{</span><span class="n">strategy_id</span><span class="si">}</span><span class="s2"> failed to activate: </span><span class="si">{</span><span class="n">failure_reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                        <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Strategy </span><span class="si">%s</span><span class="s2"> not found in memory </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

                <span class="c1"># Wait before checking again</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error checking strategy status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">raise</span>

        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Strategy </span><span class="si">{</span><span class="n">strategy_id</span><span class="si">}</span><span class="s2"> did not become ACTIVE within </span><span class="si">{</span><span class="n">max_wait</span><span class="si">}</span><span class="s2"> seconds (last status: </span><span class="si">{</span><span class="n">last_status</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_wait_for_status</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_status</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">check_strategies</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generic method to wait for a memory to reach a specific status.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: The ID of the memory to check</span>
<span class="sd">            target_status: The status to wait for (e.g., &quot;ACTIVE&quot;)</span>
<span class="sd">            max_wait: Maximum time to wait in seconds</span>
<span class="sd">            poll_interval: Time between status checks in seconds</span>
<span class="sd">            check_strategies: Whether to also check that all strategies are in the target status</span>

<span class="sd">        Returns:</span>
<span class="sd">            The memory object once it reaches the target status</span>

<span class="sd">        Raises:</span>
<span class="sd">            TimeoutError: If the memory doesn&#39;t reach the target status within max_wait</span>
<span class="sd">            RuntimeError: If the memory or any strategy reaches a FAILED state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Waiting for memory </span><span class="si">%s</span><span class="s2"> to reach status </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">,</span> <span class="n">target_status</span><span class="p">)</span>

        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">last_memory_status</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">strategy_statuses</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">max_wait</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>
                <span class="n">status</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span>

                <span class="c1"># Log status changes for memory</span>
                <span class="k">if</span> <span class="n">status</span> <span class="o">!=</span> <span class="n">last_memory_status</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
                    <span class="n">last_memory_status</span> <span class="o">=</span> <span class="n">status</span>

                <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">target_status</span><span class="p">:</span>
                    <span class="c1"># Check if all strategies are also in the target status</span>
                    <span class="k">if</span> <span class="n">check_strategies</span> <span class="ow">and</span> <span class="n">target_status</span> <span class="o">==</span> <span class="n">MemoryStatus</span><span class="o">.</span><span class="n">ACTIVE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                        <span class="n">strategies</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategies&quot;</span><span class="p">,</span> <span class="p">[])</span>
                        <span class="n">all_strategies_active</span> <span class="o">=</span> <span class="kc">True</span>

                        <span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
                            <span class="n">strategy_id</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategyId&quot;</span><span class="p">)</span>
                            <span class="n">strategy_status</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span>

                            <span class="c1"># Log strategy status changes</span>
                            <span class="k">if</span> <span class="p">(</span>
                                <span class="n">strategy_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">strategy_statuses</span>
                                <span class="ow">or</span> <span class="n">strategy_statuses</span><span class="p">[</span><span class="n">strategy_id</span><span class="p">]</span> <span class="o">!=</span> <span class="n">strategy_status</span>
                            <span class="p">):</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Strategy </span><span class="si">%s</span><span class="s2"> status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">strategy_status</span><span class="p">)</span>
                                <span class="n">strategy_statuses</span><span class="p">[</span><span class="n">strategy_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy_status</span>

                            <span class="k">if</span> <span class="n">strategy_status</span> <span class="o">!=</span> <span class="n">target_status</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">strategy_status</span> <span class="o">==</span> <span class="n">MemoryStatus</span><span class="o">.</span><span class="n">FAILED</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                                    <span class="n">failure_reason</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;failureReason&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>
                                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Strategy </span><span class="si">{</span><span class="n">strategy_id</span><span class="si">}</span><span class="s2"> failed: </span><span class="si">{</span><span class="n">failure_reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                                <span class="n">all_strategies_active</span> <span class="o">=</span> <span class="kc">False</span>

                        <span class="k">if</span> <span class="ow">not</span> <span class="n">all_strategies_active</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                                <span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> is </span><span class="si">%s</span><span class="s2"> but </span><span class="si">%d</span><span class="s2"> strategies are still processing&quot;</span><span class="p">,</span>
                                <span class="n">memory_id</span><span class="p">,</span>
                                <span class="n">target_status</span><span class="p">,</span>
                                <span class="nb">len</span><span class="p">([</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strategies</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">target_status</span><span class="p">]),</span>
                            <span class="p">)</span>
                            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>
                            <span class="k">continue</span>

                    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> and all strategies are now </span><span class="si">%s</span><span class="s2"> (took </span><span class="si">%.1f</span><span class="s2"> seconds)&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">,</span> <span class="n">target_status</span><span class="p">,</span> <span class="n">elapsed</span>
                    <span class="p">)</span>
                    <span class="k">return</span> <span class="n">memory</span>
                <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="n">MemoryStatus</span><span class="o">.</span><span class="n">FAILED</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                    <span class="n">failure_reason</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;failureReason&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory operation failed: </span><span class="si">{</span><span class="n">failure_reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error checking memory status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="k">raise</span>

        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Memory </span><span class="si">{</span><span class="n">memory_id</span><span class="si">}</span><span class="s2"> did not reach status </span><span class="si">{</span><span class="n">target_status</span><span class="si">}</span><span class="s2"> within </span><span class="si">{</span><span class="n">max_wait</span><span class="si">}</span><span class="s2"> seconds &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(elapsed: </span><span class="si">{</span><span class="n">elapsed</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">s)&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryControlPlaneClient.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">region_name</span><span class="o">=</span><span class="s1">&#39;us-west-2&#39;</span><span class="p">,</span> <span class="n">environment</span><span class="o">=</span><span class="s1">&#39;prod&#39;</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize the Memory Control Plane client.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>region_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>AWS region name</p>
              </div>
            </td>
            <td>
                  <code>&#39;us-west-2&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>environment</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Environment name (prod, gamma, etc.)</p>
              </div>
            </td>
            <td>
                  <code>&#39;prod&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/controlplane.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;us-west-2&quot;</span><span class="p">,</span> <span class="n">environment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;prod&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the Memory Control Plane client.</span>

<span class="sd">    Args:</span>
<span class="sd">        region_name: AWS region name</span>
<span class="sd">        environment: Environment name (prod, gamma, etc.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">region_name</span> <span class="o">=</span> <span class="n">region_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="o">=</span> <span class="n">environment</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
        <span class="s2">&quot;BEDROCK_AGENTCORE_CONTROL_ENDPOINT&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;https://bedrock-agentcore-control.</span><span class="si">{</span><span class="n">region_name</span><span class="si">}</span><span class="s2">.amazonaws.com&quot;</span>
    <span class="p">)</span>

    <span class="n">service_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;BEDROCK_AGENTCORE_CONTROL_SERVICE&quot;</span><span class="p">,</span> <span class="s2">&quot;bedrock-agentcore-control&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="n">service_name</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">region_name</span><span class="p">,</span> <span class="n">endpoint_url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Initialized MemoryControlPlaneClient for </span><span class="si">%s</span><span class="s2"> in </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">environment</span><span class="p">,</span> <span class="n">region_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryControlPlaneClient.add_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy</span><span class="p">,</span> <span class="n">wait_for_active</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.add_strategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add a strategy to a memory resource.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strategy</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Strategy configuration dictionary</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wait_for_active</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to wait for strategy to become ACTIVE</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_wait</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum seconds to wait if wait_for_active is True</p>
              </div>
            </td>
            <td>
                  <code>300</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>poll_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seconds between status checks if wait_for_active is True</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Updated memory object with strategyId field</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/controlplane.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_strategy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">strategy</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">wait_for_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a strategy to a memory resource.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        strategy: Strategy configuration dictionary</span>
<span class="sd">        wait_for_active: Whether to wait for strategy to become ACTIVE</span>
<span class="sd">        max_wait: Maximum seconds to wait if wait_for_active is True</span>
<span class="sd">        poll_interval: Seconds between status checks if wait_for_active is True</span>

<span class="sd">    Returns:</span>
<span class="sd">        Updated memory object with strategyId field</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the strategy type and name for identification</span>
    <span class="n">strategy_type</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">strategy</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># e.g., &#39;semanticMemoryStrategy&#39;</span>
    <span class="n">strategy_name</span> <span class="o">=</span> <span class="n">strategy</span><span class="p">[</span><span class="n">strategy_type</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Adding strategy </span><span class="si">%s</span><span class="s2"> of type </span><span class="si">%s</span><span class="s2"> to memory </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">strategy_name</span><span class="p">,</span> <span class="n">strategy_type</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

    <span class="c1"># Use update_memory with add_strategies parameter but don&#39;t wait for memory</span>
    <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_memory</span><span class="p">(</span>
        <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
        <span class="n">add_strategies</span><span class="o">=</span><span class="p">[</span><span class="n">strategy</span><span class="p">],</span>
        <span class="n">wait_for_active</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Don&#39;t wait for memory, we&#39;ll check strategy specifically</span>
    <span class="p">)</span>

    <span class="c1"># If we need to wait for the strategy to become active</span>
    <span class="k">if</span> <span class="n">wait_for_active</span><span class="p">:</span>
        <span class="c1"># First, get the memory again to ensure we have the latest state</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>

        <span class="c1"># Find the newly added strategy by matching name</span>
        <span class="n">strategies</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategies&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">strategy_id</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
            <span class="c1"># Match by name since that&#39;s unique within a memory</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">strategy_name</span><span class="p">:</span>
                <span class="n">strategy_id</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategyId&quot;</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Found newly added strategy </span><span class="si">%s</span><span class="s2"> with ID </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">strategy_name</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">)</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">strategy_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_strategy_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Could not identify newly added strategy </span><span class="si">%s</span><span class="s2"> to wait for activation&quot;</span><span class="p">,</span> <span class="n">strategy_name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">memory</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryControlPlaneClient.create_memory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_memory</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">event_expiry_days</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">memory_execution_role_arn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strategies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wait_for_active</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.create_memory" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create a memory resource with optional strategies.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name for the memory resource</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_expiry_days</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How long to retain events (default: 90 days)</p>
              </div>
            </td>
            <td>
                  <code>90</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional description</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>memory_execution_role_arn</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>IAM role ARN for memory execution</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strategies</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of strategy configurations</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wait_for_active</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to wait for memory to become ACTIVE</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_wait</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum seconds to wait if wait_for_active is True</p>
              </div>
            </td>
            <td>
                  <code>300</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>poll_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seconds between status checks if wait_for_active is True</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Created memory object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/controlplane.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_memory</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">event_expiry_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">memory_execution_role_arn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">wait_for_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a memory resource with optional strategies.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: Name for the memory resource</span>
<span class="sd">        event_expiry_days: How long to retain events (default: 90 days)</span>
<span class="sd">        description: Optional description</span>
<span class="sd">        memory_execution_role_arn: IAM role ARN for memory execution</span>
<span class="sd">        strategies: Optional list of strategy configurations</span>
<span class="sd">        wait_for_active: Whether to wait for memory to become ACTIVE</span>
<span class="sd">        max_wait: Maximum seconds to wait if wait_for_active is True</span>
<span class="sd">        poll_interval: Seconds between status checks if wait_for_active is True</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created memory object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;eventExpiryDuration&quot;</span><span class="p">:</span> <span class="n">event_expiry_days</span><span class="p">,</span>
        <span class="s2">&quot;clientToken&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

    <span class="k">if</span> <span class="n">memory_execution_role_arn</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;memoryExecutionRoleArn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory_execution_role_arn</span>

    <span class="k">if</span> <span class="n">strategies</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;memoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategies</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">create_memory</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span>
        <span class="n">memory_id</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">wait_for_active</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">memory</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to create memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryControlPlaneClient.delete_memory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">wait_for_deletion</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wait_for_strategies</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.delete_memory" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delete a memory resource.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID to delete</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wait_for_deletion</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to wait for complete deletion</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wait_for_strategies</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to wait for strategies to become ACTIVE before deletion</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_wait</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum seconds to wait if wait_for_deletion is True</p>
              </div>
            </td>
            <td>
                  <code>300</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>poll_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seconds between checks if wait_for_deletion is True</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Deletion response</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/controlplane.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_memory</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">wait_for_deletion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">wait_for_strategies</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># Changed default to False</span>
    <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete a memory resource.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID to delete</span>
<span class="sd">        wait_for_deletion: Whether to wait for complete deletion</span>
<span class="sd">        wait_for_strategies: Whether to wait for strategies to become ACTIVE before deletion</span>
<span class="sd">        max_wait: Maximum seconds to wait if wait_for_deletion is True</span>
<span class="sd">        poll_interval: Seconds between checks if wait_for_deletion is True</span>

<span class="sd">    Returns:</span>
<span class="sd">        Deletion response</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># If requested, wait for all strategies to become ACTIVE before deletion</span>
        <span class="k">if</span> <span class="n">wait_for_strategies</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>
                <span class="n">strategies</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategies&quot;</span><span class="p">,</span> <span class="p">[])</span>

                <span class="c1"># Check if any strategies are in a transitional state</span>
                <span class="n">transitional_strategies</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">s</span>
                    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strategies</span>
                    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">MemoryStatus</span><span class="o">.</span><span class="n">ACTIVE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">MemoryStatus</span><span class="o">.</span><span class="n">FAILED</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
                <span class="p">]</span>

                <span class="k">if</span> <span class="n">transitional_strategies</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="s2">&quot;Waiting for </span><span class="si">%d</span><span class="s2"> strategies to become ACTIVE before deletion&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">transitional_strategies</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_status</span><span class="p">(</span>
                        <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
                        <span class="n">target_status</span><span class="o">=</span><span class="n">MemoryStatus</span><span class="o">.</span><span class="n">ACTIVE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                        <span class="n">max_wait</span><span class="o">=</span><span class="n">max_wait</span><span class="p">,</span>
                        <span class="n">poll_interval</span><span class="o">=</span><span class="n">poll_interval</span><span class="p">,</span>
                        <span class="n">check_strategies</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Error waiting for strategies to become ACTIVE: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

        <span class="c1"># Now delete the memory</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">delete_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">clientToken</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()))</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Initiated deletion of memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">wait_for_deletion</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span>

        <span class="c1"># Wait for deletion to complete</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="n">max_wait</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;Error&quot;</span><span class="p">][</span><span class="s2">&quot;Code&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ResourceNotFoundException&quot;</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Memory </span><span class="si">%s</span><span class="s2"> successfully deleted&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">response</span>
                <span class="k">raise</span>

        <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory </span><span class="si">{</span><span class="n">memory_id</span><span class="si">}</span><span class="s2"> was not deleted within </span><span class="si">{</span><span class="n">max_wait</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to delete memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryControlPlaneClient.get_memory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">include_strategies</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.get_memory" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get a memory resource by ID.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_strategies</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include strategy details in response</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource details</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/controlplane.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">include_strategies</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a memory resource by ID.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        include_strategies: Whether to include strategy details in response</span>

<span class="sd">    Returns:</span>
<span class="sd">        Memory resource details</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="n">memory_id</span><span class="p">)</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span>

        <span class="c1"># Add strategy count</span>
        <span class="n">strategies</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategies&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;strategyCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">strategies</span><span class="p">)</span>

        <span class="c1"># Remove strategies if not requested</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">include_strategies</span> <span class="ow">and</span> <span class="s2">&quot;strategies&quot;</span> <span class="ow">in</span> <span class="n">memory</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;strategies&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">memory</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryControlPlaneClient.get_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.get_strategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get a specific strategy from a memory resource.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strategy_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Strategy ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Strategy details</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/controlplane.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_strategy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a specific strategy from a memory resource.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        strategy_id: Strategy ID</span>

<span class="sd">    Returns:</span>
<span class="sd">        Strategy details</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">)</span>
        <span class="n">strategies</span> <span class="o">=</span> <span class="n">memory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategies&quot;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">strategy</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;strategyId&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">strategy_id</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">strategy</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Strategy </span><span class="si">{</span><span class="n">strategy_id</span><span class="si">}</span><span class="s2"> not found in memory </span><span class="si">{</span><span class="n">memory_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get strategy: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryControlPlaneClient.list_memories" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_memories</span><span class="p">(</span><span class="n">max_results</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.list_memories" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>List all memories for the account with pagination support.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>max_results</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of memories to return</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of memory summaries</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/controlplane.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_memories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all memories for the account with pagination support.</span>

<span class="sd">    Args:</span>
<span class="sd">        max_results: Maximum number of memories to return</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of memory summaries</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">memories</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">next_token</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">memories</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_results</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_results</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">memories</span><span class="p">))}</span>
            <span class="k">if</span> <span class="n">next_token</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">list_memories</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memories&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">memories</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

            <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">next_token</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">memories</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">max_results</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="c1"># Add strategy count to each memory summary</span>
        <span class="k">for</span> <span class="n">memory</span> <span class="ow">in</span> <span class="n">memories</span><span class="p">:</span>
            <span class="n">memory</span><span class="p">[</span><span class="s2">&quot;strategyCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># List memories doesn&#39;t include strategies</span>

        <span class="k">return</span> <span class="n">memories</span><span class="p">[:</span><span class="n">max_results</span><span class="p">]</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list memories: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryControlPlaneClient.remove_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">wait_for_active</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.remove_strategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Remove a strategy from a memory resource.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strategy_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Strategy ID to remove</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wait_for_active</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to wait for memory to become ACTIVE</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_wait</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum seconds to wait if wait_for_active is True</p>
              </div>
            </td>
            <td>
                  <code>300</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>poll_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seconds between status checks if wait_for_active is True</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Updated memory object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/controlplane.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_strategy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">wait_for_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove a strategy from a memory resource.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        strategy_id: Strategy ID to remove</span>
<span class="sd">        wait_for_active: Whether to wait for memory to become ACTIVE</span>
<span class="sd">        max_wait: Maximum seconds to wait if wait_for_active is True</span>
<span class="sd">        poll_interval: Seconds between status checks if wait_for_active is True</span>

<span class="sd">    Returns:</span>
<span class="sd">        Updated memory object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># For remove_strategy, we only need to wait for memory to be active</span>
    <span class="c1"># since the strategy will be gone</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_memory</span><span class="p">(</span>
        <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
        <span class="n">delete_strategy_ids</span><span class="o">=</span><span class="p">[</span><span class="n">strategy_id</span><span class="p">],</span>
        <span class="n">wait_for_active</span><span class="o">=</span><span class="n">wait_for_active</span><span class="p">,</span>
        <span class="n">max_wait</span><span class="o">=</span><span class="n">max_wait</span><span class="p">,</span>
        <span class="n">poll_interval</span><span class="o">=</span><span class="n">poll_interval</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryControlPlaneClient.update_memory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_memory</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_expiry_days</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">memory_execution_role_arn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_strategies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_strategies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delete_strategy_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wait_for_active</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.update_memory" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Update a memory resource properties and/or strategies.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional new description</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_expiry_days</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional new event expiry duration</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>memory_execution_role_arn</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional new execution role ARN</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>add_strategies</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of strategies to add</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>modify_strategies</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of strategies to modify</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delete_strategy_ids</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of strategy IDs to delete</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wait_for_active</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to wait for memory to become ACTIVE</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_wait</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum seconds to wait if wait_for_active is True</p>
              </div>
            </td>
            <td>
                  <code>300</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>poll_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seconds between status checks if wait_for_active is True</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Updated memory object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/controlplane.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_memory</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">event_expiry_days</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">memory_execution_role_arn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">add_strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">modify_strategies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delete_strategy_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">wait_for_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update a memory resource properties and/or strategies.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        description: Optional new description</span>
<span class="sd">        event_expiry_days: Optional new event expiry duration</span>
<span class="sd">        memory_execution_role_arn: Optional new execution role ARN</span>
<span class="sd">        add_strategies: Optional list of strategies to add</span>
<span class="sd">        modify_strategies: Optional list of strategies to modify</span>
<span class="sd">        delete_strategy_ids: Optional list of strategy IDs to delete</span>
<span class="sd">        wait_for_active: Whether to wait for memory to become ACTIVE</span>
<span class="sd">        max_wait: Maximum seconds to wait if wait_for_active is True</span>
<span class="sd">        poll_interval: Seconds between status checks if wait_for_active is True</span>

<span class="sd">    Returns:</span>
<span class="sd">        Updated memory object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="n">memory_id</span><span class="p">,</span>
        <span class="s2">&quot;clientToken&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
    <span class="p">}</span>

    <span class="c1"># Add memory properties if provided</span>
    <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

    <span class="k">if</span> <span class="n">event_expiry_days</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;eventExpiryDuration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">event_expiry_days</span>

    <span class="k">if</span> <span class="n">memory_execution_role_arn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;memoryExecutionRoleArn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory_execution_role_arn</span>

    <span class="c1"># Add strategy operations if provided</span>
    <span class="n">memory_strategies</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">add_strategies</span><span class="p">:</span>
        <span class="n">memory_strategies</span><span class="p">[</span><span class="s2">&quot;addMemoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">add_strategies</span>

    <span class="k">if</span> <span class="n">modify_strategies</span><span class="p">:</span>
        <span class="n">memory_strategies</span><span class="p">[</span><span class="s2">&quot;modifyMemoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">modify_strategies</span>

    <span class="k">if</span> <span class="n">delete_strategy_ids</span><span class="p">:</span>
        <span class="n">memory_strategies</span><span class="p">[</span><span class="s2">&quot;deleteMemoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">:</span> <span class="n">strategy_id</span><span class="p">}</span> <span class="k">for</span> <span class="n">strategy_id</span> <span class="ow">in</span> <span class="n">delete_strategy_ids</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">memory_strategies</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;memoryStrategies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memory_strategies</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">update_memory</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updated memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">wait_for_active</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_memory_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">memory</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to update memory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemoryControlPlaneClient.update_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_strategy</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">configuration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wait_for_active</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_wait</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemoryControlPlaneClient.update_strategy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Update a strategy in a memory resource.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory resource ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strategy_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Strategy ID to update</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional new description</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespaces</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional new namespaces list</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>configuration</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional new configuration</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wait_for_active</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to wait for strategy to become ACTIVE</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_wait</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum seconds to wait if wait_for_active is True</p>
              </div>
            </td>
            <td>
                  <code>300</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>poll_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seconds between status checks if wait_for_active is True</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Updated memory object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/controlplane.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_strategy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">namespaces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">configuration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">wait_for_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_wait</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">poll_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update a strategy in a memory resource.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: Memory resource ID</span>
<span class="sd">        strategy_id: Strategy ID to update</span>
<span class="sd">        description: Optional new description</span>
<span class="sd">        namespaces: Optional new namespaces list</span>
<span class="sd">        configuration: Optional new configuration</span>
<span class="sd">        wait_for_active: Whether to wait for strategy to become ACTIVE</span>
<span class="sd">        max_wait: Maximum seconds to wait if wait_for_active is True</span>
<span class="sd">        poll_interval: Seconds between status checks if wait_for_active is True</span>

<span class="sd">    Returns:</span>
<span class="sd">        Updated memory object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Note: API expects memoryStrategyId for input but returns strategyId in response</span>
    <span class="n">modify_config</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">:</span> <span class="n">strategy_id</span><span class="p">}</span>

    <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">modify_config</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

    <span class="k">if</span> <span class="n">namespaces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">modify_config</span><span class="p">[</span><span class="s2">&quot;namespaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">namespaces</span>

    <span class="k">if</span> <span class="n">configuration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">modify_config</span><span class="p">[</span><span class="s2">&quot;configuration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">configuration</span>

    <span class="c1"># Use update_memory with modify_strategies parameter but don&#39;t wait for memory</span>
    <span class="n">memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_memory</span><span class="p">(</span>
        <span class="n">memory_id</span><span class="o">=</span><span class="n">memory_id</span><span class="p">,</span>
        <span class="n">modify_strategies</span><span class="o">=</span><span class="p">[</span><span class="n">modify_config</span><span class="p">],</span>
        <span class="n">wait_for_active</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Don&#39;t wait for memory, we&#39;ll check strategy specifically</span>
    <span class="p">)</span>

    <span class="c1"># If we need to wait for the strategy to become active</span>
    <span class="k">if</span> <span class="n">wait_for_active</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_strategy_active</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">max_wait</span><span class="p">,</span> <span class="n">poll_interval</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">memory</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="bedrock_agentcore.memory.MemorySession" class="doc doc-heading">
            <code>MemorySession</code>


<a href="#bedrock_agentcore.memory.MemorySession" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="bedrock_agentcore.memory.models.DictWrapper">DictWrapper</span></code></p>


        <p>Represents a single, AgentCore MemorySession resource.</p>
<p>This class provides convenient delegation to MemorySessionManager operations.</p>








              <details class="quote">
                <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MemorySession</span><span class="p">(</span><span class="n">DictWrapper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a single, AgentCore MemorySession resource.</span>

<span class="sd">    This class provides convenient delegation to MemorySessionManager operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">manager</span><span class="p">:</span> <span class="n">MemorySessionManager</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a MemorySession instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: The memory identifier for this session.</span>
<span class="sd">            actor_id: The actor identifier for this session.</span>
<span class="sd">            session_id: The session identifier.</span>
<span class="sd">            manager: The MemorySessionManager instance to delegate operations to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span> <span class="o">=</span> <span class="n">memory_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span> <span class="o">=</span> <span class="n">actor_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span> <span class="o">=</span> <span class="n">session_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span> <span class="o">=</span> <span class="n">manager</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_construct_session_dict</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_construct_session_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructs a dictionary representing the session.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_turns</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ConversationalMessage</span><span class="p">,</span> <span class="n">BlobMessage</span><span class="p">]],</span>
        <span class="n">branch</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Event</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.add_turns.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">add_turns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span> <span class="n">messages</span><span class="p">,</span> <span class="n">branch</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fork_conversation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ConversationalMessage</span><span class="p">,</span> <span class="n">BlobMessage</span><span class="p">]],</span>
        <span class="n">root_event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">branch_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Event</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.fork_conversation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">fork_conversation</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span> <span class="n">root_event_id</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">,</span> <span class="n">messages</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">event_timestamp</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_turn_with_llm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">llm_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">retrieval_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RetrievalConfig</span><span class="p">]],</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.process_turn_with_llm.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">process_turn_with_llm</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span>
            <span class="n">user_input</span><span class="p">,</span>
            <span class="n">llm_callback</span><span class="p">,</span>
            <span class="n">retrieval_config</span><span class="p">,</span>
            <span class="n">metadata</span><span class="p">,</span>
            <span class="n">event_timestamp</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_turn_with_llm_async</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">llm_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="n">Awaitable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">retrieval_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RetrievalConfig</span><span class="p">]],</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.process_turn_with_llm_async.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">process_turn_with_llm_async</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span>
            <span class="n">user_input</span><span class="p">,</span>
            <span class="n">llm_callback</span><span class="p">,</span>
            <span class="n">retrieval_config</span><span class="p">,</span>
            <span class="n">metadata</span><span class="p">,</span>
            <span class="n">event_timestamp</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_last_k_turns</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_parent_branches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">EventMessage</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.get_last_k_turns.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">get_last_k_turns</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">,</span> <span class="n">include_parent_branches</span><span class="p">,</span> <span class="n">max_results</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Event</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.get_event.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">get_event</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.delete_event.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">delete_event</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_memory_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MemoryRecord</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.get_memory_record.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">get_memory_record</span><span class="p">(</span><span class="n">record_id</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_memory_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.delete_memory_record.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">delete_memory_record</span><span class="p">(</span><span class="n">record_id</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">search_long_term_memories</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">strategy_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MemoryRecord</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.search_long_term_memories.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">search_long_term_memories</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">namespace_prefix</span><span class="p">,</span> <span class="n">top_k</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">max_results</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_long_term_memory_records</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">namespace_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MemoryRecord</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.list_long_term_memory_records.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">list_long_term_memory_records</span><span class="p">(</span><span class="n">namespace_prefix</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">max_results</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ActorSummary</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.list_actors.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">list_actors</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_events</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_parent_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">eventMetadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">EventMetadataFilter</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">include_payload</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.list_events.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span>
            <span class="n">actor_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span>
            <span class="n">session_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span>
            <span class="n">branch_name</span><span class="o">=</span><span class="n">branch_name</span><span class="p">,</span>
            <span class="n">include_parent_branches</span><span class="o">=</span><span class="n">include_parent_branches</span><span class="p">,</span>
            <span class="n">eventMetadata</span><span class="o">=</span><span class="n">eventMetadata</span><span class="p">,</span>
            <span class="n">include_payload</span><span class="o">=</span><span class="n">include_payload</span><span class="p">,</span>
            <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_branches</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Branch</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegates to manager.list_branches.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">list_branches</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_actor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Actor&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns an Actor instance for this conversation&#39;s actor.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Actor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">manager</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize a MemorySession instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The memory identifier for this session.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actor_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The actor identifier for this session.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The session identifier.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>manager</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MemorySessionManager (bedrock_agentcore.memory.session.MemorySessionManager)" href="#bedrock_agentcore.memory.MemorySessionManager">MemorySessionManager</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MemorySessionManager instance to delegate operations to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">manager</span><span class="p">:</span> <span class="n">MemorySessionManager</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a MemorySession instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: The memory identifier for this session.</span>
<span class="sd">        actor_id: The actor identifier for this session.</span>
<span class="sd">        session_id: The session identifier.</span>
<span class="sd">        manager: The MemorySessionManager instance to delegate operations to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span> <span class="o">=</span> <span class="n">memory_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span> <span class="o">=</span> <span class="n">actor_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span> <span class="o">=</span> <span class="n">session_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span> <span class="o">=</span> <span class="n">manager</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_construct_session_dict</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.add_turns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_turns</span><span class="p">(</span><span class="n">messages</span><span class="p">,</span> <span class="n">branch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.add_turns" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.add_turns.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_turns</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ConversationalMessage</span><span class="p">,</span> <span class="n">BlobMessage</span><span class="p">]],</span>
    <span class="n">branch</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Event</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.add_turns.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">add_turns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span> <span class="n">messages</span><span class="p">,</span> <span class="n">branch</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.delete_event" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_event</span><span class="p">(</span><span class="n">event_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.delete_event" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.delete_event.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.delete_event.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">delete_event</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.delete_memory_record" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_memory_record</span><span class="p">(</span><span class="n">record_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.delete_memory_record" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.delete_memory_record.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_memory_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.delete_memory_record.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">delete_memory_record</span><span class="p">(</span><span class="n">record_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.fork_conversation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fork_conversation</span><span class="p">(</span><span class="n">messages</span><span class="p">,</span> <span class="n">root_event_id</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.fork_conversation" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.fork_conversation.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fork_conversation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ConversationalMessage</span><span class="p">,</span> <span class="n">BlobMessage</span><span class="p">]],</span>
    <span class="n">root_event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">branch_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Event</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.fork_conversation.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">fork_conversation</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span> <span class="n">root_event_id</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">,</span> <span class="n">messages</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">event_timestamp</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.get_actor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_actor</span><span class="p">()</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.get_actor" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Returns an Actor instance for this conversation's actor.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_actor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Actor&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns an Actor instance for this conversation&#39;s actor.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Actor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.get_event" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_event</span><span class="p">(</span><span class="n">event_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.get_event" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.get_event.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Event</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.get_event.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">get_event</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.get_last_k_turns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_last_k_turns</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">branch_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_parent_branches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.get_last_k_turns" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.get_last_k_turns.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_last_k_turns</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_parent_branches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">EventMessage</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.get_last_k_turns.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">get_last_k_turns</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">,</span> <span class="n">include_parent_branches</span><span class="p">,</span> <span class="n">max_results</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.get_memory_record" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_memory_record</span><span class="p">(</span><span class="n">record_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.get_memory_record" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.get_memory_record.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_memory_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MemoryRecord</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.get_memory_record.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">get_memory_record</span><span class="p">(</span><span class="n">record_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.list_actors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_actors</span><span class="p">()</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.list_actors" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.list_actors.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ActorSummary</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.list_actors.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">list_actors</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.list_branches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_branches</span><span class="p">()</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.list_branches" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.list_branches.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_branches</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Branch</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.list_branches.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">list_branches</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.list_events" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_events</span><span class="p">(</span><span class="n">branch_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_parent_branches</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eventMetadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">include_payload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.list_events" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.list_events.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_events</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_parent_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">eventMetadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">EventMetadataFilter</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">include_payload</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.list_events.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span>
        <span class="n">actor_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span>
        <span class="n">session_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span>
        <span class="n">branch_name</span><span class="o">=</span><span class="n">branch_name</span><span class="p">,</span>
        <span class="n">include_parent_branches</span><span class="o">=</span><span class="n">include_parent_branches</span><span class="p">,</span>
        <span class="n">eventMetadata</span><span class="o">=</span><span class="n">eventMetadata</span><span class="p">,</span>
        <span class="n">include_payload</span><span class="o">=</span><span class="n">include_payload</span><span class="p">,</span>
        <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.list_long_term_memory_records" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_long_term_memory_records</span><span class="p">(</span><span class="n">namespace_prefix</span><span class="p">,</span> <span class="n">strategy_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.list_long_term_memory_records" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.list_long_term_memory_records.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_long_term_memory_records</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">namespace_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MemoryRecord</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.list_long_term_memory_records.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">list_long_term_memory_records</span><span class="p">(</span><span class="n">namespace_prefix</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">max_results</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.process_turn_with_llm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_turn_with_llm</span><span class="p">(</span><span class="n">user_input</span><span class="p">,</span> <span class="n">llm_callback</span><span class="p">,</span> <span class="n">retrieval_config</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.process_turn_with_llm" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.process_turn_with_llm.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_turn_with_llm</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">llm_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">retrieval_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RetrievalConfig</span><span class="p">]],</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.process_turn_with_llm.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">process_turn_with_llm</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span>
        <span class="n">user_input</span><span class="p">,</span>
        <span class="n">llm_callback</span><span class="p">,</span>
        <span class="n">retrieval_config</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.process_turn_with_llm_async" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_turn_with_llm_async</span><span class="p">(</span><span class="n">user_input</span><span class="p">,</span> <span class="n">llm_callback</span><span class="p">,</span> <span class="n">retrieval_config</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#bedrock_agentcore.memory.MemorySession.process_turn_with_llm_async" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.process_turn_with_llm_async.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_turn_with_llm_async</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">llm_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="n">Awaitable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">retrieval_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RetrievalConfig</span><span class="p">]],</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.process_turn_with_llm_async.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">process_turn_with_llm_async</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actor_id</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span>
        <span class="n">user_input</span><span class="p">,</span>
        <span class="n">llm_callback</span><span class="p">,</span>
        <span class="n">retrieval_config</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySession.search_long_term_memories" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">search_long_term_memories</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">namespace_prefix</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">strategy_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySession.search_long_term_memories" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delegates to manager.search_long_term_memories.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">search_long_term_memories</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">namespace_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">strategy_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MemoryRecord</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegates to manager.search_long_term_memories.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manager</span><span class="o">.</span><span class="n">search_long_term_memories</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">namespace_prefix</span><span class="p">,</span> <span class="n">top_k</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">,</span> <span class="n">max_results</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="bedrock_agentcore.memory.MemorySessionManager" class="doc doc-heading">
            <code>MemorySessionManager</code>


<a href="#bedrock_agentcore.memory.MemorySessionManager" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">


        <p>Manages conversational sessions and memory operations for AWS Bedrock AgentCore.</p>
<p>The MemorySessionManager provides a high-level interface for managing conversational AI sessions,
handling both short-term (conversational events) and long-term (semantic memory) storage.
It serves as the primary entry point for data plane operations with AWS Bedrock AgentCore
Memory services.</p>


<details class="key-capabilities" open>
  <summary>Key Capabilities</summary>
  <ul>
<li><strong>Conversation Management</strong>: Store, retrieve, and organize conversational turns</li>
<li><strong>Memory Operations</strong>: Search and manage long-term semantic memory records</li>
<li><strong>Branch Support</strong>: Create and manage conversation branches for alternative flows</li>
<li><strong>LLM Integration</strong>: Built-in callback pattern for LLM processing with memory context</li>
<li><strong>Actor &amp; Session Tracking</strong>: Multi-user, multi-session conversation management</li>
</ul>
</details>

<details class="usage-patterns" open>
  <summary>Usage Patterns</summary>
  <ol>
<li><strong>Simple Conversation</strong>: Store user/assistant message pairs</li>
<li><strong>Memory-Enhanced Chat</strong>: Retrieve relevant context before LLM processing</li>
<li><strong>Branched Conversations</strong>: Fork conversations for alternative responses</li>
<li><strong>Multi-Modal</strong>: Handle both text and binary data (images, files, etc.)</li>
</ol>
</details>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="c1"># Initialize manager</span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">MemorySessionManager</span><span class="p">(</span><span class="n">memory_id</span><span class="o">=</span><span class="s2">&quot;my-memory-123&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s2">&quot;us-east-1&quot;</span><span class="p">)</span>

<span class="c1"># Store a conversation turn</span>
<span class="n">manager</span><span class="o">.</span><span class="n">add_turns</span><span class="p">(</span>
    <span class="n">actor_id</span><span class="o">=</span><span class="s2">&quot;user-456&quot;</span><span class="p">,</span>
    <span class="n">session_id</span><span class="o">=</span><span class="s2">&quot;session-789&quot;</span><span class="p">,</span>
    <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
        <span class="n">ConversationalMessage</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">,</span> <span class="n">MessageRole</span><span class="o">.</span><span class="n">USER</span><span class="p">),</span>
        <span class="n">ConversationalMessage</span><span class="p">(</span><span class="s2">&quot;Hi there!&quot;</span><span class="p">,</span> <span class="n">MessageRole</span><span class="o">.</span><span class="n">ASSISTANT</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Search long-term memory and process with LLM</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_llm</span><span class="p">(</span><span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">memories</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="c1"># Your LLM processing logic here</span>
    <span class="k">return</span> <span class="s2">&quot;Response based on context&quot;</span>

<span class="n">memories</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">event</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">process_turn_with_llm</span><span class="p">(</span>
    <span class="n">actor_id</span><span class="o">=</span><span class="s2">&quot;user-456&quot;</span><span class="p">,</span>
    <span class="n">session_id</span><span class="o">=</span><span class="s2">&quot;session-789&quot;</span><span class="p">,</span>
    <span class="n">user_input</span><span class="o">=</span><span class="s2">&quot;What did we discuss?&quot;</span><span class="p">,</span>
    <span class="n">llm_callback</span><span class="o">=</span><span class="n">my_llm</span><span class="p">,</span>
    <span class="n">retrieval_namespace</span><span class="o">=</span><span class="s2">&quot;support/facts/</span><span class="si">{sessionId}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</code></pre></div>
</details>

<details class="thread-safety" open>
  <summary>Thread Safety</summary>
  <p>This class is not thread-safe. Create separate instances for concurrent operations.</p>
</details>

<details class="aws-permissions-required" open>
  <summary>AWS Permissions Required</summary>
  <ul>
<li>bedrock-agentcore:CreateEvent</li>
<li>bedrock-agentcore:GetEvent</li>
<li>bedrock-agentcore:ListEvents</li>
<li>bedrock-agentcore:DeleteEvent</li>
<li>bedrock-agentcore:RetrieveMemoryRecords</li>
<li>bedrock-agentcore:ListMemoryRecords</li>
<li>bedrock-agentcore:GetMemoryRecord</li>
<li>bedrock-agentcore:DeleteMemoryRecord</li>
<li>bedrock-agentcore:ListActors</li>
<li>bedrock-agentcore:ListSessions</li>
</ul>
</details>







              <details class="quote">
                <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  28</span>
<span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MemorySessionManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages conversational sessions and memory operations for AWS Bedrock AgentCore.</span>

<span class="sd">    The MemorySessionManager provides a high-level interface for managing conversational AI sessions,</span>
<span class="sd">    handling both short-term (conversational events) and long-term (semantic memory) storage.</span>
<span class="sd">    It serves as the primary entry point for data plane operations with AWS Bedrock AgentCore</span>
<span class="sd">    Memory services.</span>

<span class="sd">    Key Capabilities:</span>
<span class="sd">        - **Conversation Management**: Store, retrieve, and organize conversational turns</span>
<span class="sd">        - **Memory Operations**: Search and manage long-term semantic memory records</span>
<span class="sd">        - **Branch Support**: Create and manage conversation branches for alternative flows</span>
<span class="sd">        - **LLM Integration**: Built-in callback pattern for LLM processing with memory context</span>
<span class="sd">        - **Actor &amp; Session Tracking**: Multi-user, multi-session conversation management</span>

<span class="sd">    Usage Patterns:</span>
<span class="sd">        1. **Simple Conversation**: Store user/assistant message pairs</span>
<span class="sd">        2. **Memory-Enhanced Chat**: Retrieve relevant context before LLM processing</span>
<span class="sd">        3. **Branched Conversations**: Fork conversations for alternative responses</span>
<span class="sd">        4. **Multi-Modal**: Handle both text and binary data (images, files, etc.)</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        # Initialize manager</span>
<span class="sd">        manager = MemorySessionManager(memory_id=&quot;my-memory-123&quot;, region_name=&quot;us-east-1&quot;)</span>

<span class="sd">        # Store a conversation turn</span>
<span class="sd">        manager.add_turns(</span>
<span class="sd">            actor_id=&quot;user-456&quot;,</span>
<span class="sd">            session_id=&quot;session-789&quot;,</span>
<span class="sd">            messages=[</span>
<span class="sd">                ConversationalMessage(&quot;Hello!&quot;, MessageRole.USER),</span>
<span class="sd">                ConversationalMessage(&quot;Hi there!&quot;, MessageRole.ASSISTANT)</span>
<span class="sd">            ]</span>
<span class="sd">        )</span>

<span class="sd">        # Search long-term memory and process with LLM</span>
<span class="sd">        def my_llm(user_input: str, memories: List[Dict]) -&gt; str:</span>
<span class="sd">            # Your LLM processing logic here</span>
<span class="sd">            return &quot;Response based on context&quot;</span>

<span class="sd">        memories, response, event = manager.process_turn_with_llm(</span>
<span class="sd">            actor_id=&quot;user-456&quot;,</span>
<span class="sd">            session_id=&quot;session-789&quot;,</span>
<span class="sd">            user_input=&quot;What did we discuss?&quot;,</span>
<span class="sd">            llm_callback=my_llm,</span>
<span class="sd">            retrieval_namespace=&quot;support/facts/{sessionId}&quot;</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>

<span class="sd">    Thread Safety:</span>
<span class="sd">        This class is not thread-safe. Create separate instances for concurrent operations.</span>

<span class="sd">    AWS Permissions Required:</span>
<span class="sd">        - bedrock-agentcore:CreateEvent</span>
<span class="sd">        - bedrock-agentcore:GetEvent</span>
<span class="sd">        - bedrock-agentcore:ListEvents</span>
<span class="sd">        - bedrock-agentcore:DeleteEvent</span>
<span class="sd">        - bedrock-agentcore:RetrieveMemoryRecords</span>
<span class="sd">        - bedrock-agentcore:ListMemoryRecords</span>
<span class="sd">        - bedrock-agentcore:GetMemoryRecord</span>
<span class="sd">        - bedrock-agentcore:DeleteMemoryRecord</span>
<span class="sd">        - bedrock-agentcore:ListActors</span>
<span class="sd">        - bedrock-agentcore:ListSessions</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">region_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">boto3_session</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">boto_client_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BotocoreConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a MemorySessionManager instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            memory_id: The memory identifier for this session manager.</span>
<span class="sd">            region_name: AWS region for the bedrock-agentcore client. If not provided,</span>
<span class="sd">                   will use the region from boto3_session or default session.</span>
<span class="sd">            boto3_session: Optional boto3 Session to use. If provided and region_name</span>
<span class="sd">                          parameter is also specified, validation will ensure they match.</span>
<span class="sd">            boto_client_config: Optional boto3 client configuration. If provided, will be</span>
<span class="sd">                              merged with default configuration including user agent.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If region_name parameter conflicts with boto3_session region.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize core attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span> <span class="o">=</span> <span class="n">memory_id</span>

        <span class="c1"># Setup session and validate region consistency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_resolve_region</span><span class="p">(</span><span class="n">region_name</span><span class="p">,</span> <span class="n">boto3_session</span><span class="p">)</span>
        <span class="n">session</span> <span class="o">=</span> <span class="n">boto3_session</span> <span class="k">if</span> <span class="n">boto3_session</span> <span class="k">else</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

        <span class="c1"># Configure and create boto3 client</span>
        <span class="n">client_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_client_config</span><span class="p">(</span><span class="n">boto_client_config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">client</span><span class="p">(</span>
            <span class="s2">&quot;bedrock-agentcore&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">region_name</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">client_config</span>
        <span class="p">)</span>

        <span class="c1"># Configure timestamp serialization to use float representation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_configure_timestamp_serialization</span><span class="p">()</span>

        <span class="c1"># Define allowed data plane methods</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ALLOWED_DATA_PLANE_METHODS</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;retrieve_memory_records&quot;</span><span class="p">,</span>
            <span class="s2">&quot;get_memory_record&quot;</span><span class="p">,</span>
            <span class="s2">&quot;delete_memory_record&quot;</span><span class="p">,</span>
            <span class="s2">&quot;list_memory_records&quot;</span><span class="p">,</span>
            <span class="s2">&quot;create_event&quot;</span><span class="p">,</span>
            <span class="s2">&quot;get_event&quot;</span><span class="p">,</span>
            <span class="s2">&quot;delete_event&quot;</span><span class="p">,</span>
            <span class="s2">&quot;list_events&quot;</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_and_resolve_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">session</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate region consistency and resolve the final region to use.</span>

<span class="sd">        Args:</span>
<span class="sd">            region_name: Explicitly provided region name</span>
<span class="sd">            session: Optional Boto3 session instance</span>

<span class="sd">        Returns:</span>
<span class="sd">            The resolved region name to use</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If region_name conflicts with session region</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">session_region</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">region_name</span> <span class="k">if</span> <span class="n">session</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># Validate region consistency if both are provided</span>
        <span class="k">if</span> <span class="n">region_name</span> <span class="ow">and</span> <span class="n">session</span> <span class="ow">and</span> <span class="n">session_region</span> <span class="ow">and</span> <span class="p">(</span><span class="n">region_name</span> <span class="o">!=</span> <span class="n">session_region</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Region mismatch: provided region_name &#39;</span><span class="si">{</span><span class="n">region_name</span><span class="si">}</span><span class="s2">&#39; does not match &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;boto3_session region &#39;</span><span class="si">{</span><span class="n">session_region</span><span class="si">}</span><span class="s2">&#39;. Please ensure both &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;parameters specify the same region or omit the region_name parameter &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;to use the session&#39;s region.&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">region_name</span> <span class="ow">or</span> <span class="n">session_region</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_build_client_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boto_client_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BotocoreConfig</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">BotocoreConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Build the final boto3 client configuration with SDK user agent.</span>

<span class="sd">        Args:</span>
<span class="sd">            boto_client_config: Optional user-provided client configuration</span>

<span class="sd">        Returns:</span>
<span class="sd">            Final client configuration with SDK user agent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sdk_user_agent</span> <span class="o">=</span> <span class="s2">&quot;bedrock-agentcore-sdk&quot;</span>

        <span class="k">if</span> <span class="n">boto_client_config</span><span class="p">:</span>
            <span class="n">existing_user_agent</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">boto_client_config</span><span class="p">,</span> <span class="s2">&quot;user_agent_extra&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">existing_user_agent</span><span class="p">:</span>
                <span class="n">new_user_agent</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">existing_user_agent</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">sdk_user_agent</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_user_agent</span> <span class="o">=</span> <span class="n">sdk_user_agent</span>
            <span class="k">return</span> <span class="n">boto_client_config</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">BotocoreConfig</span><span class="p">(</span><span class="n">user_agent_extra</span><span class="o">=</span><span class="n">new_user_agent</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BotocoreConfig</span><span class="p">(</span><span class="n">user_agent_extra</span><span class="o">=</span><span class="n">sdk_user_agent</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_configure_timestamp_serialization</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Configure the boto3 client to serialize timestamps as float values.</span>

<span class="sd">        This method overrides the default timestamp serialization to convert datetime objects</span>
<span class="sd">        to float timestamps (seconds since Unix epoch) which preserves millisecond precision</span>
<span class="sd">        when sending datetime objects to the AgentCore Memory service.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">original_serialize_timestamp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">_serializer</span><span class="o">.</span><span class="n">_serializer</span><span class="o">.</span><span class="n">_serialize_type_timestamp</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">serialize_timestamp_as_float</span><span class="p">(</span><span class="n">serialized</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
                <span class="n">serialized</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span>  <span class="c1"># Convert to float (seconds since epoch with fractional seconds)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">original_serialize_timestamp</span><span class="p">(</span><span class="n">serialized</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">_serializer</span><span class="o">.</span><span class="n">_serializer</span><span class="o">.</span><span class="n">_serialize_type_timestamp</span> <span class="o">=</span> <span class="n">serialize_timestamp_as_float</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Dynamically forward method calls to the appropriate boto3 client.</span>

<span class="sd">        This method enables access to all data_plane boto3 client methods without explicitly</span>
<span class="sd">        defining them. Methods are looked up in the following order:</span>
<span class="sd">        _data_plane_client (bedrock-agentcore) - for data plane operations</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The method name being accessed</span>

<span class="sd">        Returns:</span>
<span class="sd">            A callable method from the boto3 client</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: If the method doesn&#39;t exist on _data_plane_client</span>

<span class="sd">        Example:</span>
<span class="sd">            # Access any boto3 method directly</span>
<span class="sd">            manager = MemorySessionManager(region_name=&quot;us-east-1&quot;)</span>

<span class="sd">            # These calls are forwarded to the appropriate boto3 functions</span>
<span class="sd">            memory_records = manager.retrieve_memory_records()</span>
<span class="sd">            events = manager.list_events(...)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ALLOWED_DATA_PLANE_METHODS</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Forwarding method &#39;</span><span class="si">%s</span><span class="s2">&#39; to _data_plane_client&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">method</span>

        <span class="c1"># Method not found on client</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Method not found on _data_plane_client. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Available methods can be found in the boto3 documentation for &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;bedrock-agentcore&#39; services.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_turn_with_llm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">llm_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">retrieval_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RetrievalConfig</span><span class="p">]],</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Complete conversation turn with LLM callback integration.</span>

<span class="sd">        This method combines memory retrieval, LLM invocation, and response storage</span>
<span class="sd">        in a single call using a callback pattern.</span>

<span class="sd">        Args:</span>
<span class="sd">            actor_id: Actor identifier (e.g., &quot;user-123&quot;)</span>
<span class="sd">            session_id: Session identifier</span>
<span class="sd">            user_input: The user&#39;s message</span>
<span class="sd">            llm_callback: Function that takes (user_input, memories) and returns agent_response</span>
<span class="sd">                         The callback receives the user input and retrieved memories,</span>
<span class="sd">                         and should return the agent&#39;s response string</span>
<span class="sd">            retrieval_config: Optional dictionary mapping namespaces to RetrievalConfig objects.</span>
<span class="sd">                            Each namespace can contain template variables like {actorId}, {sessionId},</span>
<span class="sd">                            {memoryStrategyId} that will be resolved at runtime.</span>
<span class="sd">            metadata: Optional custom key-value metadata to attach to an event.</span>
<span class="sd">            event_timestamp: Optional timestamp for the event</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple of (retrieved_memories, agent_response, created_event)</span>

<span class="sd">        Example:</span>
<span class="sd">            from bedrock_agentcore.memory.constants import RetrievalConfig</span>

<span class="sd">            def my_llm(user_input: str, memories: List[Dict]) -&gt; str:</span>
<span class="sd">                # Format context from memories</span>
<span class="sd">                context = &quot;\\n&quot;.join([m.get(&#39;content&#39;, {}).get(&#39;text&#39;, &#39;&#39;) for m in memories])</span>

<span class="sd">                # Call your LLM (Bedrock, OpenAI, etc.)</span>
<span class="sd">                response = bedrock.invoke_model(</span>
<span class="sd">                    messages=[</span>
<span class="sd">                        {&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: f&quot;Context: {context}&quot;},</span>
<span class="sd">                        {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: user_input}</span>
<span class="sd">                    ]</span>
<span class="sd">                )</span>
<span class="sd">                return response[&#39;content&#39;]</span>

<span class="sd">            retrieval_config = {</span>
<span class="sd">                &quot;support/facts/{sessionId}&quot;: RetrievalConfig(top_k=5, relevance_score=0.3),</span>
<span class="sd">                &quot;user/preferences/{actorId}&quot;: RetrievalConfig(top_k=3, relevance_score=0.5)</span>
<span class="sd">            }</span>

<span class="sd">            memories, response, event = manager.process_turn_with_llm(</span>
<span class="sd">                actor_id=&quot;user-123&quot;,</span>
<span class="sd">                session_id=&quot;session-456&quot;,</span>
<span class="sd">                user_input=&quot;What did we discuss yesterday?&quot;,</span>
<span class="sd">                llm_callback=my_llm,</span>
<span class="sd">                retrieval_config=retrieval_config</span>
<span class="sd">            )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Step 1: Retrieve relevant memories</span>
        <span class="n">retrieved_memories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_retrieve_memories_for_llm</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">user_input</span><span class="p">,</span> <span class="n">retrieval_config</span><span class="p">)</span>

        <span class="c1"># Step 2: Invoke LLM callback</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">agent_response</span> <span class="o">=</span> <span class="n">llm_callback</span><span class="p">(</span><span class="n">user_input</span><span class="p">,</span> <span class="n">retrieved_memories</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agent_response</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;LLM callback must return a string response&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;LLM callback generated response&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;LLM callback failed: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

        <span class="c1"># Step 3: Save the conversation turn</span>
        <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_conversation_turn</span><span class="p">(</span>
            <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">user_input</span><span class="p">,</span> <span class="n">agent_response</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">event_timestamp</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">retrieved_memories</span><span class="p">,</span> <span class="n">agent_response</span><span class="p">,</span> <span class="n">event</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_turn_with_llm_async</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">llm_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="n">Awaitable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">retrieval_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RetrievalConfig</span><span class="p">]],</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Complete conversation turn with async LLM callback integration.</span>

<span class="sd">        This method combines memory retrieval, LLM invocation, and response storage</span>
<span class="sd">        in a single call using an async callback pattern.</span>

<span class="sd">        Args:</span>
<span class="sd">            actor_id: Actor identifier (e.g., &quot;user-123&quot;)</span>
<span class="sd">            session_id: Session identifier</span>
<span class="sd">            user_input: The user&#39;s message</span>
<span class="sd">            llm_callback: Async function that takes (user_input, memories) and returns agent_response.</span>
<span class="sd">                         The callback receives the user input and retrieved memories,</span>
<span class="sd">                         and should return the agent&#39;s response string</span>
<span class="sd">            retrieval_config: Optional dictionary mapping namespaces to RetrievalConfig objects.</span>
<span class="sd">                            Each namespace can contain template variables like {actorId}, {sessionId},</span>
<span class="sd">                            {memoryStrategyId} that will be resolved at runtime.</span>
<span class="sd">            metadata: Optional custom key-value metadata to attach to an event.</span>
<span class="sd">            event_timestamp: Optional timestamp for the event</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple of (retrieved_memories, agent_response, created_event)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Step 1: Retrieve relevant memories</span>
        <span class="n">retrieved_memories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_retrieve_memories_for_llm</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">user_input</span><span class="p">,</span> <span class="n">retrieval_config</span><span class="p">)</span>

        <span class="c1"># Step 2: Invoke async LLM callback</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">agent_response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">llm_callback</span><span class="p">(</span><span class="n">user_input</span><span class="p">,</span> <span class="n">retrieved_memories</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agent_response</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;LLM callback must return a string response&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;LLM callback generated response&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;LLM callback failed: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

        <span class="c1"># Step 3: Save the conversation turn</span>
        <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_conversation_turn</span><span class="p">(</span>
            <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">user_input</span><span class="p">,</span> <span class="n">agent_response</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">event_timestamp</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">retrieved_memories</span><span class="p">,</span> <span class="n">agent_response</span><span class="p">,</span> <span class="n">event</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_retrieve_memories_for_llm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">retrieval_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RetrievalConfig</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper method to retrieve memories for LLM context.&quot;&quot;&quot;</span>
        <span class="n">retrieved_memories</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">retrieval_config</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">retrieval_config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">resolved_namespace</span> <span class="o">=</span> <span class="n">namespace</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">actorId</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
                    <span class="n">sessionId</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
                    <span class="n">strategyId</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">strategy_id</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">search_query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">retrieval_query</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">user_input</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">retrieval_query</span> <span class="k">else</span> <span class="n">user_input</span>
                <span class="n">memory_records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_long_term_memories</span><span class="p">(</span>
                    <span class="n">query</span><span class="o">=</span><span class="n">search_query</span><span class="p">,</span> <span class="n">namespace_prefix</span><span class="o">=</span><span class="n">resolved_namespace</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">top_k</span>
                <span class="p">)</span>
                <span class="c1"># Filter memory records with a relevance score which is lower than config.relevance_score</span>
                <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">relevance_score</span><span class="p">:</span>
                    <span class="n">memory_records</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">record</span>
                        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">memory_records</span>
                        <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;relevanceScore&quot;</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">relevance_score</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">config</span><span class="o">.</span><span class="n">relevance_score</span>
                    <span class="p">]</span>
                <span class="n">retrieved_memories</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">memory_records</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieved </span><span class="si">%d</span><span class="s2"> memories for LLM context&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">retrieved_memories</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">retrieved_memories</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_save_conversation_turn</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">agent_response</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]],</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper method to save conversation turn.&quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_turns</span><span class="p">(</span>
            <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
            <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
                <span class="n">ConversationalMessage</span><span class="p">(</span><span class="n">user_input</span><span class="p">,</span> <span class="n">MessageRole</span><span class="o">.</span><span class="n">USER</span><span class="p">),</span>
                <span class="n">ConversationalMessage</span><span class="p">(</span><span class="n">agent_response</span><span class="p">,</span> <span class="n">MessageRole</span><span class="o">.</span><span class="n">ASSISTANT</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">event_timestamp</span><span class="o">=</span><span class="n">event_timestamp</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Completed full conversation turn with LLM&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">event</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_turns</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ConversationalMessage</span><span class="p">,</span> <span class="n">BlobMessage</span><span class="p">]],</span>
        <span class="n">branch</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Event</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds conversational turns or blob objects to short-term memory.</span>

<span class="sd">        Maps to: bedrock-agentcore.create_event</span>

<span class="sd">        Args:</span>
<span class="sd">            actor_id: Actor identifier</span>
<span class="sd">            session_id: Session identifier</span>
<span class="sd">            messages: List of either:</span>
<span class="sd">                - ConversationalMessage objects for conversational messages</span>
<span class="sd">                - BlobMessage objects for blob data</span>
<span class="sd">            branch: Optional branch info</span>
<span class="sd">            metadata: Optional custom key-value metadata to attach to an event.</span>
<span class="sd">            event_timestamp: Optional timestamp for the event</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created event</span>

<span class="sd">        Example:</span>
<span class="sd">        ```</span>
<span class="sd">            manager.add_turns(</span>
<span class="sd">                actor_id=&quot;user-123&quot;,</span>
<span class="sd">                session_id=&quot;session-456&quot;,</span>
<span class="sd">                messages=[</span>
<span class="sd">                    ConversationalMessage(&quot;Hello&quot;, USER),</span>
<span class="sd">                    BlobMessage({&quot;file_data&quot;: &quot;base64_content&quot;}),</span>
<span class="sd">                    ConversationalMessage(&quot;How can I help?&quot;, ASSISTANT)</span>
<span class="sd">                ],</span>
<span class="sd">                metadata=[</span>
<span class="sd">                    {</span>
<span class="sd">                        &#39;location&#39;: {</span>
<span class="sd">                            &#39;stringValue&#39;: &#39;NYC&#39;</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                ]</span>
<span class="sd">            )</span>
<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  -&gt; Storing </span><span class="si">%d</span><span class="s2"> messages in short-term memory...&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">messages</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">messages</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one message is required&quot;</span><span class="p">)</span>

        <span class="n">payload</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">ConversationalMessage</span><span class="p">):</span>
                <span class="c1"># Handle ConversationalMessage data class</span>
                <span class="n">payload</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;conversational&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">message</span><span class="o">.</span><span class="n">text</span><span class="p">},</span> <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">message</span><span class="o">.</span><span class="n">role</span><span class="o">.</span><span class="n">value</span><span class="p">}})</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">BlobMessage</span><span class="p">):</span>
                <span class="c1"># Handle BlobMessage data class</span>
                <span class="n">payload</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;blob&quot;</span><span class="p">:</span> <span class="n">message</span><span class="o">.</span><span class="n">data</span><span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid message format. Must be ConversationalMessage or BlobMessage&quot;</span><span class="p">)</span>

        <span class="c1"># Use provided timestamp or current time</span>
        <span class="k">if</span> <span class="n">event_timestamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">event_timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span>
            <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
            <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
            <span class="s2">&quot;eventTimestamp&quot;</span><span class="p">:</span> <span class="n">event_timestamp</span><span class="p">,</span>
            <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">branch</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;branch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch</span>

        <span class="k">if</span> <span class="n">metadata</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;     ✅ Turn stored successfully with Event ID: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;eventId&quot;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Event</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;event&quot;</span><span class="p">])</span>
        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;     ❌ Error storing turn: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fork_conversation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">root_event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">branch_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ConversationalMessage</span><span class="p">,</span> <span class="n">BlobMessage</span><span class="p">]],</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fork a conversation from a specific event to create a new branch.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">branch</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;rootEventId&quot;</span><span class="p">:</span> <span class="n">root_event_id</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">}</span>

            <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_turns</span><span class="p">(</span>
                <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
                <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
                <span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
                <span class="n">event_timestamp</span><span class="o">=</span><span class="n">event_timestamp</span><span class="p">,</span>
                <span class="n">branch</span><span class="o">=</span><span class="n">branch</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created branch &#39;</span><span class="si">%s</span><span class="s2">&#39; from event </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">,</span> <span class="n">root_event_id</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">event</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to fork conversation: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_events</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_parent_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">eventMetadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">EventMetadataFilter</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">include_payload</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List all events in a session with pagination support.</span>

<span class="sd">        This method provides direct access to the raw events API, allowing developers</span>
<span class="sd">        to retrieve all events without the turn grouping logic of get_last_k_turns.</span>

<span class="sd">        Args:</span>
<span class="sd">            actor_id: Actor identifier</span>
<span class="sd">            session_id: Session identifier</span>
<span class="sd">            branch_name: Optional branch name to filter events (None for all branches)</span>
<span class="sd">            include_parent_branches: Whether to include parent branch events (only applies with branch_name)</span>
<span class="sd">            eventMetadata: Optional list of event metadata filters to apply</span>
<span class="sd">            max_results: Maximum number of events to return</span>
<span class="sd">            include_payload: Whether to include event payloads in response</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of event dictionaries in chronological order</span>

<span class="sd">        Example:</span>
<span class="sd">            # Get all events</span>
<span class="sd">            events = client.list_events(actor_id, session_id)</span>

<span class="sd">            # Get only main branch events</span>
<span class="sd">            main_events = client.list_events(actor_id, session_id, branch_name=&quot;main&quot;)</span>

<span class="sd">            # Get events from a specific branch</span>
<span class="sd">            branch_events = client.list_events(actor_id, session_id, branch_name=&quot;test-branch&quot;)</span>

<span class="sd">            #### Get events with event metadata filter</span>
<span class="sd">            ```</span>
<span class="sd">            filtered_events_with_metadata = client.list_events(</span>
<span class="sd">                actor_id=actor_id,</span>
<span class="sd">                session_id=session_id,</span>
<span class="sd">                eventMetadata=[</span>
<span class="sd">                    {</span>
<span class="sd">                        &#39;left&#39;: {</span>
<span class="sd">                            &#39;metadataKey&#39;: &#39;location&#39;</span>
<span class="sd">                        },</span>
<span class="sd">                        &#39;operator&#39;: &#39;EQUALS_TO&#39;,</span>
<span class="sd">                        &#39;right&#39;: {</span>
<span class="sd">                            &#39;metadataValue&#39;: {</span>
<span class="sd">                                &#39;stringValue&#39;: &#39;NYC&#39;</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                ]</span>
<span class="sd">            )</span>
<span class="sd">            ```</span>

<span class="sd">            #### Get events with event metadata filter + specific branch filter</span>
<span class="sd">            ```</span>
<span class="sd">            branch_with_metadata_filtered_events = client.list_events(</span>
<span class="sd">                actor_id=actor_id,</span>
<span class="sd">                session_id=session_id,</span>
<span class="sd">                branch_name=&quot;test-branch&quot;,</span>
<span class="sd">                eventMetadata=[</span>
<span class="sd">                    {</span>
<span class="sd">                        &#39;left&#39;: {</span>
<span class="sd">                            &#39;metadataKey&#39;: &#39;location&#39;</span>
<span class="sd">                        },</span>
<span class="sd">                        &#39;operator&#39;: &#39;EQUALS_TO&#39;,</span>
<span class="sd">                        &#39;right&#39;: {</span>
<span class="sd">                            &#39;metadataValue&#39;: {</span>
<span class="sd">                                &#39;stringValue&#39;: &#39;NYC&#39;</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                ]</span>
<span class="sd">            )</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">all_events</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Event</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">next_token</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">max_iterations</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Safety limit to prevent infinite loops</span>

            <span class="n">iteration_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_results</span> <span class="ow">and</span> <span class="n">iteration_count</span> <span class="o">&lt;</span> <span class="n">max_iterations</span><span class="p">:</span>
                <span class="n">iteration_count</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span>
                    <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
                    <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
                    <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_results</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">)),</span>
                    <span class="s2">&quot;includePayloads&quot;</span><span class="p">:</span> <span class="n">include_payload</span><span class="p">,</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="n">next_token</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>

                <span class="c1"># Add branch filter if specified (but not for &quot;main&quot;)</span>
                <span class="k">if</span> <span class="n">branch_name</span> <span class="ow">and</span> <span class="n">branch_name</span> <span class="o">!=</span> <span class="s2">&quot;main&quot;</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;branch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">,</span> <span class="s2">&quot;includeParentBranches&quot;</span><span class="p">:</span> <span class="n">include_parent_branches</span><span class="p">}</span>
                    <span class="p">}</span>

                <span class="c1"># Add eventMetadata filter if specified</span>
                <span class="k">if</span> <span class="n">eventMetadata</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;eventMetadata&quot;</span><span class="p">:</span> <span class="n">eventMetadata</span><span class="p">}</span>

                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

                <span class="n">events</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[])</span>

                <span class="c1"># If no events returned, break to prevent infinite loop</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No more events returned, ending pagination&quot;</span><span class="p">)</span>
                    <span class="k">break</span>

                <span class="n">all_events</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">Event</span><span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">])</span>

                <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">next_token</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">max_results</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="n">iteration_count</span> <span class="o">&gt;=</span> <span class="n">max_iterations</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Reached maximum iteration limit (</span><span class="si">%d</span><span class="s2">) in list_events pagination&quot;</span><span class="p">,</span> <span class="n">max_iterations</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieved total of </span><span class="si">%d</span><span class="s2"> events&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">all_events</span><span class="p">[:</span><span class="n">max_results</span><span class="p">]</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list events: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_branches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Branch</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List all branches in a session.</span>

<span class="sd">        This method handles pagination automatically and provides a structured view</span>
<span class="sd">        of all conversation branches, which would require complex pagination and</span>
<span class="sd">        grouping logic if done with raw boto3 calls.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of branch information including name and root event</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Get all events - need to handle pagination for complete list</span>
            <span class="n">all_events</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">next_token</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">max_iterations</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Safety limit to prevent infinite loops</span>

            <span class="n">iteration_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">iteration_count</span> <span class="o">&lt;</span> <span class="n">max_iterations</span><span class="p">:</span>
                <span class="n">iteration_count</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span> <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span> <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>

                <span class="k">if</span> <span class="n">next_token</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>

                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
                <span class="n">events</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[])</span>

                <span class="c1"># If no events returned, break to prevent infinite loop</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No more events returned, ending pagination in list_branches&quot;</span><span class="p">)</span>
                    <span class="k">break</span>

                <span class="n">all_events</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">events</span><span class="p">)</span>

                <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">next_token</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="n">iteration_count</span> <span class="o">&gt;=</span> <span class="n">max_iterations</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Reached maximum iteration limit (</span><span class="si">%d</span><span class="s2">) in list_branches pagination&quot;</span><span class="p">,</span> <span class="n">max_iterations</span><span class="p">)</span>

            <span class="n">branches</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">main_branch_events</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">all_events</span><span class="p">:</span>
                <span class="n">branch_info</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;branch&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">branch_info</span><span class="p">:</span>
                    <span class="n">branch_name</span> <span class="o">=</span> <span class="n">branch_info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">branch_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">:</span>
                        <span class="n">branches</span><span class="p">[</span><span class="n">branch_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">,</span>
                            <span class="s2">&quot;rootEventId&quot;</span><span class="p">:</span> <span class="n">branch_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rootEventId&quot;</span><span class="p">),</span>
                            <span class="s2">&quot;firstEventId&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">],</span>
                            <span class="s2">&quot;eventCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventTimestamp&quot;</span><span class="p">],</span>
                        <span class="p">}</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">branches</span><span class="p">[</span><span class="n">branch_name</span><span class="p">][</span><span class="s2">&quot;eventCount&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">main_branch_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

            <span class="c1"># Build result list</span>
            <span class="n">result</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Branch</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="c1"># Only add main branch if there are actual events</span>
            <span class="k">if</span> <span class="n">main_branch_events</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;rootEventId&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s2">&quot;firstEventId&quot;</span><span class="p">:</span> <span class="n">main_branch_events</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;eventId&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;eventCount&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_branch_events</span><span class="p">),</span>
                        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="n">main_branch_events</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;eventTimestamp&quot;</span><span class="p">],</span>
                    <span class="p">}</span>
                <span class="p">)</span>

            <span class="c1"># Add other branches</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">branches</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Found </span><span class="si">%d</span><span class="s2"> branches in session </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="n">session_id</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">Branch</span><span class="p">(</span><span class="n">branch</span><span class="p">)</span> <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list branches: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_last_k_turns</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_parent_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">EventMessage</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the last K conversation turns.</span>

<span class="sd">        A &quot;turn&quot; typically consists of a user message followed by assistant response(s).</span>
<span class="sd">        This method groups messages into logical turns for easier processing.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of turns, where each turn is a list of message dictionaries</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span>
                <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
                <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
                <span class="n">branch_name</span><span class="o">=</span><span class="n">branch_name</span><span class="p">,</span>
                <span class="n">include_parent_branches</span><span class="o">=</span><span class="n">include_parent_branches</span><span class="p">,</span>
                <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>

            <span class="c1"># Process events to group into turns</span>
            <span class="n">turns</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">current_turn</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">turns</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">:</span>
                    <span class="k">break</span>  <span class="c1"># Only need last K turns</span>
                <span class="k">for</span> <span class="n">payload_item</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;payload&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                    <span class="k">if</span> <span class="s2">&quot;conversational&quot;</span> <span class="ow">in</span> <span class="n">payload_item</span><span class="p">:</span>
                        <span class="n">role</span> <span class="o">=</span> <span class="n">payload_item</span><span class="p">[</span><span class="s2">&quot;conversational&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;role&quot;</span><span class="p">)</span>

                        <span class="c1"># Start new turn on USER message</span>
                        <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="n">MessageRole</span><span class="o">.</span><span class="n">USER</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span> <span class="n">current_turn</span><span class="p">:</span>
                            <span class="n">turns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_turn</span><span class="p">)</span>
                            <span class="n">current_turn</span> <span class="o">=</span> <span class="p">[]</span>

                        <span class="n">current_turn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EventMessage</span><span class="p">(</span><span class="n">payload_item</span><span class="p">[</span><span class="s2">&quot;conversational&quot;</span><span class="p">]))</span>

            <span class="c1"># Don&#39;t forget the last turn</span>
            <span class="k">if</span> <span class="n">current_turn</span><span class="p">:</span>
                <span class="n">turns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_turn</span><span class="p">)</span>

            <span class="c1"># Return the last k turns</span>
            <span class="k">return</span> <span class="n">turns</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">turns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">k</span> <span class="k">else</span> <span class="n">turns</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get last K turns: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Event</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves a specific event from short-term memory by its ID.</span>

<span class="sd">        Maps to: bedrock-agentcore.get_event.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  -&gt; Retrieving event by ID: </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">get_event</span><span class="p">(</span>
                <span class="n">memoryId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="n">actorId</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">sessionId</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span> <span class="n">eventId</span><span class="o">=</span><span class="n">event_id</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;     ✅ Event retrieved.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Event</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;event&quot;</span><span class="p">,</span> <span class="p">{}))</span>
        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;     ❌ Error retrieving event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deletes a specific event from short-term memory by its ID.</span>

<span class="sd">        Maps to: bedrock-agentcore.delete_event.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  -&gt; Deleting event by ID: </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">delete_event</span><span class="p">(</span>
                <span class="n">memoryId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="n">actorId</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">sessionId</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span> <span class="n">eventId</span><span class="o">=</span><span class="n">event_id</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;     ✅ Event deleted successfully.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;     ❌ Error deleting event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">search_long_term_memories</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">namespace_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MemoryRecord</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs a semantic search against the long-term memory for this actor.</span>

<span class="sd">        Maps to: bedrock-agentcore.retrieve_memory_records.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  -&gt; Querying long-term memory in namespace &#39;</span><span class="si">%s</span><span class="s2">&#39; with query: &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span><span class="p">,</span> <span class="n">namespace_prefix</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
        <span class="n">search_criteria</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;searchQuery&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span> <span class="s2">&quot;topK&quot;</span><span class="p">:</span> <span class="n">top_k</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">strategy_id</span><span class="p">:</span>
            <span class="n">search_criteria</span><span class="p">[</span><span class="s2">&quot;strategyId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy_id</span>

        <span class="n">namespace</span> <span class="o">=</span> <span class="n">namespace_prefix</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span>
            <span class="s2">&quot;searchCriteria&quot;</span><span class="p">:</span> <span class="n">search_criteria</span><span class="p">,</span>
            <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="n">namespace</span><span class="p">,</span>
            <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="n">max_results</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">retrieve_memory_records</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
            <span class="n">records</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryRecordSummaries&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;     ✅ Found </span><span class="si">%d</span><span class="s2"> relevant long-term records.&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">))</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">MemoryRecord</span><span class="p">(</span><span class="n">record</span><span class="p">)</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">]</span>
        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;     ❌ Error querying long-term memory&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_long_term_memory_records</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">namespace_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MemoryRecord</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lists all long-term memory records for this actor without a semantic query.</span>

<span class="sd">        Maps to: bedrock-agentcore.list_memory_records.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  -&gt; Listing all long-term records in namespace &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span><span class="p">,</span> <span class="n">namespace_prefix</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">paginator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s2">&quot;list_memory_records&quot;</span><span class="p">)</span>

            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span>
                <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="n">namespace_prefix</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">strategy_id</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy_id</span>

            <span class="n">pages</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
            <span class="n">all_records</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MemoryRecord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pages</span><span class="p">:</span>
                <span class="n">memory_records</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryRecords&quot;</span><span class="p">,</span> <span class="p">[])</span>
                <span class="c1"># Also check for memoryRecordSummaries (which is what the API actually returns)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">memory_records</span><span class="p">:</span>
                    <span class="n">memory_records</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryRecordSummaries&quot;</span><span class="p">,</span> <span class="p">[])</span>

                <span class="n">all_records</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">MemoryRecord</span><span class="p">(</span><span class="n">record</span><span class="p">)</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">memory_records</span><span class="p">])</span>

                <span class="c1"># Stop if we&#39;ve reached max_results</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_records</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">max_results</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;     ✅ Found a total of </span><span class="si">%d</span><span class="s2"> long-term records.&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_records</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">all_records</span><span class="p">[:</span><span class="n">max_results</span><span class="p">]</span>

        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;     ❌ Error listing long-term records: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ActorSummary</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lists all actors who have events in a specific memory.</span>

<span class="sd">        Maps to: bedrock-agentcore.list_actors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;👥 Listing all actors for memory </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">paginator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s2">&quot;list_actors&quot;</span><span class="p">)</span>
            <span class="n">pages</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">)</span>
            <span class="n">all_actors</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pages</span><span class="p">:</span>
                <span class="n">actor_summaries</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;actorSummaries&quot;</span><span class="p">,</span> <span class="p">[])</span>
                <span class="n">all_actors</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">ActorSummary</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span> <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="n">actor_summaries</span><span class="p">])</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  ✅ Found </span><span class="si">%d</span><span class="s2"> actors.&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_actors</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">all_actors</span>
        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;  ❌ Error listing actors: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_memory_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MemoryRecord</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves a specific long-term memory record by its ID.</span>

<span class="sd">        Maps to: bedrock-agentcore.get_memory_record.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;📄 Retrieving long-term record by ID: </span><span class="si">%s</span><span class="s2"> from memory </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">record_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">get_memory_record</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="n">memoryRecordId</span><span class="o">=</span><span class="n">record_id</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  ✅ Record retrieved.&quot;</span><span class="p">)</span>
            <span class="n">memory_record</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryRecord&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">return</span> <span class="n">MemoryRecord</span><span class="p">(</span><span class="n">memory_record</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;  ❌ Error retrieving record: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_memory_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deletes a specific long-term memory record by its ID.</span>

<span class="sd">        Maps to: bedrock-agentcore.delete_memory_record.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;🗑️ Deleting long-term record by ID: </span><span class="si">%s</span><span class="s2"> from memory </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">record_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">delete_memory_record</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="n">memoryRecordId</span><span class="o">=</span><span class="n">record_id</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  ✅ Record deleted successfully.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;  ❌ Error deleting record: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_actor_sessions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">SessionSummary</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lists all sessions for a specific actor in a specific memory.</span>

<span class="sd">        Maps to: bedrock-agentcore.list_sessions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;🗂️ Listing all sessions for actor &#39;</span><span class="si">%s</span><span class="s2">&#39; in memory </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">paginator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s2">&quot;list_sessions&quot;</span><span class="p">)</span>
            <span class="n">pages</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="n">actorId</span><span class="o">=</span><span class="n">actor_id</span><span class="p">)</span>
            <span class="n">all_sessions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SessionSummary</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pages</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sessionSummaries&quot;</span><span class="p">,</span> <span class="p">[])</span>
                <span class="n">all_sessions</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">SessionSummary</span><span class="p">(</span><span class="n">session</span><span class="p">)</span> <span class="k">for</span> <span class="n">session</span> <span class="ow">in</span> <span class="n">response</span><span class="p">])</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  ✅ Found </span><span class="si">%d</span><span class="s2"> sessions.&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_sessions</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">all_sessions</span>
        <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;  ❌ Error listing sessions: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_memory_session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MemorySession&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a new MemorySession instance.&quot;&quot;&quot;</span>
        <span class="n">session_id</span> <span class="o">=</span> <span class="n">session_id</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;💬 Creating new conversation for actor &#39;</span><span class="si">%s</span><span class="s2">&#39; in session &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">MemorySession</span><span class="p">(</span><span class="n">memory_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span> <span class="n">manager</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.__getattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getattr__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.__getattr__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Dynamically forward method calls to the appropriate boto3 client.</p>
<p>This method enables access to all data_plane boto3 client methods without explicitly
defining them. Methods are looked up in the following order:
_data_plane_client (bedrock-agentcore) - for data plane operations</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The method name being accessed</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A callable method from the boto3 client</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the method doesn't exist on _data_plane_client</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <h5 id="bedrock_agentcore.memory.MemorySessionManager.__getattr__--access-any-boto3-method-directly">Access any boto3 method directly<a class="headerlink" href="#bedrock_agentcore.memory.MemorySessionManager.__getattr__--access-any-boto3-method-directly" title="Permanent link">&para;</a></h5>
<p>manager = MemorySessionManager(region_name="us-east-1")</p>
<h5 id="bedrock_agentcore.memory.MemorySessionManager.__getattr__--these-calls-are-forwarded-to-the-appropriate-boto3-functions">These calls are forwarded to the appropriate boto3 functions<a class="headerlink" href="#bedrock_agentcore.memory.MemorySessionManager.__getattr__--these-calls-are-forwarded-to-the-appropriate-boto3-functions" title="Permanent link">&para;</a></h5>
<p>memory_records = manager.retrieve_memory_records()
events = manager.list_events(...)</p>
</details>

            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dynamically forward method calls to the appropriate boto3 client.</span>

<span class="sd">    This method enables access to all data_plane boto3 client methods without explicitly</span>
<span class="sd">    defining them. Methods are looked up in the following order:</span>
<span class="sd">    _data_plane_client (bedrock-agentcore) - for data plane operations</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The method name being accessed</span>

<span class="sd">    Returns:</span>
<span class="sd">        A callable method from the boto3 client</span>

<span class="sd">    Raises:</span>
<span class="sd">        AttributeError: If the method doesn&#39;t exist on _data_plane_client</span>

<span class="sd">    Example:</span>
<span class="sd">        # Access any boto3 method directly</span>
<span class="sd">        manager = MemorySessionManager(region_name=&quot;us-east-1&quot;)</span>

<span class="sd">        # These calls are forwarded to the appropriate boto3 functions</span>
<span class="sd">        memory_records = manager.retrieve_memory_records()</span>
<span class="sd">        events = manager.list_events(...)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ALLOWED_DATA_PLANE_METHODS</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Forwarding method &#39;</span><span class="si">%s</span><span class="s2">&#39; to _data_plane_client&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">method</span>

    <span class="c1"># Method not found on client</span>
    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Method not found on _data_plane_client. &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Available methods can be found in the boto3 documentation for &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;&#39;bedrock-agentcore&#39; services.&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">memory_id</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boto3_session</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boto_client_config</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize a MemorySessionManager instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>memory_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The memory identifier for this session manager.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>region_name</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>AWS region for the bedrock-agentcore client. If not provided,
   will use the region from boto3_session or default session.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>boto3_session</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="boto3.Session">Session</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional boto3 Session to use. If provided and region_name
          parameter is also specified, validation will ensure they match.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>boto_client_config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="botocore.config.Config">Config</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional boto3 client configuration. If provided, will be
              merged with default configuration including user agent.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If region_name parameter conflicts with boto3_session region.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">memory_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">region_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">boto3_session</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">boto_client_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BotocoreConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a MemorySessionManager instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        memory_id: The memory identifier for this session manager.</span>
<span class="sd">        region_name: AWS region for the bedrock-agentcore client. If not provided,</span>
<span class="sd">               will use the region from boto3_session or default session.</span>
<span class="sd">        boto3_session: Optional boto3 Session to use. If provided and region_name</span>
<span class="sd">                      parameter is also specified, validation will ensure they match.</span>
<span class="sd">        boto_client_config: Optional boto3 client configuration. If provided, will be</span>
<span class="sd">                          merged with default configuration including user agent.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If region_name parameter conflicts with boto3_session region.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize core attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span> <span class="o">=</span> <span class="n">memory_id</span>

    <span class="c1"># Setup session and validate region consistency</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">region_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_resolve_region</span><span class="p">(</span><span class="n">region_name</span><span class="p">,</span> <span class="n">boto3_session</span><span class="p">)</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">boto3_session</span> <span class="k">if</span> <span class="n">boto3_session</span> <span class="k">else</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

    <span class="c1"># Configure and create boto3 client</span>
    <span class="n">client_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_client_config</span><span class="p">(</span><span class="n">boto_client_config</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">client</span><span class="p">(</span>
        <span class="s2">&quot;bedrock-agentcore&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">region_name</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">client_config</span>
    <span class="p">)</span>

    <span class="c1"># Configure timestamp serialization to use float representation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_configure_timestamp_serialization</span><span class="p">()</span>

    <span class="c1"># Define allowed data plane methods</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ALLOWED_DATA_PLANE_METHODS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;retrieve_memory_records&quot;</span><span class="p">,</span>
        <span class="s2">&quot;get_memory_record&quot;</span><span class="p">,</span>
        <span class="s2">&quot;delete_memory_record&quot;</span><span class="p">,</span>
        <span class="s2">&quot;list_memory_records&quot;</span><span class="p">,</span>
        <span class="s2">&quot;create_event&quot;</span><span class="p">,</span>
        <span class="s2">&quot;get_event&quot;</span><span class="p">,</span>
        <span class="s2">&quot;delete_event&quot;</span><span class="p">,</span>
        <span class="s2">&quot;list_events&quot;</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.add_turns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_turns</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">messages</span><span class="p">,</span> <span class="n">branch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.add_turns" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Adds conversational turns or blob objects to short-term memory.</p>
<p>Maps to: bedrock-agentcore.create_event</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>actor_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Actor identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>messages</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="bedrock_agentcore.memory.constants.ConversationalMessage">ConversationalMessage</span>, <span title="bedrock_agentcore.memory.constants.BlobMessage">BlobMessage</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of either:
- ConversationalMessage objects for conversational messages
- BlobMessage objects for blob data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>branch</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional branch info</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="bedrock_agentcore.memory.models.MetadataValue">MetadataValue</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom key-value metadata to attach to an event.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_timestamp</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="datetime.datetime">datetime</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional timestamp for the event</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bedrock_agentcore.memory.models.Event">Event</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Created event</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
<div class="highlight"><pre><span></span><code>    manager.add_turns(
        actor_id=&quot;user-123&quot;,
        session_id=&quot;session-456&quot;,
        messages=[
            ConversationalMessage(&quot;Hello&quot;, USER),
            BlobMessage({&quot;file_data&quot;: &quot;base64_content&quot;}),
            ConversationalMessage(&quot;How can I help?&quot;, ASSISTANT)
        ],
        metadata=[
            {
                &#39;location&#39;: {
                    &#39;stringValue&#39;: &#39;NYC&#39;
                }
            }
        ]
    )
</code></pre></div></p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_turns</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ConversationalMessage</span><span class="p">,</span> <span class="n">BlobMessage</span><span class="p">]],</span>
    <span class="n">branch</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Event</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds conversational turns or blob objects to short-term memory.</span>

<span class="sd">    Maps to: bedrock-agentcore.create_event</span>

<span class="sd">    Args:</span>
<span class="sd">        actor_id: Actor identifier</span>
<span class="sd">        session_id: Session identifier</span>
<span class="sd">        messages: List of either:</span>
<span class="sd">            - ConversationalMessage objects for conversational messages</span>
<span class="sd">            - BlobMessage objects for blob data</span>
<span class="sd">        branch: Optional branch info</span>
<span class="sd">        metadata: Optional custom key-value metadata to attach to an event.</span>
<span class="sd">        event_timestamp: Optional timestamp for the event</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created event</span>

<span class="sd">    Example:</span>
<span class="sd">    ```</span>
<span class="sd">        manager.add_turns(</span>
<span class="sd">            actor_id=&quot;user-123&quot;,</span>
<span class="sd">            session_id=&quot;session-456&quot;,</span>
<span class="sd">            messages=[</span>
<span class="sd">                ConversationalMessage(&quot;Hello&quot;, USER),</span>
<span class="sd">                BlobMessage({&quot;file_data&quot;: &quot;base64_content&quot;}),</span>
<span class="sd">                ConversationalMessage(&quot;How can I help?&quot;, ASSISTANT)</span>
<span class="sd">            ],</span>
<span class="sd">            metadata=[</span>
<span class="sd">                {</span>
<span class="sd">                    &#39;location&#39;: {</span>
<span class="sd">                        &#39;stringValue&#39;: &#39;NYC&#39;</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            ]</span>
<span class="sd">        )</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  -&gt; Storing </span><span class="si">%d</span><span class="s2"> messages in short-term memory...&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">messages</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">messages</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one message is required&quot;</span><span class="p">)</span>

    <span class="n">payload</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">ConversationalMessage</span><span class="p">):</span>
            <span class="c1"># Handle ConversationalMessage data class</span>
            <span class="n">payload</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;conversational&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">message</span><span class="o">.</span><span class="n">text</span><span class="p">},</span> <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="n">message</span><span class="o">.</span><span class="n">role</span><span class="o">.</span><span class="n">value</span><span class="p">}})</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">BlobMessage</span><span class="p">):</span>
            <span class="c1"># Handle BlobMessage data class</span>
            <span class="n">payload</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;blob&quot;</span><span class="p">:</span> <span class="n">message</span><span class="o">.</span><span class="n">data</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid message format. Must be ConversationalMessage or BlobMessage&quot;</span><span class="p">)</span>

    <span class="c1"># Use provided timestamp or current time</span>
    <span class="k">if</span> <span class="n">event_timestamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">event_timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span>
        <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
        <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
        <span class="s2">&quot;eventTimestamp&quot;</span><span class="p">:</span> <span class="n">event_timestamp</span><span class="p">,</span>
        <span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="n">payload</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">branch</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;branch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch</span>

    <span class="k">if</span> <span class="n">metadata</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;     ✅ Turn stored successfully with Event ID: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;eventId&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Event</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;event&quot;</span><span class="p">])</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;     ❌ Error storing turn: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.create_memory_session" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_memory_session</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.create_memory_session" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Creates a new MemorySession instance.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_memory_session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MemorySession&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a new MemorySession instance.&quot;&quot;&quot;</span>
    <span class="n">session_id</span> <span class="o">=</span> <span class="n">session_id</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;💬 Creating new conversation for actor &#39;</span><span class="si">%s</span><span class="s2">&#39; in session &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">MemorySession</span><span class="p">(</span><span class="n">memory_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span> <span class="n">manager</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.delete_event" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_event</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.delete_event" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Deletes a specific event from short-term memory by its ID.</p>
<p>Maps to: bedrock-agentcore.delete_event.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deletes a specific event from short-term memory by its ID.</span>

<span class="sd">    Maps to: bedrock-agentcore.delete_event.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  -&gt; Deleting event by ID: </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">delete_event</span><span class="p">(</span>
            <span class="n">memoryId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="n">actorId</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">sessionId</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span> <span class="n">eventId</span><span class="o">=</span><span class="n">event_id</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;     ✅ Event deleted successfully.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;     ❌ Error deleting event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.delete_memory_record" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_memory_record</span><span class="p">(</span><span class="n">record_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.delete_memory_record" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Deletes a specific long-term memory record by its ID.</p>
<p>Maps to: bedrock-agentcore.delete_memory_record.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_memory_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deletes a specific long-term memory record by its ID.</span>

<span class="sd">    Maps to: bedrock-agentcore.delete_memory_record.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;🗑️ Deleting long-term record by ID: </span><span class="si">%s</span><span class="s2"> from memory </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">record_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">delete_memory_record</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="n">memoryRecordId</span><span class="o">=</span><span class="n">record_id</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  ✅ Record deleted successfully.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;  ❌ Error deleting record: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.fork_conversation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fork_conversation</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">root_event_id</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">,</span> <span class="n">messages</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.fork_conversation" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Fork a conversation from a specific event to create a new branch.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fork_conversation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">root_event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">branch_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">ConversationalMessage</span><span class="p">,</span> <span class="n">BlobMessage</span><span class="p">]],</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fork a conversation from a specific event to create a new branch.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">branch</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;rootEventId&quot;</span><span class="p">:</span> <span class="n">root_event_id</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">}</span>

        <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_turns</span><span class="p">(</span>
            <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
            <span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
            <span class="n">event_timestamp</span><span class="o">=</span><span class="n">event_timestamp</span><span class="p">,</span>
            <span class="n">branch</span><span class="o">=</span><span class="n">branch</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created branch &#39;</span><span class="si">%s</span><span class="s2">&#39; from event </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">branch_name</span><span class="p">,</span> <span class="n">root_event_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">event</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to fork conversation: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.get_event" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_event</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.get_event" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Retrieves a specific event from short-term memory by its ID.</p>
<p>Maps to: bedrock-agentcore.get_event.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Event</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves a specific event from short-term memory by its ID.</span>

<span class="sd">    Maps to: bedrock-agentcore.get_event.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  -&gt; Retrieving event by ID: </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">get_event</span><span class="p">(</span>
            <span class="n">memoryId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="n">actorId</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">sessionId</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span> <span class="n">eventId</span><span class="o">=</span><span class="n">event_id</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;     ✅ Event retrieved.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Event</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;event&quot;</span><span class="p">,</span> <span class="p">{}))</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;     ❌ Error retrieving event: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.get_last_k_turns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_last_k_turns</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">branch_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_parent_branches</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.get_last_k_turns" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the last K conversation turns.</p>
<p>A "turn" typically consists of a user message followed by assistant response(s).
This method groups messages into logical turns for easier processing.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="bedrock_agentcore.memory.models.EventMessage">EventMessage</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of turns, where each turn is a list of message dictionaries</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_last_k_turns</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_parent_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">EventMessage</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the last K conversation turns.</span>

<span class="sd">    A &quot;turn&quot; typically consists of a user message followed by assistant response(s).</span>
<span class="sd">    This method groups messages into logical turns for easier processing.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of turns, where each turn is a list of message dictionaries</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span>
            <span class="n">actor_id</span><span class="o">=</span><span class="n">actor_id</span><span class="p">,</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
            <span class="n">branch_name</span><span class="o">=</span><span class="n">branch_name</span><span class="p">,</span>
            <span class="n">include_parent_branches</span><span class="o">=</span><span class="n">include_parent_branches</span><span class="p">,</span>
            <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="c1"># Process events to group into turns</span>
        <span class="n">turns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_turn</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">turns</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">:</span>
                <span class="k">break</span>  <span class="c1"># Only need last K turns</span>
            <span class="k">for</span> <span class="n">payload_item</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;payload&quot;</span><span class="p">,</span> <span class="p">[]):</span>
                <span class="k">if</span> <span class="s2">&quot;conversational&quot;</span> <span class="ow">in</span> <span class="n">payload_item</span><span class="p">:</span>
                    <span class="n">role</span> <span class="o">=</span> <span class="n">payload_item</span><span class="p">[</span><span class="s2">&quot;conversational&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;role&quot;</span><span class="p">)</span>

                    <span class="c1"># Start new turn on USER message</span>
                    <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="n">MessageRole</span><span class="o">.</span><span class="n">USER</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span> <span class="n">current_turn</span><span class="p">:</span>
                        <span class="n">turns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_turn</span><span class="p">)</span>
                        <span class="n">current_turn</span> <span class="o">=</span> <span class="p">[]</span>

                    <span class="n">current_turn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EventMessage</span><span class="p">(</span><span class="n">payload_item</span><span class="p">[</span><span class="s2">&quot;conversational&quot;</span><span class="p">]))</span>

        <span class="c1"># Don&#39;t forget the last turn</span>
        <span class="k">if</span> <span class="n">current_turn</span><span class="p">:</span>
            <span class="n">turns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_turn</span><span class="p">)</span>

        <span class="c1"># Return the last k turns</span>
        <span class="k">return</span> <span class="n">turns</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">turns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">k</span> <span class="k">else</span> <span class="n">turns</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to get last K turns: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.get_memory_record" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_memory_record</span><span class="p">(</span><span class="n">record_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.get_memory_record" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Retrieves a specific long-term memory record by its ID.</p>
<p>Maps to: bedrock-agentcore.get_memory_record.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_memory_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MemoryRecord</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves a specific long-term memory record by its ID.</span>

<span class="sd">    Maps to: bedrock-agentcore.get_memory_record.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;📄 Retrieving long-term record by ID: </span><span class="si">%s</span><span class="s2"> from memory </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">record_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">get_memory_record</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="n">memoryRecordId</span><span class="o">=</span><span class="n">record_id</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  ✅ Record retrieved.&quot;</span><span class="p">)</span>
        <span class="n">memory_record</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryRecord&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">return</span> <span class="n">MemoryRecord</span><span class="p">(</span><span class="n">memory_record</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;  ❌ Error retrieving record: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.list_actor_sessions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_actor_sessions</span><span class="p">(</span><span class="n">actor_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.list_actor_sessions" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Lists all sessions for a specific actor in a specific memory.</p>
<p>Maps to: bedrock-agentcore.list_sessions.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span>
<span class="normal">997</span>
<span class="normal">998</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_actor_sessions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">SessionSummary</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lists all sessions for a specific actor in a specific memory.</span>

<span class="sd">    Maps to: bedrock-agentcore.list_sessions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;🗂️ Listing all sessions for actor &#39;</span><span class="si">%s</span><span class="s2">&#39; in memory </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">paginator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s2">&quot;list_sessions&quot;</span><span class="p">)</span>
        <span class="n">pages</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="n">actorId</span><span class="o">=</span><span class="n">actor_id</span><span class="p">)</span>
        <span class="n">all_sessions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SessionSummary</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pages</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sessionSummaries&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">all_sessions</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">SessionSummary</span><span class="p">(</span><span class="n">session</span><span class="p">)</span> <span class="k">for</span> <span class="n">session</span> <span class="ow">in</span> <span class="n">response</span><span class="p">])</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  ✅ Found </span><span class="si">%d</span><span class="s2"> sessions.&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_sessions</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">all_sessions</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;  ❌ Error listing sessions: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.list_actors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_actors</span><span class="p">()</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.list_actors" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Lists all actors who have events in a specific memory.</p>
<p>Maps to: bedrock-agentcore.list_actors.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ActorSummary</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lists all actors who have events in a specific memory.</span>

<span class="sd">    Maps to: bedrock-agentcore.list_actors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;👥 Listing all actors for memory </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">paginator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s2">&quot;list_actors&quot;</span><span class="p">)</span>
        <span class="n">pages</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="n">memoryId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">)</span>
        <span class="n">all_actors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pages</span><span class="p">:</span>
            <span class="n">actor_summaries</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;actorSummaries&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">all_actors</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">ActorSummary</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span> <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="n">actor_summaries</span><span class="p">])</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  ✅ Found </span><span class="si">%d</span><span class="s2"> actors.&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_actors</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">all_actors</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;  ❌ Error listing actors: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.list_branches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_branches</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.list_branches" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>List all branches in a session.</p>
<p>This method handles pagination automatically and provides a structured view
of all conversation branches, which would require complex pagination and
grouping logic if done with raw boto3 calls.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="bedrock_agentcore.memory.models.Branch">Branch</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of branch information including name and root event</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_branches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Branch</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all branches in a session.</span>

<span class="sd">    This method handles pagination automatically and provides a structured view</span>
<span class="sd">    of all conversation branches, which would require complex pagination and</span>
<span class="sd">    grouping logic if done with raw boto3 calls.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of branch information including name and root event</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get all events - need to handle pagination for complete list</span>
        <span class="n">all_events</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">next_token</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">max_iterations</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Safety limit to prevent infinite loops</span>

        <span class="n">iteration_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">iteration_count</span> <span class="o">&lt;</span> <span class="n">max_iterations</span><span class="p">:</span>
            <span class="n">iteration_count</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span> <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span> <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span> <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>

            <span class="k">if</span> <span class="n">next_token</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
            <span class="n">events</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[])</span>

            <span class="c1"># If no events returned, break to prevent infinite loop</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No more events returned, ending pagination in list_branches&quot;</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="n">all_events</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">events</span><span class="p">)</span>

            <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">next_token</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">iteration_count</span> <span class="o">&gt;=</span> <span class="n">max_iterations</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Reached maximum iteration limit (</span><span class="si">%d</span><span class="s2">) in list_branches pagination&quot;</span><span class="p">,</span> <span class="n">max_iterations</span><span class="p">)</span>

        <span class="n">branches</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">main_branch_events</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">all_events</span><span class="p">:</span>
            <span class="n">branch_info</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;branch&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">branch_info</span><span class="p">:</span>
                <span class="n">branch_name</span> <span class="o">=</span> <span class="n">branch_info</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">branch_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">:</span>
                    <span class="n">branches</span><span class="p">[</span><span class="n">branch_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">,</span>
                        <span class="s2">&quot;rootEventId&quot;</span><span class="p">:</span> <span class="n">branch_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rootEventId&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;firstEventId&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventId&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;eventCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;eventTimestamp&quot;</span><span class="p">],</span>
                    <span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">branches</span><span class="p">[</span><span class="n">branch_name</span><span class="p">][</span><span class="s2">&quot;eventCount&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">main_branch_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

        <span class="c1"># Build result list</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Branch</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Only add main branch if there are actual events</span>
        <span class="k">if</span> <span class="n">main_branch_events</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;rootEventId&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;firstEventId&quot;</span><span class="p">:</span> <span class="n">main_branch_events</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;eventId&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;eventCount&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">main_branch_events</span><span class="p">),</span>
                    <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="n">main_branch_events</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;eventTimestamp&quot;</span><span class="p">],</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="c1"># Add other branches</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">branches</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Found </span><span class="si">%d</span><span class="s2"> branches in session </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="n">session_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Branch</span><span class="p">(</span><span class="n">branch</span><span class="p">)</span> <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list branches: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.list_events" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_events</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">branch_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_parent_branches</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eventMetadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">include_payload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.list_events" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>List all events in a session with pagination support.</p>
<p>This method provides direct access to the raw events API, allowing developers
to retrieve all events without the turn grouping logic of get_last_k_turns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>actor_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Actor identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>branch_name</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional branch name to filter events (None for all branches)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_parent_branches</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include parent branch events (only applies with branch_name)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eventMetadata</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="bedrock_agentcore.memory.models.EventMetadataFilter">EventMetadataFilter</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of event metadata filters to apply</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_results</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of events to return</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>include_payload</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include event payloads in response</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="bedrock_agentcore.memory.models.Event">Event</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of event dictionaries in chronological order</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <h5 id="bedrock_agentcore.memory.MemorySessionManager.list_events--get-all-events">Get all events<a class="headerlink" href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-all-events" title="Permanent link">&para;</a></h5>
<p>events = client.list_events(actor_id, session_id)</p>
<h5 id="bedrock_agentcore.memory.MemorySessionManager.list_events--get-only-main-branch-events">Get only main branch events<a class="headerlink" href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-only-main-branch-events" title="Permanent link">&para;</a></h5>
<p>main_events = client.list_events(actor_id, session_id, branch_name="main")</p>
<h5 id="bedrock_agentcore.memory.MemorySessionManager.list_events--get-events-from-a-specific-branch">Get events from a specific branch<a class="headerlink" href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-events-from-a-specific-branch" title="Permanent link">&para;</a></h5>
<p>branch_events = client.list_events(actor_id, session_id, branch_name="test-branch")</p>
<h6 id="bedrock_agentcore.memory.MemorySessionManager.list_events--get-events-with-event-metadata-filter">Get events with event metadata filter<a class="headerlink" href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-events-with-event-metadata-filter" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>filtered_events_with_metadata = client.list_events(
    actor_id=actor_id,
    session_id=session_id,
    eventMetadata=[
        {
            &#39;left&#39;: {
                &#39;metadataKey&#39;: &#39;location&#39;
            },
            &#39;operator&#39;: &#39;EQUALS_TO&#39;,
            &#39;right&#39;: {
                &#39;metadataValue&#39;: {
                    &#39;stringValue&#39;: &#39;NYC&#39;
                }
            }
        }
    ]
)
</code></pre></div>
<h6 id="bedrock_agentcore.memory.MemorySessionManager.list_events--get-events-with-event-metadata-filter-specific-branch-filter">Get events with event metadata filter + specific branch filter<a class="headerlink" href="#bedrock_agentcore.memory.MemorySessionManager.list_events--get-events-with-event-metadata-filter-specific-branch-filter" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>branch_with_metadata_filtered_events = client.list_events(
    actor_id=actor_id,
    session_id=session_id,
    branch_name=&quot;test-branch&quot;,
    eventMetadata=[
        {
            &#39;left&#39;: {
                &#39;metadataKey&#39;: &#39;location&#39;
            },
            &#39;operator&#39;: &#39;EQUALS_TO&#39;,
            &#39;right&#39;: {
                &#39;metadataValue&#39;: {
                    &#39;stringValue&#39;: &#39;NYC&#39;
                }
            }
        }
    ]
)
</code></pre></div>
</details>

            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_events</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">branch_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">include_parent_branches</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">eventMetadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">EventMetadataFilter</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">include_payload</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all events in a session with pagination support.</span>

<span class="sd">    This method provides direct access to the raw events API, allowing developers</span>
<span class="sd">    to retrieve all events without the turn grouping logic of get_last_k_turns.</span>

<span class="sd">    Args:</span>
<span class="sd">        actor_id: Actor identifier</span>
<span class="sd">        session_id: Session identifier</span>
<span class="sd">        branch_name: Optional branch name to filter events (None for all branches)</span>
<span class="sd">        include_parent_branches: Whether to include parent branch events (only applies with branch_name)</span>
<span class="sd">        eventMetadata: Optional list of event metadata filters to apply</span>
<span class="sd">        max_results: Maximum number of events to return</span>
<span class="sd">        include_payload: Whether to include event payloads in response</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of event dictionaries in chronological order</span>

<span class="sd">    Example:</span>
<span class="sd">        # Get all events</span>
<span class="sd">        events = client.list_events(actor_id, session_id)</span>

<span class="sd">        # Get only main branch events</span>
<span class="sd">        main_events = client.list_events(actor_id, session_id, branch_name=&quot;main&quot;)</span>

<span class="sd">        # Get events from a specific branch</span>
<span class="sd">        branch_events = client.list_events(actor_id, session_id, branch_name=&quot;test-branch&quot;)</span>

<span class="sd">        #### Get events with event metadata filter</span>
<span class="sd">        ```</span>
<span class="sd">        filtered_events_with_metadata = client.list_events(</span>
<span class="sd">            actor_id=actor_id,</span>
<span class="sd">            session_id=session_id,</span>
<span class="sd">            eventMetadata=[</span>
<span class="sd">                {</span>
<span class="sd">                    &#39;left&#39;: {</span>
<span class="sd">                        &#39;metadataKey&#39;: &#39;location&#39;</span>
<span class="sd">                    },</span>
<span class="sd">                    &#39;operator&#39;: &#39;EQUALS_TO&#39;,</span>
<span class="sd">                    &#39;right&#39;: {</span>
<span class="sd">                        &#39;metadataValue&#39;: {</span>
<span class="sd">                            &#39;stringValue&#39;: &#39;NYC&#39;</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            ]</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>

<span class="sd">        #### Get events with event metadata filter + specific branch filter</span>
<span class="sd">        ```</span>
<span class="sd">        branch_with_metadata_filtered_events = client.list_events(</span>
<span class="sd">            actor_id=actor_id,</span>
<span class="sd">            session_id=session_id,</span>
<span class="sd">            branch_name=&quot;test-branch&quot;,</span>
<span class="sd">            eventMetadata=[</span>
<span class="sd">                {</span>
<span class="sd">                    &#39;left&#39;: {</span>
<span class="sd">                        &#39;metadataKey&#39;: &#39;location&#39;</span>
<span class="sd">                    },</span>
<span class="sd">                    &#39;operator&#39;: &#39;EQUALS_TO&#39;,</span>
<span class="sd">                    &#39;right&#39;: {</span>
<span class="sd">                        &#39;metadataValue&#39;: {</span>
<span class="sd">                            &#39;stringValue&#39;: &#39;NYC&#39;</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            ]</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">all_events</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Event</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">next_token</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">max_iterations</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Safety limit to prevent infinite loops</span>

        <span class="n">iteration_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_results</span> <span class="ow">and</span> <span class="n">iteration_count</span> <span class="o">&lt;</span> <span class="n">max_iterations</span><span class="p">:</span>
            <span class="n">iteration_count</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span>
                <span class="s2">&quot;actorId&quot;</span><span class="p">:</span> <span class="n">actor_id</span><span class="p">,</span>
                <span class="s2">&quot;sessionId&quot;</span><span class="p">:</span> <span class="n">session_id</span><span class="p">,</span>
                <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_results</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">)),</span>
                <span class="s2">&quot;includePayloads&quot;</span><span class="p">:</span> <span class="n">include_payload</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">next_token</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nextToken&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_token</span>

            <span class="c1"># Add branch filter if specified (but not for &quot;main&quot;)</span>
            <span class="k">if</span> <span class="n">branch_name</span> <span class="ow">and</span> <span class="n">branch_name</span> <span class="o">!=</span> <span class="s2">&quot;main&quot;</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;branch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">branch_name</span><span class="p">,</span> <span class="s2">&quot;includeParentBranches&quot;</span><span class="p">:</span> <span class="n">include_parent_branches</span><span class="p">}</span>
                <span class="p">}</span>

            <span class="c1"># Add eventMetadata filter if specified</span>
            <span class="k">if</span> <span class="n">eventMetadata</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;eventMetadata&quot;</span><span class="p">:</span> <span class="n">eventMetadata</span><span class="p">}</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">list_events</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

            <span class="n">events</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="p">[])</span>

            <span class="c1"># If no events returned, break to prevent infinite loop</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No more events returned, ending pagination&quot;</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="n">all_events</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">Event</span><span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">])</span>

            <span class="n">next_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nextToken&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">next_token</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">max_results</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">iteration_count</span> <span class="o">&gt;=</span> <span class="n">max_iterations</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Reached maximum iteration limit (</span><span class="si">%d</span><span class="s2">) in list_events pagination&quot;</span><span class="p">,</span> <span class="n">max_iterations</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieved total of </span><span class="si">%d</span><span class="s2"> events&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_events</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">all_events</span><span class="p">[:</span><span class="n">max_results</span><span class="p">]</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to list events: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.list_long_term_memory_records" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_long_term_memory_records</span><span class="p">(</span><span class="n">namespace_prefix</span><span class="p">,</span> <span class="n">strategy_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.list_long_term_memory_records" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Lists all long-term memory records for this actor without a semantic query.</p>
<p>Maps to: bedrock-agentcore.list_memory_records.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_long_term_memory_records</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">namespace_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">strategy_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MemoryRecord</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lists all long-term memory records for this actor without a semantic query.</span>

<span class="sd">    Maps to: bedrock-agentcore.list_memory_records.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  -&gt; Listing all long-term records in namespace &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span><span class="p">,</span> <span class="n">namespace_prefix</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">paginator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s2">&quot;list_memory_records&quot;</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span>
            <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="n">namespace_prefix</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">strategy_id</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;memoryStrategyId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy_id</span>

        <span class="n">pages</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">all_records</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MemoryRecord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pages</span><span class="p">:</span>
            <span class="n">memory_records</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryRecords&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="c1"># Also check for memoryRecordSummaries (which is what the API actually returns)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">memory_records</span><span class="p">:</span>
                <span class="n">memory_records</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryRecordSummaries&quot;</span><span class="p">,</span> <span class="p">[])</span>

            <span class="n">all_records</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">MemoryRecord</span><span class="p">(</span><span class="n">record</span><span class="p">)</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">memory_records</span><span class="p">])</span>

            <span class="c1"># Stop if we&#39;ve reached max_results</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_records</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">max_results</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;     ✅ Found a total of </span><span class="si">%d</span><span class="s2"> long-term records.&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_records</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">all_records</span><span class="p">[:</span><span class="n">max_results</span><span class="p">]</span>

    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;     ❌ Error listing long-term records: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.process_turn_with_llm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_turn_with_llm</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">user_input</span><span class="p">,</span> <span class="n">llm_callback</span><span class="p">,</span> <span class="n">retrieval_config</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.process_turn_with_llm" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Complete conversation turn with LLM callback integration.</p>
<p>This method combines memory retrieval, LLM invocation, and response storage
in a single call using a callback pattern.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>actor_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Actor identifier (e.g., "user-123")</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>user_input</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The user's message</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>llm_callback</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]], <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function that takes (user_input, memories) and returns agent_response
         The callback receives the user input and retrieved memories,
         and should return the agent's response string</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>retrieval_config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="bedrock_agentcore.memory.constants.RetrievalConfig">RetrievalConfig</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dictionary mapping namespaces to RetrievalConfig objects.
            Each namespace can contain template variables like {actorId}, {sessionId},
            {memoryStrategyId} that will be resolved at runtime.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="bedrock_agentcore.memory.models.MetadataValue">MetadataValue</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom key-value metadata to attach to an event.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_timestamp</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="datetime.datetime">datetime</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional timestamp for the event</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]], <span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (retrieved_memories, agent_response, created_event)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>from bedrock_agentcore.memory.constants import RetrievalConfig</p>
<p>def my_llm(user_input: str, memories: List[Dict]) -&gt; str:
    # Format context from memories
    context = "\n".join([m.get('content', {}).get('text', '') for m in memories])</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Call your LLM (Bedrock, OpenAI, etc.)</span>
<span class="n">response</span> = <span class="n">bedrock</span>.<span class="n">invoke_model</span>(
    <span class="n">messages</span>=[
        {<span class="s">&quot;role&quot;</span>: <span class="s">&quot;system&quot;</span>, <span class="s">&quot;content&quot;</span>: <span class="nb">f</span><span class="s">&quot;Context: {context}&quot;</span>},
        {<span class="s">&quot;role&quot;</span>: <span class="s">&quot;user&quot;</span>, <span class="s">&quot;content&quot;</span>: <span class="n">user_input</span>}
    ]
)
<span class="k">return</span> <span class="n">response</span>[<span class="s">&#39;content&#39;</span>]
</code></pre></div>

<p>retrieval_config = {
    "support/facts/{sessionId}": RetrievalConfig(top_k=5, relevance_score=0.3),
    "user/preferences/{actorId}": RetrievalConfig(top_k=3, relevance_score=0.5)
}</p>
<p>memories, response, event = manager.process_turn_with_llm(
    actor_id="user-123",
    session_id="session-456",
    user_input="What did we discuss yesterday?",
    llm_callback=my_llm,
    retrieval_config=retrieval_config
)</p>
</details>

            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_turn_with_llm</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">llm_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">retrieval_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RetrievalConfig</span><span class="p">]],</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Complete conversation turn with LLM callback integration.</span>

<span class="sd">    This method combines memory retrieval, LLM invocation, and response storage</span>
<span class="sd">    in a single call using a callback pattern.</span>

<span class="sd">    Args:</span>
<span class="sd">        actor_id: Actor identifier (e.g., &quot;user-123&quot;)</span>
<span class="sd">        session_id: Session identifier</span>
<span class="sd">        user_input: The user&#39;s message</span>
<span class="sd">        llm_callback: Function that takes (user_input, memories) and returns agent_response</span>
<span class="sd">                     The callback receives the user input and retrieved memories,</span>
<span class="sd">                     and should return the agent&#39;s response string</span>
<span class="sd">        retrieval_config: Optional dictionary mapping namespaces to RetrievalConfig objects.</span>
<span class="sd">                        Each namespace can contain template variables like {actorId}, {sessionId},</span>
<span class="sd">                        {memoryStrategyId} that will be resolved at runtime.</span>
<span class="sd">        metadata: Optional custom key-value metadata to attach to an event.</span>
<span class="sd">        event_timestamp: Optional timestamp for the event</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (retrieved_memories, agent_response, created_event)</span>

<span class="sd">    Example:</span>
<span class="sd">        from bedrock_agentcore.memory.constants import RetrievalConfig</span>

<span class="sd">        def my_llm(user_input: str, memories: List[Dict]) -&gt; str:</span>
<span class="sd">            # Format context from memories</span>
<span class="sd">            context = &quot;\\n&quot;.join([m.get(&#39;content&#39;, {}).get(&#39;text&#39;, &#39;&#39;) for m in memories])</span>

<span class="sd">            # Call your LLM (Bedrock, OpenAI, etc.)</span>
<span class="sd">            response = bedrock.invoke_model(</span>
<span class="sd">                messages=[</span>
<span class="sd">                    {&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: f&quot;Context: {context}&quot;},</span>
<span class="sd">                    {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: user_input}</span>
<span class="sd">                ]</span>
<span class="sd">            )</span>
<span class="sd">            return response[&#39;content&#39;]</span>

<span class="sd">        retrieval_config = {</span>
<span class="sd">            &quot;support/facts/{sessionId}&quot;: RetrievalConfig(top_k=5, relevance_score=0.3),</span>
<span class="sd">            &quot;user/preferences/{actorId}&quot;: RetrievalConfig(top_k=3, relevance_score=0.5)</span>
<span class="sd">        }</span>

<span class="sd">        memories, response, event = manager.process_turn_with_llm(</span>
<span class="sd">            actor_id=&quot;user-123&quot;,</span>
<span class="sd">            session_id=&quot;session-456&quot;,</span>
<span class="sd">            user_input=&quot;What did we discuss yesterday?&quot;,</span>
<span class="sd">            llm_callback=my_llm,</span>
<span class="sd">            retrieval_config=retrieval_config</span>
<span class="sd">        )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Step 1: Retrieve relevant memories</span>
    <span class="n">retrieved_memories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_retrieve_memories_for_llm</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">user_input</span><span class="p">,</span> <span class="n">retrieval_config</span><span class="p">)</span>

    <span class="c1"># Step 2: Invoke LLM callback</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">agent_response</span> <span class="o">=</span> <span class="n">llm_callback</span><span class="p">(</span><span class="n">user_input</span><span class="p">,</span> <span class="n">retrieved_memories</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agent_response</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;LLM callback must return a string response&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;LLM callback generated response&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;LLM callback failed: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>

    <span class="c1"># Step 3: Save the conversation turn</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_conversation_turn</span><span class="p">(</span>
        <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">user_input</span><span class="p">,</span> <span class="n">agent_response</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">event_timestamp</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">retrieved_memories</span><span class="p">,</span> <span class="n">agent_response</span><span class="p">,</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.process_turn_with_llm_async" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_turn_with_llm_async</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">user_input</span><span class="p">,</span> <span class="n">llm_callback</span><span class="p">,</span> <span class="n">retrieval_config</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#bedrock_agentcore.memory.MemorySessionManager.process_turn_with_llm_async" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Complete conversation turn with async LLM callback integration.</p>
<p>This method combines memory retrieval, LLM invocation, and response storage
in a single call using an async callback pattern.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>actor_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Actor identifier (e.g., "user-123")</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>user_input</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The user's message</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>llm_callback</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]], <span title="typing.Awaitable">Awaitable</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Async function that takes (user_input, memories) and returns agent_response.
         The callback receives the user input and retrieved memories,
         and should return the agent's response string</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>retrieval_config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="bedrock_agentcore.memory.constants.RetrievalConfig">RetrievalConfig</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dictionary mapping namespaces to RetrievalConfig objects.
            Each namespace can contain template variables like {actorId}, {sessionId},
            {memoryStrategyId} that will be resolved at runtime.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="bedrock_agentcore.memory.models.MetadataValue">MetadataValue</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional custom key-value metadata to attach to an event.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_timestamp</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="datetime.datetime">datetime</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional timestamp for the event</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]], <span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (retrieved_memories, agent_response, created_event)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_turn_with_llm_async</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">actor_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">user_input</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">llm_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="n">Awaitable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">retrieval_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RetrievalConfig</span><span class="p">]],</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MetadataValue</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Complete conversation turn with async LLM callback integration.</span>

<span class="sd">    This method combines memory retrieval, LLM invocation, and response storage</span>
<span class="sd">    in a single call using an async callback pattern.</span>

<span class="sd">    Args:</span>
<span class="sd">        actor_id: Actor identifier (e.g., &quot;user-123&quot;)</span>
<span class="sd">        session_id: Session identifier</span>
<span class="sd">        user_input: The user&#39;s message</span>
<span class="sd">        llm_callback: Async function that takes (user_input, memories) and returns agent_response.</span>
<span class="sd">                     The callback receives the user input and retrieved memories,</span>
<span class="sd">                     and should return the agent&#39;s response string</span>
<span class="sd">        retrieval_config: Optional dictionary mapping namespaces to RetrievalConfig objects.</span>
<span class="sd">                        Each namespace can contain template variables like {actorId}, {sessionId},</span>
<span class="sd">                        {memoryStrategyId} that will be resolved at runtime.</span>
<span class="sd">        metadata: Optional custom key-value metadata to attach to an event.</span>
<span class="sd">        event_timestamp: Optional timestamp for the event</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (retrieved_memories, agent_response, created_event)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Step 1: Retrieve relevant memories</span>
    <span class="n">retrieved_memories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_retrieve_memories_for_llm</span><span class="p">(</span><span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">user_input</span><span class="p">,</span> <span class="n">retrieval_config</span><span class="p">)</span>

    <span class="c1"># Step 2: Invoke async LLM callback</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">agent_response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">llm_callback</span><span class="p">(</span><span class="n">user_input</span><span class="p">,</span> <span class="n">retrieved_memories</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agent_response</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;LLM callback must return a string response&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;LLM callback generated response&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;LLM callback failed: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>

    <span class="c1"># Step 3: Save the conversation turn</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_conversation_turn</span><span class="p">(</span>
        <span class="n">actor_id</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">user_input</span><span class="p">,</span> <span class="n">agent_response</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">event_timestamp</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">retrieved_memories</span><span class="p">,</span> <span class="n">agent_response</span><span class="p">,</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="bedrock_agentcore.memory.MemorySessionManager.search_long_term_memories" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">search_long_term_memories</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">namespace_prefix</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">strategy_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code>

<a href="#bedrock_agentcore.memory.MemorySessionManager.search_long_term_memories" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Performs a semantic search against the long-term memory for this actor.</p>
<p>Maps to: bedrock-agentcore.retrieve_memory_records.</p>


            <details class="quote">
              <summary>Source code in <code>bedrock_agentcore/memory/session.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">search_long_term_memories</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">namespace_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">top_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MemoryRecord</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs a semantic search against the long-term memory for this actor.</span>

<span class="sd">    Maps to: bedrock-agentcore.retrieve_memory_records.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;  -&gt; Querying long-term memory in namespace &#39;</span><span class="si">%s</span><span class="s2">&#39; with query: &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span><span class="p">,</span> <span class="n">namespace_prefix</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
    <span class="n">search_criteria</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;searchQuery&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span> <span class="s2">&quot;topK&quot;</span><span class="p">:</span> <span class="n">top_k</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">strategy_id</span><span class="p">:</span>
        <span class="n">search_criteria</span><span class="p">[</span><span class="s2">&quot;strategyId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy_id</span>

    <span class="n">namespace</span> <span class="o">=</span> <span class="n">namespace_prefix</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;memoryId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_memory_id</span><span class="p">,</span>
        <span class="s2">&quot;searchCriteria&quot;</span><span class="p">:</span> <span class="n">search_criteria</span><span class="p">,</span>
        <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="n">namespace</span><span class="p">,</span>
        <span class="s2">&quot;maxResults&quot;</span><span class="p">:</span> <span class="n">max_results</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_plane_client</span><span class="o">.</span><span class="n">retrieve_memory_records</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">records</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memoryRecordSummaries&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;     ✅ Found </span><span class="si">%d</span><span class="s2"> relevant long-term records.&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">MemoryRecord</span><span class="p">(</span><span class="n">record</span><span class="p">)</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">]</span>
    <span class="k">except</span> <span class="n">ClientError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;     ❌ Error querying long-term memory&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.select", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "search.highlight", "content.code.copy"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>