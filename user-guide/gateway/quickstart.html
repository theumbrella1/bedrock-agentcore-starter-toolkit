
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
      <meta name="description" content="Documentation for Amazon Bedrock AgentCore, primitives for building and running AI agents">
    
    
    
      <link rel="canonical" href="https://aws.github.io/bedrock-agentcore-starter-toolkit/user-guide/gateway/quickstart.html">
    
    
      <link rel="prev" href="../runtime/a2a.html">
    
    
      <link rel="next" href="../memory/quickstart.html">
    
    
    <link rel="icon" href="../.." sizes="any">
    <link rel="icon" href="../../assets/images/favicon.png" type="image/svg+xml">
    <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">

    
      
        <title>Gateway Quickstart - Amazon Bedrock AgentCore</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../../assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quickstart-a-fully-managed-mcp-server-in-5-minutes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Amazon Bedrock AgentCore" class="md-header__button md-logo" aria-label="Amazon Bedrock AgentCore" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Amazon Bedrock AgentCore
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Gateway Quickstart
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aws/bedrock-agentcore-starter-toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../index.html" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples/index.html" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://github.com/aws/bedrock-agentcore-sdk-python/blob/main/CONTRIBUTING.md" class="md-tabs__link">
        
  
  
    
  
  Contribute ‚ù§Ô∏è

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api-reference/runtime.html" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Amazon Bedrock AgentCore" class="md-nav__button md-logo" aria-label="Amazon Bedrock AgentCore" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Amazon Bedrock AgentCore
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aws/bedrock-agentcore-starter-toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Runtime
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Runtime
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/permissions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Permissions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/async.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Async Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/notebook.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Notebook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/a2a.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime A2A Server Deployment
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" checked>
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Gateway
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Gateway
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Gateway Quickstart
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="quickstart.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Gateway Quickstart
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-setup-and-install" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Setup and Install
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-create-gateway-setup-script" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Create Gateway Setup Script
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Create Gateway Setup Script">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-the-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Run the Setup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-using-the-gateway-with-an-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Using the Gateway with an Agent
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3: Using the Gateway with an Agent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-your-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Run Your Agent
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-youve-built" class="md-nav__link">
    <span class="md-ellipsis">
      What You‚Äôve Built
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#congratulations-you-successfully-built-an-agent-with-mcp-tools-powered-by-agentcore-gateway" class="md-nav__link">
    <span class="md-ellipsis">
      ü•≥ü•≥ü•≥ Congratulations - you successfully built an agent with MCP tools powered by AgentCore Gateway!
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Validation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      Cleanup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cleanup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-lambda-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Lambda Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-your-own-apis" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Your Own APIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding Your Own APIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nasa-api-integration" class="md-nav__link">
    <span class="md-ellipsis">
      NASA API Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-openapi-targets" class="md-nav__link">
    <span class="md-ellipsis">
      Adding OpenAPI Targets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-smithy-api-model-targets" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Smithy API Model Targets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Memory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            Memory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memory/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Identity
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            Identity
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../identity/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Identity Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" >
        
          
          <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Built-in Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            Built-in Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../builtin-tools/quickstart-browser.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart Browser Tool
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../builtin-tools/quickstart-code-interpreter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart Code Interpreter
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7" >
        
          
          <label class="md-nav__link" for="__nav_1_7" id="__nav_1_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/vpc-interface-endpoints.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VPC Interface Endpoints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/agentcore-vpc.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AgentCore VPC Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/security-vpc-condition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VPC Condition Keys
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8" >
        
          
          <label class="md-nav__link" for="__nav_1_8" id="__nav_1_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Observability
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_8">
            <span class="md-nav__icon md-icon"></span>
            Observability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Observability Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9" >
        
          
          <label class="md-nav__link" for="__nav_1_9" id="__nav_1_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Import Agent
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9">
            <span class="md-nav__icon md-icon"></span>
            Import Agent
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../import-agent/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Import Agent Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../import-agent/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Import Agent Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../import-agent/configuration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Import Agent Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/agentcore-quickstart-example.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Transform and Deploy Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/session-management.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Session Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/async-processing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Async Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/gateway-integration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gateway Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/memory_gateway_agent.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory Gateway Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/runtime-framework-agents.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Framework Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/semantic_search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Semantic Search
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/aws/bedrock-agentcore-sdk-python/blob/main/CONTRIBUTING.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contribute ‚ù§Ô∏è
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Bedrock AgentCore SDK
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Bedrock AgentCore SDK
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/runtime.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/identity.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Identity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/memory.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/tools.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Built-in Tools
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Bedrock AgentCore Starter Toolkit
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Bedrock AgentCore Starter Toolkit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/cli.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AgentCore CLI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-setup-and-install" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Setup and Install
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-create-gateway-setup-script" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Create Gateway Setup Script
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Create Gateway Setup Script">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-the-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Run the Setup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-using-the-gateway-with-an-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Using the Gateway with an Agent
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3: Using the Gateway with an Agent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-your-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Run Your Agent
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-youve-built" class="md-nav__link">
    <span class="md-ellipsis">
      What You‚Äôve Built
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#congratulations-you-successfully-built-an-agent-with-mcp-tools-powered-by-agentcore-gateway" class="md-nav__link">
    <span class="md-ellipsis">
      ü•≥ü•≥ü•≥ Congratulations - you successfully built an agent with MCP tools powered by AgentCore Gateway!
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Validation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      Cleanup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cleanup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-lambda-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Lambda Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-your-own-apis" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Your Own APIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding Your Own APIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nasa-api-integration" class="md-nav__link">
    <span class="md-ellipsis">
      NASA API Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-openapi-targets" class="md-nav__link">
    <span class="md-ellipsis">
      Adding OpenAPI Targets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-smithy-api-model-targets" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Smithy API Model Targets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="quickstart-a-fully-managed-mcp-server-in-5-minutes">QuickStart: A Fully Managed MCP Server in 5 Minutes! üöÄ<a class="headerlink" href="#quickstart-a-fully-managed-mcp-server-in-5-minutes" title="Permanent link">&para;</a></h1>
<p>Amazon Bedrock AgentCore Gateway provides an easy and secure way for developers to build, deploy, discover, and connect to tools at scale. AI agents need tools to perform real-world tasks‚Äîfrom querying databases to sending messages to analyzing documents. With Gateway, developers can convert APIs, Lambda functions, and existing services into Model Context Protocol (MCP)-compatible tools and make them available to agents through Gateway endpoints with just a few lines of code. Gateway supports OpenAPI, Smithy, and Lambda as input types, and is the only solution that provides both comprehensive ingress authentication and egress authentication in a fully-managed service. Gateway eliminates weeks of custom code development, infrastructure provisioning, and security implementation so developers can focus on building innovative agent applications.</p>
<p>In this quick start guide you will learn how to set up a Gateway and integrate it into your agents using the AgentCore Starter Toolkit. You can find more comprehensive guides and examples <a href="https://github.com/awslabs/amazon-bedrock-agentcore-samples/tree/main/01-tutorials/02-AgentCore-gateway"><strong>here</strong></a>.</p>
<p><strong>Note: The AgentCore Starter Toolkit is intended to help developers get started quickly. The Boto3 Python library provides the most comprehensive set of operations for Gateways and Targets. You can find the Boto3 documentation <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/bedrock-agentcore-control.html">here</a>. For complete documentation see the <a href="https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/gateway.html"><strong>developer guide</strong></a></strong></p>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p>Before starting, make sure you have:</p>
<ul>
<li><strong>AWS Account</strong> with credentials configured (<code>aws configure</code>)</li>
<li><strong>Python 3.10+</strong> installed</li>
<li><strong>IAM Permissions</strong> for creating roles, Lambda functions, and using Bedrock AgentCore</li>
<li><strong>Model Access</strong> - Enable Anthropic‚Äôs Claude Sonnet 3.7 in the Bedrock console (or another model for the demo agent)</li>
</ul>
<h2 id="step-1-setup-and-install">Step 1: Setup and Install<a class="headerlink" href="#step-1-setup-and-install" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>agentcore-gateway-quickstart
<span class="nb">cd</span><span class="w"> </span>agentcore-gateway-quickstart
python3<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>.venv
<span class="nb">source</span><span class="w"> </span>.venv/bin/activate<span class="w">  </span><span class="c1"># On Windows: .venv\Scripts\activate</span>
</code></pre></div>
<p><strong>Install Dependencies</strong></p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>boto3
pip<span class="w"> </span>install<span class="w"> </span>bedrock-agentcore-starter-toolkit
pip<span class="w"> </span>install<span class="w"> </span>strands-agents
</code></pre></div>
<h2 id="step-2-create-gateway-setup-script">Step 2: Create Gateway Setup Script<a class="headerlink" href="#step-2-create-gateway-setup-script" title="Permanent link">&para;</a></h2>
<p>Create a new file called <code>setup_gateway.py</code> with the following complete code.</p>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Setup script to create Gateway with Lambda target and save configuration</span>
<span class="sd">Run this first: python setup_gateway.py</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">bedrock_agentcore_starter_toolkit.operations.gateway.client</span><span class="w"> </span><span class="kn">import</span> <span class="n">GatewayClient</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="k">def</span><span class="w"> </span><span class="nf">setup_gateway</span><span class="p">():</span>
    <span class="c1"># Configuration</span>
    <span class="n">region</span> <span class="o">=</span> <span class="s2">&quot;us-east-1&quot;</span>  <span class="c1"># Change to your preferred region</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üöÄ Setting up AgentCore Gateway...&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Region: </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Initialize client</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">GatewayClient</span><span class="p">(</span><span class="n">region_name</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="c1"># Step 2.1: Create OAuth authorizer</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 2.1: Creating OAuth authorization server...&quot;</span><span class="p">)</span>
    <span class="n">cognito_response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_oauth_authorizer_with_cognito</span><span class="p">(</span><span class="s2">&quot;TestGateway&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úì Authorization server created</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Step 2.2: Create Gateway</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 2.2: Creating Gateway...&quot;</span><span class="p">)</span>
    <span class="n">gateway</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_mcp_gateway</span><span class="p">(</span>
        <span class="c1"># the name of the Gateway - if you don&#39;t set one, one will be generated.</span>
        <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="c1"># the role arn that the Gateway will use - if you don&#39;t set one, one will be created.</span>
        <span class="c1"># NOTE: if you are using your own role make sure it has a trust policy that trusts bedrock-agentcore.amazonaws.com</span>
        <span class="n">role_arn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="c1"># the OAuth authorization server details. If you are providing your own authorization server,</span>
        <span class="c1"># then pass an input of the following form: {&quot;customJWTAuthorizer&quot;: {&quot;allowedClients&quot;: [&quot;&lt;INSERT CLIENT ID&gt;&quot;], &quot;discoveryUrl&quot;: &quot;&lt;INSERT DISCOVERY URL&quot;&gt;}}</span>
        <span class="n">authorizer_config</span><span class="o">=</span><span class="n">cognito_response</span><span class="p">[</span><span class="s2">&quot;authorizer_config&quot;</span><span class="p">],</span>
        <span class="c1"># enable semantic search</span>
        <span class="n">enable_semantic_search</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úì Gateway created: </span><span class="si">{</span><span class="n">gateway</span><span class="p">[</span><span class="s1">&#39;gatewayUrl&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># If role_arn was not provided, fix IAM permissions</span>
    <span class="c1"># NOTE: This is handled internally by the toolkit when no role is provided</span>
    <span class="n">client</span><span class="o">.</span><span class="n">fix_iam_permissions</span><span class="p">(</span><span class="n">gateway</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚è≥ Waiting 30s for IAM propagation...&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úì IAM permissions configured</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Step 2.3: Add Lambda target</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 2.3: Adding Lambda target...&quot;</span><span class="p">)</span>
    <span class="n">lambda_target</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_mcp_gateway_target</span><span class="p">(</span>
        <span class="c1"># the gateway created in the previous step</span>
        <span class="n">gateway</span><span class="o">=</span><span class="n">gateway</span><span class="p">,</span>
        <span class="c1"># the name of the Target - if you don&#39;t set one, one will be generated.</span>
        <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="c1"># the type of the Target</span>
        <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;lambda&quot;</span><span class="p">,</span>
        <span class="c1"># the target details - set this to define your own lambda if you pre-created one.</span>
        <span class="c1"># Otherwise leave this None and one will be created for you.</span>
        <span class="n">target_payload</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="c1"># you will see later in the tutorial how to use this to connect to APIs using API keys and OAuth credentials.</span>
        <span class="n">credentials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úì Lambda target added</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Step 2.4: Save configuration for agent</span>
    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;gateway_url&quot;</span><span class="p">:</span> <span class="n">gateway</span><span class="p">[</span><span class="s2">&quot;gatewayUrl&quot;</span><span class="p">],</span>
        <span class="s2">&quot;gateway_id&quot;</span><span class="p">:</span> <span class="n">gateway</span><span class="p">[</span><span class="s2">&quot;gatewayId&quot;</span><span class="p">],</span>
        <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
        <span class="s2">&quot;client_info&quot;</span><span class="p">:</span> <span class="n">cognito_response</span><span class="p">[</span><span class="s2">&quot;client_info&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;gateway_config.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ Gateway setup complete!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gateway URL: </span><span class="si">{</span><span class="n">gateway</span><span class="p">[</span><span class="s1">&#39;gatewayUrl&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gateway ID: </span><span class="si">{</span><span class="n">gateway</span><span class="p">[</span><span class="s1">&#39;gatewayId&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Configuration saved to: gateway_config.json&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Next step: Run &#39;python run_agent.py&#39; to test your Gateway&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">config</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">setup_gateway</span><span class="p">()</span>
</code></pre></div>
<p>See below for step-by-step understanding of each component.</p>
<details>
<summary>
<strong>üìö Understanding the Setup Script - Step by Step Explanation</strong>
</summary>

#### Import Required Libraries

First, import the necessary libraries for gateway creation and configuration.

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">bedrock_agentcore_starter_toolkit.operations.gateway.client</span><span class="w"> </span><span class="kn">import</span> <span class="n">GatewayClient</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</code></pre></div>

#### Create the Setup Function

Initialize the setup function with your AWS region configuration.

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">setup_gateway</span><span class="p">():</span>
    <span class="c1"># Configuration</span>
    <span class="n">region</span> <span class="o">=</span> <span class="s2">&quot;us-east-1&quot;</span>  <span class="c1"># Change to your preferred region</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üöÄ Setting up AgentCore Gateway...&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Region: </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Initialize client</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">GatewayClient</span><span class="p">(</span><span class="n">region_name</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
    <span class="n">client</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</code></pre></div>

### Step 2.1: Creating an OAuth Authorization Server

üîë Gateways are secured by OAuth authorization servers which ensure that only allowed users can access your Gateway. Let‚Äôs create an OAuth authorization server using Amazon Cognito.

<div class="highlight"><pre><span></span><code>    <span class="c1"># Step 2.1: Create OAuth authorizer</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 2.1: Creating OAuth authorization server...&quot;</span><span class="p">)</span>
    <span class="n">cognito_response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_oauth_authorizer_with_cognito</span><span class="p">(</span><span class="s2">&quot;TestGateway&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úì Authorization server created</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

**What happens here**: This creates a Cognito user pool with OAuth 2.0 client credentials flow configured. You‚Äôll get a client ID and secret that can be used to obtain access tokens.

### Step 2.2: Creating a Gateway

üåâ Now, let‚Äôs create a Gateway. The Gateway acts as your MCP server endpoint that agents will connect to.

<div class="highlight"><pre><span></span><code>    <span class="c1"># Step 2.2: Create Gateway</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 2.2: Creating Gateway...&quot;</span><span class="p">)</span>
    <span class="n">gateway</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_mcp_gateway</span><span class="p">(</span>
        <span class="c1"># the name of the Gateway - if you don&#39;t set one, one will be generated.</span>
        <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="c1"># the role arn that the Gateway will use - if you don&#39;t set one, one will be created.</span>
        <span class="c1"># NOTE: if you are using your own role make sure it has a trust policy that trusts bedrock-agentcore.amazonaws.com</span>
        <span class="n">role_arn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="c1"># the OAuth authorization server details. If you are providing your own authorization server,</span>
        <span class="c1"># then pass an input of the following form: {&quot;customJWTAuthorizer&quot;: {&quot;allowedClients&quot;: [&quot;&lt;INSERT CLIENT ID&gt;&quot;], &quot;discoveryUrl&quot;: &quot;&lt;INSERT DISCOVERY URL&quot;&gt;}}</span>
        <span class="n">authorizer_config</span><span class="o">=</span><span class="n">cognito_response</span><span class="p">[</span><span class="s2">&quot;authorizer_config&quot;</span><span class="p">],</span>
        <span class="c1"># enable semantic search</span>
        <span class="n">enable_semantic_search</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úì Gateway created: </span><span class="si">{</span><span class="n">gateway</span><span class="p">[</span><span class="s1">&#39;gatewayUrl&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># If role_arn was not provided, fix IAM permissions</span>
    <span class="c1"># NOTE: This is handled internally by the toolkit when no role is provided</span>
    <span class="n">client</span><span class="o">.</span><span class="n">fix_iam_permissions</span><span class="p">(</span><span class="n">gateway</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚è≥ Waiting 30s for IAM propagation...&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úì IAM permissions configured</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

**What happens here**: Creates a Gateway with MCP protocol support, configures OAuth authorization, and enables semantic search for tool discovery. If you don‚Äôt provide a role, one is created and configured automatically.

### Step 2.3: Adding Lambda Targets

üõ†Ô∏è Let‚Äôs add a Lambda function target. This code will automatically create a Lambda function with weather and time tools.

<div class="highlight"><pre><span></span><code>    <span class="c1"># Step 2.3: Add Lambda target</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 2.3: Adding Lambda target...&quot;</span><span class="p">)</span>
    <span class="n">lambda_target</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_mcp_gateway_target</span><span class="p">(</span>
        <span class="c1"># the gateway created in the previous step</span>
        <span class="n">gateway</span><span class="o">=</span><span class="n">gateway</span><span class="p">,</span>
        <span class="c1"># the name of the Target - if you don&#39;t set one, one will be generated.</span>
        <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="c1"># the type of the Target</span>
        <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;lambda&quot;</span><span class="p">,</span>
        <span class="c1"># the target details - set this to define your own lambda if you pre-created one.</span>
        <span class="c1"># Otherwise leave this None and one will be created for you.</span>
        <span class="n">target_payload</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="c1"># you will see later in the tutorial how to use this to connect to APIs using API keys and OAuth credentials.</span>
        <span class="n">credentials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úì Lambda target added</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

**What happens here**: Creates a test Lambda function with two tools (get_weather and get_time) and registers it as a target in your Gateway.

### Step 2.4: Save Configuration

Save the gateway configuration to a file for use by the agent.

<div class="highlight"><pre><span></span><code>    <span class="c1"># Step 2.4: Save configuration for agent</span>
    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;gateway_url&quot;</span><span class="p">:</span> <span class="n">gateway</span><span class="p">[</span><span class="s2">&quot;gatewayUrl&quot;</span><span class="p">],</span>
        <span class="s2">&quot;gateway_id&quot;</span><span class="p">:</span> <span class="n">gateway</span><span class="p">[</span><span class="s2">&quot;gatewayId&quot;</span><span class="p">],</span>
        <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
        <span class="s2">&quot;client_info&quot;</span><span class="p">:</span> <span class="n">cognito_response</span><span class="p">[</span><span class="s2">&quot;client_info&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;gateway_config.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ Gateway setup complete!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gateway URL: </span><span class="si">{</span><span class="n">gateway</span><span class="p">[</span><span class="s1">&#39;gatewayUrl&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gateway ID: </span><span class="si">{</span><span class="n">gateway</span><span class="p">[</span><span class="s1">&#39;gatewayId&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Configuration saved to: gateway_config.json&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Next step: Run &#39;python run_agent.py&#39; to test your Gateway&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">config</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">setup_gateway</span><span class="p">()</span>
</code></pre></div>

</details>

<h3 id="run-the-setup">Run the Setup<a class="headerlink" href="#run-the-setup" title="Permanent link">&para;</a></h3>
<p>Execute the setup script to create your Gateway and Lambda target.</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>setup_gateway.py
</code></pre></div>
<p><strong>What to expect</strong>: The script will take about 2-3 minutes to complete. You‚Äôll see progress messages for each step.</p>
<h2 id="step-3-using-the-gateway-with-an-agent">Step 3: Using the Gateway with an Agent<a class="headerlink" href="#step-3-using-the-gateway-with-an-agent" title="Permanent link">&para;</a></h2>
<p>Create a new file called <code>run_agent.py</code> with the following code:</p>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Agent script to test the Gateway</span>
<span class="sd">Run this after setup: python run_agent.py</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">strands</span><span class="w"> </span><span class="kn">import</span> <span class="n">Agent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">strands.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">BedrockModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">strands.tools.mcp.mcp_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">MCPClient</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mcp.client.streamable_http</span><span class="w"> </span><span class="kn">import</span> <span class="n">streamablehttp_client</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bedrock_agentcore_starter_toolkit.operations.gateway.client</span><span class="w"> </span><span class="kn">import</span> <span class="n">GatewayClient</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_streamable_http_transport</span><span class="p">(</span><span class="n">mcp_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">access_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">streamablehttp_client</span><span class="p">(</span><span class="n">mcp_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_full_tools_list</span><span class="p">(</span><span class="n">client</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all tools with pagination support&quot;&quot;&quot;</span>
    <span class="n">more_tools</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">tools</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pagination_token</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">while</span> <span class="n">more_tools</span><span class="p">:</span>
        <span class="n">tmp_tools</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_tools_sync</span><span class="p">(</span><span class="n">pagination_token</span><span class="o">=</span><span class="n">pagination_token</span><span class="p">)</span>
        <span class="n">tools</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tmp_tools</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tmp_tools</span><span class="o">.</span><span class="n">pagination_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">more_tools</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">more_tools</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">pagination_token</span> <span class="o">=</span> <span class="n">tmp_tools</span><span class="o">.</span><span class="n">pagination_token</span>
    <span class="k">return</span> <span class="n">tools</span>

<span class="k">def</span><span class="w"> </span><span class="nf">run_agent</span><span class="p">():</span>
    <span class="c1"># Load configuration</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;gateway_config.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ùå Error: gateway_config.json not found!&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please run &#39;python setup_gateway.py&#39; first to create the Gateway.&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">gateway_url</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;gateway_url&quot;</span><span class="p">]</span>
    <span class="n">client_info</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;client_info&quot;</span><span class="p">]</span>

    <span class="c1"># Get access token for the agent</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Getting access token...&quot;</span><span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">GatewayClient</span><span class="p">(</span><span class="n">region_name</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">])</span>
    <span class="n">access_token</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_access_token_for_cognito</span><span class="p">(</span><span class="n">client_info</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úì Access token obtained</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Model configuration - change if needed</span>
    <span class="n">model_id</span> <span class="o">=</span> <span class="s2">&quot;anthropic.claude-3-7-sonnet-20250219-v1:0&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ü§ñ Starting AgentCore Gateway Test Agent&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gateway URL: </span><span class="si">{</span><span class="n">gateway_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model: </span><span class="si">{</span><span class="n">model_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="c1"># Setup Bedrock model</span>
    <span class="n">bedrockmodel</span> <span class="o">=</span> <span class="n">BedrockModel</span><span class="p">(</span>
        <span class="n">inference_profile_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span>
        <span class="n">streaming</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Setup MCP client</span>
    <span class="n">mcp_client</span> <span class="o">=</span> <span class="n">MCPClient</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">create_streamable_http_transport</span><span class="p">(</span><span class="n">gateway_url</span><span class="p">,</span> <span class="n">access_token</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">mcp_client</span><span class="p">:</span>
        <span class="c1"># List available tools</span>
        <span class="n">tools</span> <span class="o">=</span> <span class="n">get_full_tools_list</span><span class="p">(</span><span class="n">mcp_client</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìã Available tools: </span><span class="si">{</span><span class="p">[</span><span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">tool</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tools</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

        <span class="c1"># Create agent</span>
        <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">bedrockmodel</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">)</span>

        <span class="c1"># Interactive loop</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üí¨ Interactive Agent Ready!&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Try asking: &#39;What&#39;s the weather in Seattle?&#39;&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Type &#39;exit&#39;, &#39;quit&#39;, or &#39;bye&#39; to end.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">user_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;You: &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">user_input</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;exit&quot;</span><span class="p">,</span> <span class="s2">&quot;quit&quot;</span><span class="p">,</span> <span class="s2">&quot;bye&quot;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üëã Goodbye!&quot;</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ü§î Thinking...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">agent</span><span class="p">(</span><span class="n">user_input</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Agent: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">run_agent</span><span class="p">()</span>
</code></pre></div>
<h3 id="run-your-agent">Run Your Agent<a class="headerlink" href="#run-your-agent" title="Permanent link">&para;</a></h3>
<p>Test your Gateway by running the agent and interacting with the tools.</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>run_agent.py
</code></pre></div>
<p>That‚Äôs it! The agent will start and you can ask questions like:</p>
<ul>
<li>‚ÄúWhat‚Äôs the weather in Seattle?‚Äù</li>
<li>‚ÄúWhat time is it in New York?‚Äù</li>
</ul>
<h2 id="what-youve-built">What You‚Äôve Built<a class="headerlink" href="#what-youve-built" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>MCP Server (Gateway)</strong>: A managed endpoint at <code>https://gateway-id.gateway.bedrock-agentcore.region.amazonaws.com/mcp</code></li>
<li><strong>Lambda Tools</strong>: Mock functions that return test data (weather: ‚Äú72¬∞F, Sunny‚Äù, time: ‚Äú2:30 PM‚Äù)</li>
<li><strong>OAuth Authentication</strong>: Secure access using Cognito tokens</li>
<li><strong>AI Agent</strong>: Claude-powered assistant that can discover and use your tools</li>
</ul>
<hr />
<h2 id="congratulations-you-successfully-built-an-agent-with-mcp-tools-powered-by-agentcore-gateway"><strong>ü•≥ü•≥ü•≥ Congratulations - you successfully built an agent with MCP tools powered by AgentCore Gateway!</strong><a class="headerlink" href="#congratulations-you-successfully-built-an-agent-with-mcp-tools-powered-by-agentcore-gateway" title="Permanent link">&para;</a></h2>
<hr />
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Issue</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td>‚ÄúNo module named ‚Äòstrands‚Äô‚Äù</td>
<td>Run: <code>pip install strands-agents</code></td>
</tr>
<tr>
<td>‚ÄúModel not enabled‚Äù</td>
<td>Enable Claude Sonnet 3.7 in Bedrock console ‚Üí Model access</td>
</tr>
<tr>
<td>‚ÄúAccessDeniedException‚Äù</td>
<td>Check IAM permissions for <code>bedrock-agentcore:*</code></td>
</tr>
<tr>
<td>Gateway not responding</td>
<td>Wait 30-60 seconds after creation for DNS propagation</td>
</tr>
<tr>
<td>OAuth token expired</td>
<td>Tokens expire after 1 hour, get new one with <code>get_access_token_for_cognito()</code></td>
</tr>
</tbody>
</table>
<h2 id="quick-validation">Quick Validation<a class="headerlink" href="#quick-validation" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Check your Gateway is working</span>
curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>YOUR_GATEWAY_URL<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer YOUR_TOKEN&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1,&quot;method&quot;:&quot;tools/list&quot;,&quot;params&quot;:{}}&#39;</span>

<span class="c1"># Watch live logs</span>
aws<span class="w"> </span>logs<span class="w"> </span>tail<span class="w"> </span>/aws/bedrock-agentcore/gateways/YOUR_GATEWAY_ID<span class="w"> </span>--follow
</code></pre></div>
<h2 id="cleanup">Cleanup<a class="headerlink" href="#cleanup" title="Permanent link">&para;</a></h2>
<p>Create <code>cleanup_gateway.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">bedrock_agentcore_starter_toolkit.operations.gateway.client</span><span class="w"> </span><span class="kn">import</span> <span class="n">GatewayClient</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;gateway_config.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">GatewayClient</span><span class="p">(</span><span class="n">region_name</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">])</span>
<span class="n">client</span><span class="o">.</span><span class="n">cleanup_gateway</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gateway_id&quot;</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;client_info&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ Cleanup complete!&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Run: <code>python cleanup_gateway.py</code></p>
<h3 id="next-steps">Next Steps<a class="headerlink" href="#next-steps" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Custom Lambda Tools</strong>: Create Lambda functions with your business logic</li>
<li><strong>Add Your Own APIs</strong>: Extend your Gateway with OpenAPI specifications for real services</li>
<li><strong>Production Setup</strong>: Configure VPC endpoints, custom domains, and monitoring</li>
</ul>
<h2 id="custom-lambda-tools">Custom Lambda Tools<a class="headerlink" href="#custom-lambda-tools" title="Permanent link">&para;</a></h2>
<p>Create your own Lambda functions with custom business logic and add them as Gateway targets. Lambda targets allow you to implement any custom tool logic in Python, Node.js, or other supported runtimes.</p>
<details>
<summary>
<strong> ‚û°Ô∏è Creating Custom Lambda Tools</strong>
</summary>

Create a file `create_custom_lambda.py`:

<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Create a custom Lambda function and add it as a Gateway target&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zipfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bedrock_agentcore_starter_toolkit.operations.gateway.client</span><span class="w"> </span><span class="kn">import</span> <span class="n">GatewayClient</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_custom_lambda</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">gateway_role_arn</span><span class="p">):</span>
    <span class="n">lambda_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;lambda&#39;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
    <span class="n">iam</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;iam&#39;</span><span class="p">)</span>

    <span class="c1"># Lambda code</span>
    <span class="n">lambda_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">import json</span>

<span class="s1">def lambda_handler(event, context):</span>
<span class="s1">    tool_name = context.client_context.custom.get(&#39;bedrockAgentCoreToolName&#39;, &#39;unknown&#39;)</span>

<span class="s1">    if &#39;calculate_sum&#39; in tool_name:</span>
<span class="s1">        a = event.get(&#39;a&#39;, 0)</span>
<span class="s1">        b = event.get(&#39;b&#39;, 0)</span>
<span class="s1">        return {</span>
<span class="s1">            &#39;statusCode&#39;: 200,</span>
<span class="s1">            &#39;body&#39;: json.dumps({&#39;result&#39;: a + b})</span>
<span class="s1">        }</span>
<span class="s1">    elif &#39;multiply&#39; in tool_name:</span>
<span class="s1">        x = event.get(&#39;x&#39;, 0)</span>
<span class="s1">        y = event.get(&#39;y&#39;, 0)</span>
<span class="s1">        return {</span>
<span class="s1">            &#39;statusCode&#39;: 200,</span>
<span class="s1">            &#39;body&#39;: json.dumps({&#39;result&#39;: x * y})</span>
<span class="s1">        }</span>

<span class="s1">    return {&#39;statusCode&#39;: 200, &#39;body&#39;: json.dumps({&#39;error&#39;: &#39;Unknown tool&#39;})}</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="c1"># Create zip</span>
    <span class="n">zip_buffer</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">zip_buffer</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZIP_DEFLATED</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_file</span><span class="p">:</span>
        <span class="n">zip_file</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="s1">&#39;lambda_function.py&#39;</span><span class="p">,</span> <span class="n">lambda_code</span><span class="p">)</span>
    <span class="n">zip_buffer</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Create execution role</span>
    <span class="n">role_name</span> <span class="o">=</span> <span class="s1">&#39;CustomCalculatorLambdaRole&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">role</span> <span class="o">=</span> <span class="n">iam</span><span class="o">.</span><span class="n">create_role</span><span class="p">(</span>
            <span class="n">RoleName</span><span class="o">=</span><span class="n">role_name</span><span class="p">,</span>
            <span class="n">AssumeRolePolicyDocument</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span>
                <span class="s2">&quot;Version&quot;</span><span class="p">:</span> <span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Statement&quot;</span><span class="p">:</span> <span class="p">[{</span>
                    <span class="s2">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Principal&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Service&quot;</span><span class="p">:</span> <span class="s2">&quot;lambda.amazonaws.com&quot;</span><span class="p">},</span>
                    <span class="s2">&quot;Action&quot;</span><span class="p">:</span> <span class="s2">&quot;sts:AssumeRole&quot;</span>
                <span class="p">}]</span>
            <span class="p">})</span>
        <span class="p">)</span>
        <span class="n">iam</span><span class="o">.</span><span class="n">attach_role_policy</span><span class="p">(</span>
            <span class="n">RoleName</span><span class="o">=</span><span class="n">role_name</span><span class="p">,</span>
            <span class="n">PolicyArn</span><span class="o">=</span><span class="s1">&#39;arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole&#39;</span>
        <span class="p">)</span>
        <span class="n">role_arn</span> <span class="o">=</span> <span class="n">role</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">][</span><span class="s1">&#39;Arn&#39;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created Lambda execution role: </span><span class="si">{</span><span class="n">role_arn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">iam</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">EntityAlreadyExistsException</span><span class="p">:</span>
        <span class="n">role</span> <span class="o">=</span> <span class="n">iam</span><span class="o">.</span><span class="n">get_role</span><span class="p">(</span><span class="n">RoleName</span><span class="o">=</span><span class="n">role_name</span><span class="p">)</span>
        <span class="n">role_arn</span> <span class="o">=</span> <span class="n">role</span><span class="p">[</span><span class="s1">&#39;Role&#39;</span><span class="p">][</span><span class="s1">&#39;Arn&#39;</span><span class="p">]</span>

    <span class="c1"># Create Lambda</span>
    <span class="n">function_name</span> <span class="o">=</span> <span class="s1">&#39;CustomCalculatorFunction&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">lambda_client</span><span class="o">.</span><span class="n">create_function</span><span class="p">(</span>
            <span class="n">FunctionName</span><span class="o">=</span><span class="n">function_name</span><span class="p">,</span>
            <span class="n">Runtime</span><span class="o">=</span><span class="s1">&#39;python3.9&#39;</span><span class="p">,</span>
            <span class="n">Role</span><span class="o">=</span><span class="n">role_arn</span><span class="p">,</span>
            <span class="n">Handler</span><span class="o">=</span><span class="s1">&#39;lambda_function.lambda_handler&#39;</span><span class="p">,</span>
            <span class="n">Code</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ZipFile&#39;</span><span class="p">:</span> <span class="n">zip_buffer</span><span class="o">.</span><span class="n">read</span><span class="p">()},</span>
            <span class="n">Description</span><span class="o">=</span><span class="s1">&#39;Custom calculator for AgentCore Gateway&#39;</span>
        <span class="p">)</span>
        <span class="n">lambda_arn</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;FunctionArn&#39;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created Lambda: </span><span class="si">{</span><span class="n">lambda_arn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">lambda_client</span><span class="o">.</span><span class="n">add_permission</span><span class="p">(</span>
            <span class="n">FunctionName</span><span class="o">=</span><span class="n">function_name</span><span class="p">,</span>
            <span class="n">StatementId</span><span class="o">=</span><span class="s1">&#39;AllowAgentCoreInvoke&#39;</span><span class="p">,</span>
            <span class="n">Action</span><span class="o">=</span><span class="s1">&#39;lambda:InvokeFunction&#39;</span><span class="p">,</span>
            <span class="n">Principal</span><span class="o">=</span><span class="n">gateway_role_arn</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">lambda_client</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ResourceConflictException</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">lambda_client</span><span class="o">.</span><span class="n">get_function</span><span class="p">(</span><span class="n">FunctionName</span><span class="o">=</span><span class="n">function_name</span><span class="p">)</span>
        <span class="n">lambda_arn</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Configuration&#39;</span><span class="p">][</span><span class="s1">&#39;FunctionArn&#39;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lambda already exists: </span><span class="si">{</span><span class="n">lambda_arn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lambda_arn</span>

<span class="c1"># Main execution</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;gateway_config.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">GatewayClient</span><span class="p">(</span><span class="n">region_name</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">])</span>
<span class="n">gateway</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_gateway</span><span class="p">(</span><span class="n">gatewayIdentifier</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gateway_id&quot;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating custom Lambda function...&quot;</span><span class="p">)</span>
<span class="n">lambda_arn</span> <span class="o">=</span> <span class="n">create_custom_lambda</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">],</span> <span class="n">gateway</span><span class="p">[</span><span class="s2">&quot;roleArn&quot;</span><span class="p">])</span>

<span class="c1"># Add as target</span>
<span class="n">target_payload</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;lambdaArn&quot;</span><span class="p">:</span> <span class="n">lambda_arn</span><span class="p">,</span>
    <span class="s2">&quot;toolSchema&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;inlinePayload&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;calculate_sum&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Add two numbers&quot;</span><span class="p">,</span>
                <span class="s2">&quot;inputSchema&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;First number&quot;</span><span class="p">},</span>
                        <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Second number&quot;</span><span class="p">}</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;multiply&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Multiply two numbers&quot;</span><span class="p">,</span>
                <span class="s2">&quot;inputSchema&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;First number&quot;</span><span class="p">},</span>
                        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Second number&quot;</span><span class="p">}</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">target</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_mcp_gateway_target</span><span class="p">(</span>
    <span class="n">gateway</span><span class="o">=</span><span class="n">gateway</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;CustomCalculator&quot;</span><span class="p">,</span>
    <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;lambda&quot;</span><span class="p">,</span>
    <span class="n">target_payload</span><span class="o">=</span><span class="n">target_payload</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úì Custom Lambda target added: </span><span class="si">{</span><span class="n">target</span><span class="p">[</span><span class="s1">&#39;targetId&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Run &#39;python run_agent.py&#39; and try: &#39;Calculate the sum of 42 and 58&#39;&quot;</span><span class="p">)</span>
</code></pre></div>

Run: `python create_custom_lambda.py` then `python run_agent.py` to test.

</details>

<p>If you're excited and want to learn more about Gateways and the other Target types. Continue through this guide.</p>
<h2 id="adding-your-own-apis">Adding Your Own APIs<a class="headerlink" href="#adding-your-own-apis" title="Permanent link">&para;</a></h2>
<h3 id="nasa-api-integration">NASA API Integration<a class="headerlink" href="#nasa-api-integration" title="Permanent link">&para;</a></h3>
<p>Integrate real APIs like NASA‚Äôs Astronomy Picture of the Day. Get your API key from https://api.nasa.gov/ (instant via email), then create <code>add_nasa_api.py</code>:</p>
<p>This example shows how to add external REST APIs to your Gateway, making them available as tools for your agent.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">bedrock_agentcore_starter_toolkit.operations.gateway.client</span><span class="w"> </span><span class="kn">import</span> <span class="n">GatewayClient</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;gateway_config.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">GatewayClient</span><span class="p">(</span><span class="n">region_name</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">])</span>

<span class="n">nasa_spec</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;openapi&quot;</span><span class="p">:</span> <span class="s2">&quot;3.0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;NASA API&quot;</span><span class="p">,</span> <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">},</span>
    <span class="s2">&quot;servers&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://api.nasa.gov&quot;</span><span class="p">}],</span>
    <span class="s2">&quot;paths&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;/planetary/apod&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;get&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;operationId&quot;</span><span class="p">:</span> <span class="s2">&quot;getAstronomyPictureOfDay&quot;</span><span class="p">,</span>
                <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="s2">&quot;Get NASA&#39;s Astronomy Picture of the Day&quot;</span><span class="p">,</span>
                <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;in&quot;</span><span class="p">:</span> <span class="s2">&quot;query&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">},</span>
                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Date in YYYY-MM-DD format&quot;</span>
                    <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;responses&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;200&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Success&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;application/json&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="p">{</span>
                                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                                        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">},</span>
                                        <span class="s2">&quot;explanation&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">},</span>
                                        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">}</span>
                                    <span class="p">}</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">gateway</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_gateway</span><span class="p">(</span><span class="n">gatewayIdentifier</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;gateway_id&quot;</span><span class="p">])</span>

<span class="n">nasa_target</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_mcp_gateway_target</span><span class="p">(</span>
    <span class="n">gateway</span><span class="o">=</span><span class="n">gateway</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;NasaApi&quot;</span><span class="p">,</span>
    <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;openApiSchema&quot;</span><span class="p">,</span>
    <span class="n">target_payload</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;inlinePayload&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">nasa_spec</span><span class="p">)},</span>
    <span class="n">credentials</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;api_key&quot;</span><span class="p">:</span> <span class="s2">&quot;YOUR_NASA_API_KEY&quot;</span><span class="p">,</span>  <span class="c1"># Replace with your key</span>
        <span class="s2">&quot;credential_location&quot;</span><span class="p">:</span> <span class="s2">&quot;QUERY_PARAMETER&quot;</span><span class="p">,</span>
        <span class="s2">&quot;credential_parameter_name&quot;</span><span class="p">:</span> <span class="s2">&quot;api_key&quot;</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úì NASA API added! Try: &#39;Get NASA&#39;s astronomy picture for 2024-12-25&#39;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Run &#39;python run_agent.py&#39; and try: &#39;Get NASA&#39;s astronomy picture for 2024-12-25&#39;&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="adding-openapi-targets">Adding OpenAPI Targets<a class="headerlink" href="#adding-openapi-targets" title="Permanent link">&para;</a></h3>
<p>Let's add an OpenAPI target. This code uses the OpenAPI schema for a NASA API that provides Mars weather information. You can get an API key sent to your email in a minute by filling out the form here: https://api.nasa.gov/.</p>
<p><strong>Open API Spec for NASA Mars weather API</strong></p>
<div style="max-height: 200px; overflow: auto;">

<div class="highlight"><pre><span></span><code><span class="n">nasa_open_api_payload</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;openapi&quot;</span><span class="p">:</span> <span class="s2">&quot;3.0.3&quot;</span><span class="p">,</span>
  <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;NASA InSight Mars Weather API&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Returns per‚ÄëSol weather summaries from the InSight lander for the seven most recent Martian sols.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;servers&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://api.nasa.gov&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;paths&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;/insight_weather/&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;get&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="s2">&quot;Retrieve latest InSight Mars weather data&quot;</span><span class="p">,</span>
        <span class="s2">&quot;operationId&quot;</span><span class="p">:</span> <span class="s2">&quot;getInsightWeather&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;feedtype&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in&quot;</span><span class="p">:</span> <span class="s2">&quot;query&quot;</span><span class="p">,</span>
            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Response format (only </span><span class="se">\&quot;</span><span class="s2">json</span><span class="se">\&quot;</span><span class="s2"> is supported).&quot;</span><span class="p">,</span>
            <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
              <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;json&quot;</span>
              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ver&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in&quot;</span><span class="p">:</span> <span class="s2">&quot;query&quot;</span><span class="p">,</span>
            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;API version string. (only </span><span class="se">\&quot;</span><span class="s2">1.0</span><span class="se">\&quot;</span><span class="s2"> supported)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
              <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;1.0&quot;</span>
              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;responses&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;200&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Successful response ‚Äì weather data per Martian sol.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;application/json&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;#/components/schemas/InsightWeatherResponse&quot;</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">&quot;400&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Bad request ‚Äì missing or invalid parameters.&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;429&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Too many requests ‚Äì hourly rate limit exceeded (2‚ÄØ000 hits/IP).&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;500&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Internal server error.&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;components&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;schemas&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;InsightWeatherResponse&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;sol_keys&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Top‚Äëlevel object keyed by sol numbers plus metadata.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;sol_keys&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;List of sols (as strings) included in this payload.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">&quot;validity_checks&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
            <span class="s2">&quot;additionalProperties&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;#/components/schemas/ValidityCheckPerSol&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Data‚Äëquality provenance per sol and sensor.&quot;</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;additionalProperties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;oneOf&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;#/components/schemas/SolWeather&quot;</span>
            <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;SolWeather&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;AT&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;#/components/schemas/SensorData&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;HWS&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;#/components/schemas/SensorData&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;PRE&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;#/components/schemas/SensorData&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;WD&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;#/components/schemas/WindDirection&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;Season&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
            <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="s2">&quot;winter&quot;</span><span class="p">,</span>
              <span class="s2">&quot;spring&quot;</span><span class="p">,</span>
              <span class="s2">&quot;summer&quot;</span><span class="p">,</span>
              <span class="s2">&quot;fall&quot;</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="s2">&quot;First_UTC&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;date-time&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;Last_UTC&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;date-time&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;SensorData&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;av&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;ct&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;mn&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;mx&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;WindDirection&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;most_common&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;#/components/schemas/WindCompassPoint&quot;</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;additionalProperties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;#/components/schemas/WindCompassPoint&quot;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;WindCompassPoint&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;compass_degrees&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;compass_point&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;compass_right&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;compass_up&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;ct&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;ValidityCheckPerSol&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;AT&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;#/components/schemas/SensorValidity&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;HWS&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;#/components/schemas/SensorValidity&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;PRE&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;#/components/schemas/SensorValidity&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;WD&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;#/components/schemas/SensorValidity&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;SensorValidity&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;sol_hours_with_data&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
            <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
              <span class="s2">&quot;minimum&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
              <span class="s2">&quot;maximum&quot;</span><span class="p">:</span> <span class="mi">23</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p><br/></p>
<p>Use the following code to add an Open API target.
<strong>Note: don't forget to add your api_key below.</strong>
<div class="highlight"><pre><span></span><code><span class="n">open_api_target</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_mcp_gateway_target</span><span class="p">(</span>
    <span class="n">gateway</span><span class="o">=</span><span class="n">gateway</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;openApiSchema&quot;</span><span class="p">,</span>
    <span class="c1"># the API spec to use (note don&#39;t forget to )</span>
    <span class="n">target_payload</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;inlinePayload&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">nasa_open_api_payload</span><span class="p">)</span>
<span class="hll">    <span class="p">},</span>
</span>    <span class="c1"># the credentials to use when interacting with this API</span>
    <span class="n">credentials</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;api_key&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT KEY&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;credential_location&quot;</span><span class="p">:</span> <span class="s2">&quot;QUERY_PARAMETER&quot;</span><span class="p">,</span>
        <span class="s2">&quot;credential_parameter_name&quot;</span><span class="p">:</span> <span class="s2">&quot;api_key&quot;</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre></div></p>
<details>
<summary>
<strong> ‚û°Ô∏è Advanced OpenAPI Configurations (Import API specs from S3 + set up APIs with OAuth)
</strong>
</summary>
You can also use an OpenAPI specification stored in S3 buckets by passing the following `target_payload` field. **‚ö†Ô∏è Note don't forget to fill in the S3 URI below.**
<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT S3 URI&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

If you have an API that uses a key stored in a header value you can set the `credentials` field to the following.
**Note don't forget to fill in the api key and parameter name below.**
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="hll"><span class="w">    </span><span class="nt">&quot;api_key&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;INSERT KEY&gt;&quot;</span><span class="p">,</span>
</span><span class="w">    </span><span class="nt">&quot;credential_location&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HEADER&quot;</span><span class="p">,</span>
<span class="hll"><span class="w">    </span><span class="nt">&quot;credential_parameter_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;INSERT HEADER VALUE&gt;&quot;</span>
</span><span class="p">}</span>
</code></pre></div>

Alternatively if you have an API that uses OAuth, set the `credentials` field to the following. **‚ö†Ô∏è Note don't forget to fill in all of the information below.**
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;oauth2_provider_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;customOauth2ProviderConfig&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;oauthDiscovery&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;authorizationServerMetadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">          </span><span class="nt">&quot;issuer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;INSERT ISSUER URL&gt;&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;authorizationEndpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;INSERT AUTHORIZATION ENDPOINT&gt;&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">          </span><span class="nt">&quot;tokenEndpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;INSERT TOKEN ENDPOINT&gt;&quot;</span>
</span><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><span class="hll"><span class="w">      </span><span class="p">},</span>
</span><span class="hll"><span class="w">      </span><span class="nt">&quot;clientId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;INSERT CLIENT ID&gt;&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="w">      </span><span class="nt">&quot;clientSecret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;INSERT CLIENT SECRET&gt;&quot;</span>
</span><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
There are other supported `oauth_2_provider` types including Microsoft, GitHub, Google, Salesforce, and Slack. For information on the structure of those provider configs see the [identity documentation](https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/identity-idps.html).
</details>

<h3 id="adding-smithy-api-model-targets">Adding Smithy API Model Targets<a class="headerlink" href="#adding-smithy-api-model-targets" title="Permanent link">&para;</a></h3>
<p>Let's add a Smithy API model target. Many AWS services use Smithy API models to describe their APIs. <a href="https://github.com/aws/api-models-aws/tree/main/models">This AWS-maintained GitHub repository</a> has over the models of 350+ AWS services for download. For quick testing, we've made it possible to use a few of these models in the AgentCore Gateway without downloading them or storing them in S3. To create a Smithy API model target for DynamoDB simply run:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># create a Smithy API model target for DynamoDB</span>
<span class="n">smithy_target</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_mcp_gateway_target</span><span class="p">(</span><span class="n">gateway</span><span class="o">=</span><span class="n">gateway</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;smithyModel&quot;</span><span class="p">)</span>
</code></pre></div>
<details>
<summary>
<strong> ‚û°Ô∏è Add more Smithy API model targets</strong>
</summary>

Create a Smithy API model target from a Smithy API model stored in S3. **‚ö†Ô∏è Note don't forget to fill in the S3 URI below.**
<div class="highlight"><pre><span></span><code><span class="c1"># create a Smithy API model target from a Smithy API model stored in S3</span>
<span class="n">open_api_target</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_mcp_gateway_target</span><span class="p">(</span>
    <span class="n">gateway</span><span class="o">=</span><span class="n">gateway</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;smithyModel&quot;</span><span class="p">,</span>
    <span class="n">target_payload</span><span class="o">=</span><span class="p">{</span>
<span class="hll">        <span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="p">{</span>
</span>            <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT S3 URI&gt;&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="p">)</span>
</code></pre></div>

Create a Smithy API model target from a Smithy API model inline. **‚ö†Ô∏è Note don't forget to load the Smithy model JSON into the smithy_model_json variable.**
<div class="highlight"><pre><span></span><code><span class="c1"># create a Smithy API model target from a Smithy API model stored in S3</span>
<span class="n">open_api_target</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_mcp_gateway_target</span><span class="p">(</span>
    <span class="n">gateway</span><span class="o">=</span><span class="n">gateway</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">target_type</span><span class="o">=</span><span class="s2">&quot;smithyModel&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">target_payload</span><span class="o">=</span><span class="p">{</span>
</span>        <span class="s2">&quot;inlinePayload&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">smithy_model_json</span><span class="p">)</span>
    <span class="p">},</span>
<span class="p">)</span>
</code></pre></div>
</details>
<p><br/></p>
<details>
<summary><h2 style="display:inline">‚û°Ô∏è More Operations on Gateways and Targets (Create, Read, Update, Delete, List) </h2></summary>


<details>
<summary>Advanced: AWS PrivateLink for VPC Connectivity</summary>

Create private connection between your VPC and Gateway:

<div class="highlight"><pre><span></span><code>aws<span class="w"> </span>ec2<span class="w"> </span>create-vpc-endpoint<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vpc-id<span class="w"> </span>vpc-12345678<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--service-name<span class="w"> </span>com.amazonaws.region.bedrock-agentcore.gateway
</code></pre></div>

</details>

While the Starter Toolkit makes it easy to get started, the Boto3 Python client has a more complete set of operations including those for creating, reading, updating, deleting, and listing Gateways and Targets. Let's see how to use Boto3 to carry out these operations on Gateways and Targets.

### Setup

Instantiate the client
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>

<span class="n">boto_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;bedrock-agentcore-control&quot;</span><span class="p">,</span>
                           <span class="n">region_name</span><span class="o">=</span><span class="s2">&quot;us-east-1&quot;</span><span class="p">)</span>
</code></pre></div>

### Listing Gateways/Targets
Run the below code to list all of the Gateways in your account.
<div class="highlight"><pre><span></span><code><span class="c1"># list gateawys</span>
<span class="n">gateways</span> <span class="o">=</span> <span class="n">boto_client</span><span class="o">.</span><span class="n">list_gateways</span><span class="p">()</span>
</code></pre></div>
Run the below code to list all of the Gateway Targets for a specific Gateway.
<div class="highlight"><pre><span></span><code><span class="c1"># list targets</span>
<span class="n">gateway_targets</span> <span class="o">=</span> <span class="n">boto_client</span><span class="o">.</span><span class="n">list_gateway_targets</span><span class="p">(</span><span class="n">gatewayIdentifier</span><span class="o">=</span><span class="s2">&quot;&lt;INSERT GATEWAY ID&gt;&quot;</span><span class="p">)</span>
</code></pre></div>

### Getting Gateways/Targets
Run the below code to get the details of a Gateway
<div class="highlight"><pre><span></span><code><span class="c1"># get a gateway</span>
<span class="n">gateway_details</span> <span class="o">=</span> <span class="n">boto_client</span><span class="o">.</span><span class="n">get_gateway</span><span class="p">(</span><span class="n">gatewayIdentifier</span><span class="o">=</span><span class="s2">&quot;&lt;INSERT GATEWAY ID&gt;&quot;</span><span class="p">)</span>
</code></pre></div>
Run the below code to get the details of a Gateway Target.
<div class="highlight"><pre><span></span><code><span class="c1"># get a target</span>
<span class="n">target_details</span> <span class="o">=</span> <span class="n">boto_client</span><span class="o">.</span><span class="n">get_gateway_target</span><span class="p">(</span><span class="n">gatewayIdentifier</span><span class="o">=</span><span class="s2">&quot;&lt;INSERT GATEWAY ID&gt;&quot;</span><span class="p">,</span> <span class="n">targetId</span><span class="o">=</span><span class="s2">&quot;INSERT TARGET ID&quot;</span><span class="p">)</span>
</code></pre></div>

### Creating / Updating Gateways

Let's see how to create a Gateway. **‚ö†Ô∏è Note don't forget to fill in the required fields with appropriate values.**

Below is the structure of a create request for a Gateway:
<div class="highlight"><pre><span></span><code><span class="c1"># the schema of a create request for a Gateway</span>
<span class="n">create_gw_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - name of your gateway</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># optional - description of your gateway</span>
    <span class="s2">&quot;clientToken&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># optional - used for idempotency</span>
    <span class="s2">&quot;roleArn&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - execution role arn that Gateway will use when interacting with AWS resources</span>
    <span class="s2">&quot;protocolType&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - must be MCP</span>
    <span class="s2">&quot;protocolConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># optional</span>
        <span class="s2">&quot;mcp&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;supportedVersions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;enum_string&quot;</span><span class="p">],</span> <span class="c1"># optional - e.g. 2025-06-18</span>
            <span class="s2">&quot;instructions&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># optional - instructions for agents using this MCP server</span>
            <span class="s2">&quot;searchType&quot;</span><span class="p">:</span> <span class="s2">&quot;enum_string&quot;</span> <span class="c1"># optional - must be SEMANTIC if specified. This enables the tool search tool</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;authorizerType&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - must be CUSTOM_JWT</span>
    <span class="s2">&quot;authorizerConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># required - the configuration for your authorizer</span>
        <span class="s2">&quot;customJWTAuthorizer&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># required the custom JWT authorizer setup</span>
            <span class="s2">&quot;allowedAudience&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="c1"># optional</span>
            <span class="s2">&quot;allowedClients&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="c1"># optional</span>
            <span class="s2">&quot;discoveryUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="c1"># required - the URL of the authorization server</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;kmsKeyArn&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># optional - an encryption key to use for encrypting your tool metadata stored on Gateway</span>
    <span class="s2">&quot;exceptionLevel&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># optional - must be DEBUG if specified. Gateway will return verbose error messages when DEBUG is specified.</span>
<span class="p">}</span>
</code></pre></div>

Let's take a look at a simpler example:
<div class="highlight"><pre><span></span><code><span class="c1"># an example of a create request</span>
<span class="n">example_create_gw_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;TestGateway&quot;</span><span class="p">,</span>
    <span class="s2">&quot;roleArn&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT ROLE ARN e.g. arn:aws:iam::123456789012:role/Admin&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;protocolType&quot;</span><span class="p">:</span> <span class="s2">&quot;MCP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;authorizerType&quot;</span><span class="p">:</span> <span class="s2">&quot;CUSTOM_JWT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;authorizerConfiguration&quot;</span><span class="p">:</span>  <span class="p">{</span>
        <span class="s2">&quot;customJWTAuthorizer&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;discoveryUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT DISCOVERY URL e.g. https://cognito-idp.</span><span class="si">{region}</span><span class="s2">.amazonaws.com/</span><span class="si">{user_pool_id}</span><span class="s2">/.well-known/openid-configuration&gt;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;allowedClients&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;INSERT CLIENT ID&gt;&quot;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Once you have filled in your request details, you can create a Gateway from that request with the following command:
<div class="highlight"><pre><span></span><code><span class="c1"># create the gateway</span>
<span class="n">gateway</span> <span class="o">=</span> <span class="n">boto_client</span><span class="o">.</span><span class="n">create_gateway</span><span class="p">(</span><span class="o">**</span><span class="n">example_create_gw_request</span><span class="p">)</span>
</code></pre></div>

Now let's see how to update a Gateway that we've already created. **‚ö†Ô∏è Note don't forget to fill in the required fields with appropriate values.**

Below is the structure of an update request for a Gateway:
<div class="highlight"><pre><span></span><code><span class="c1"># the schema of an update request for a Gateway</span>
<span class="n">update_gw_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;gatewayIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - the ID of the existing gateway</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - name of your gateway</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># optional - description of your gateway</span>
    <span class="s2">&quot;roleArn&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - execution role arn that Gateway will use when interacting with AWS resources</span>
    <span class="s2">&quot;protocolType&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - must be MCP</span>
    <span class="s2">&quot;protocolConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># optional</span>
        <span class="s2">&quot;mcp&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;supportedVersions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;enum_string&quot;</span><span class="p">],</span> <span class="c1"># optional - e.g. 2025-06-18</span>
            <span class="s2">&quot;instructions&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># optional - instructions for agents using this MCP server</span>
            <span class="s2">&quot;searchType&quot;</span><span class="p">:</span> <span class="s2">&quot;enum_string&quot;</span> <span class="c1"># optional - must be SEMANTIC if specified. This enables the tool search tool</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;authorizerType&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - must be CUSTOM_JWT</span>
    <span class="s2">&quot;authorizerConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># required - the configuration for your authorizer</span>
        <span class="s2">&quot;customJWTAuthorizer&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># required the custom JWT authorizer setup</span>
            <span class="s2">&quot;allowedAudience&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="c1"># optional</span>
            <span class="s2">&quot;allowedClients&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="c1"># optional</span>
            <span class="s2">&quot;discoveryUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="c1"># required - the URL of the authorization server</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;kmsKeyArn&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># optional - an encryption key to use for encrypting your tool metadata stored on Gateway</span>
<span class="p">}</span>
</code></pre></div>

Let's take a look at a simpler example:
<div class="highlight"><pre><span></span><code><span class="c1"># an example of an update request</span>
<span class="n">example_update_gw_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;gatewayIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT ID OF CREATED GATEWAY&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;TestGateway&quot;</span><span class="p">,</span>
    <span class="s2">&quot;roleArn&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT ROLE ARN e.g. arn:aws:iam::123456789012:role/Admin&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;protocolType&quot;</span><span class="p">:</span> <span class="s2">&quot;MCP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;authorizerType&quot;</span><span class="p">:</span> <span class="s2">&quot;CUSTOM_JWT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;authorizerConfiguration&quot;</span><span class="p">:</span>  <span class="p">{</span>
        <span class="s2">&quot;customJWTAuthorizer&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;discoveryUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT DISCOVERY URL e.g. https://cognito-idp.</span><span class="si">{region}</span><span class="s2">.amazonaws.com/</span><span class="si">{user_pool_id}</span><span class="s2">/.well-known/openid-configuration&gt;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;allowedClients&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;INSERT CLIENT ID&gt;&quot;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

Once you've filled in you request details you can update a Gateway using that request with the following command:
<div class="highlight"><pre><span></span><code><span class="c1"># update the gateway</span>
<span class="n">gateway</span> <span class="o">=</span> <span class="n">boto_client</span><span class="o">.</span><span class="n">update_gateway</span><span class="p">(</span><span class="o">**</span><span class="n">example_update_gw_request</span><span class="p">)</span>
</code></pre></div>

### Creating / Updating Targets

Let's see how to create a Gateway Target. **‚ö†Ô∏è Note don't forget to fill in the required fields with appropriate values.**

Below is the structure of a create request for a Gateway Target:
<div class="highlight"><pre><span></span><code><span class="c1"># the schema of a create request for a Gateway Target</span>
<span class="n">create_target_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;gatewayIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - the ID of the Gateway to create this target on</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># optional - description of your target</span>
    <span class="s2">&quot;clientToken&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># optional - used for idempotency</span>
    <span class="s2">&quot;targetConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># required</span>
        <span class="s2">&quot;mcp&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># required - union - choose one of openApiSchema | smithyModel | lambda</span>
            <span class="s2">&quot;openApiSchema&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># union - choose one of either s3 or inlinePayload</span>
                <span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;bucketOwnerAccountId&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;inlinePayload&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;smithyModel&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># union - choose one of either s3 or inlinePayload</span>
                <span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;bucketOwnerAccountId&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;inlinePayload&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;lambda&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;lambdaArn&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                <span class="s2">&quot;toolSchema&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># union - choose one of either s3 or inlinePayload</span>
                    <span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;bucketOwnerAccountId&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                     <span class="p">},</span>
                    <span class="s2">&quot;inlinePayload&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="c1"># &lt;inline tool here&gt;</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;credentialProviderConfigurations&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;credentialProviderType&quot;</span><span class="p">:</span> <span class="s2">&quot;enum_string&quot;</span><span class="p">,</span> <span class="c1"># required - choose one of OAUTH | API_KEY | GATEWAY_IAM_ROLE</span>
            <span class="s2">&quot;credentialProvider&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># optional (required if you choose OAUTH or API_KEY) - union - choose either apiKeyCredentialProvider | oauthCredentialProvider</span>
                <span class="s2">&quot;oauthCredentialProvider&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;providerArn&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - the ARN of the credential provider</span>
                    <span class="s2">&quot;scopes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">],</span> <span class="c1"># required - can be empty list in some cases</span>
                <span class="p">},</span>
                <span class="s2">&quot;apiKeyCredentialProvider&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;providerArn&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - the ARN of the credential provider</span>
                    <span class="s2">&quot;credentialLocation&quot;</span><span class="p">:</span> <span class="s2">&quot;enum_string&quot;</span><span class="p">,</span> <span class="c1"># required - the location where the credential goes - choose HEADER | QUERY_PARAMETER</span>
                    <span class="s2">&quot;credentialParameterName&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - the header key or parameter name e.g., ‚ÄúAuthorization‚Äù, ‚ÄúX-API-KEY‚Äù</span>
                    <span class="s2">&quot;credentialPrefix&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>  <span class="c1"># optional - the prefix the auth token needs e.g. ‚ÄúBearer‚Äù</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>

Let's take a look at a simpler example:
<div class="highlight"><pre><span></span><code><span class="c1"># example of a target creation request</span>
<span class="n">example_create_target_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;gatewayIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT GATEWAY ID&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;TestLambdaTarget&quot;</span><span class="p">,</span>
    <span class="s2">&quot;targetConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;mcp&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;lambda&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;lambdaArn&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT LAMBDA ARN e.g. arn:aws:lambda:us-west-2:123456789012:function:TestLambda&gt;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;toolSchema&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT S3 URI&gt;&quot;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;credentialProvider&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;credentialProviderType&quot;</span><span class="p">:</span> <span class="s2">&quot;GATEWAY_IAM_ROLE&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
Once you've filled in you request details you can create a Gateway Target using that request with the following command:
<div class="highlight"><pre><span></span><code><span class="c1"># create the target</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">boto_client</span><span class="o">.</span><span class="n">create_gateway_target</span><span class="p">(</span><span class="o">**</span><span class="n">example_create_target_request</span><span class="p">)</span>
</code></pre></div>

Now let's see how to update a Gateway Target. **‚ö†Ô∏è Note don't forget to fill in the required fields with appropriate values.**

Below is the structure of an update request for a Target:
<div class="highlight"><pre><span></span><code><span class="c1"># create a target</span>
<span class="n">update_target_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;gatewayIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - the ID of the Gateway to update this target on</span>
    <span class="s2">&quot;targetId&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - the ID of the target to update</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># optional - description of your target</span>
    <span class="s2">&quot;targetConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># required</span>
        <span class="s2">&quot;mcp&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># required - union - choose one of openApiSchema | smithyModel | lambda</span>
            <span class="s2">&quot;openApiSchema&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># union - choose one of either s3 or inlinePayload</span>
                <span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;bucketOwnerAccountId&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;inlinePayload&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;smithyModel&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># union - choose one of either s3 or inlinePayload</span>
                <span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;bucketOwnerAccountId&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;inlinePayload&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;lambda&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;lambdaArn&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                <span class="s2">&quot;toolSchema&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># union - choose one of either s3 or inlinePayload</span>
                    <span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;bucketOwnerAccountId&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                     <span class="p">},</span>
                    <span class="s2">&quot;inlinePayload&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="c1"># &lt;inline tool here&gt;</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;credentialProviderConfigurations&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;credentialProviderType&quot;</span><span class="p">:</span> <span class="s2">&quot;enum_string&quot;</span><span class="p">,</span> <span class="c1"># required - choose one of OAUTH | API_KEY | GATEWAY_IAM_ROLE</span>
            <span class="s2">&quot;credentialProvider&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># optional (required if you choose OAUTH or API_KEY) - union - choose either apiKeyCredentialProvider | oauthCredentialProvider</span>
                <span class="s2">&quot;oauthCredentialProvider&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;providerArn&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required</span>
                    <span class="s2">&quot;scopes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">],</span> <span class="c1"># required - can be empty list in some cases</span>
                <span class="p">},</span>
                <span class="s2">&quot;apiKeyCredentialProvider&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;providerArn&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required</span>
                    <span class="s2">&quot;credentialLocation&quot;</span><span class="p">:</span> <span class="s2">&quot;enum_string&quot;</span><span class="p">,</span> <span class="c1"># required - the location where the credential goes - choose HEADER | QUERY_PARAMETER</span>
                    <span class="s2">&quot;credentialParameterName&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="c1"># required - the header key or parameter name e.g., ‚ÄúAuthorization‚Äù, ‚ÄúX-API-KEY‚Äù</span>
                    <span class="s2">&quot;credentialPrefix&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>  <span class="c1"># optional - the prefix the auth token needs e.g. ‚ÄúBearer‚Äù</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
Let's take a look at a simpler example:
<div class="highlight"><pre><span></span><code><span class="n">example_update_target_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;gatewayIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT GATEWAY ID&quot;</span><span class="p">,</span>
    <span class="s2">&quot;targetId&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT TARGET ID&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;TestLambdaTarget&quot;</span><span class="p">,</span>
    <span class="s2">&quot;targetConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;mcp&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;lambda&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;lambdaArn&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT LAMBDA ARN e.g. arn:aws:lambda:us-west-2:123456789012:function:TestLambda&gt;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;toolSchema&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;INSERT S3 URI&gt;&quot;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;credentialProvider&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;credentialProviderType&quot;</span><span class="p">:</span> <span class="s2">&quot;GATEWAY_IAM_ROLE&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
Once you've filled in you request details you can create a Target using that request with the following command:
<div class="highlight"><pre><span></span><code><span class="c1"># update a target</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">boto_client</span><span class="o">.</span><span class="n">update_gateway_target</span><span class="p">(</span><span class="o">**</span><span class="n">example_update_target_request</span><span class="p">)</span>
</code></pre></div>


### Deleting Gateways / Targets
Run the below code to delete a Gateway.
<div class="highlight"><pre><span></span><code><span class="c1"># delete a gateway</span>
<span class="n">delete_gateway_response</span> <span class="o">=</span> <span class="n">boto_client</span><span class="o">.</span><span class="n">delete_gateway</span><span class="p">(</span>
    <span class="n">gatewayIdentifier</span><span class="o">=</span><span class="s2">&quot;&lt;INSERT GATEWAY ID&gt;&quot;</span>
<span class="p">)</span>
</code></pre></div>

Run the below code to delete a Gateway Target.
<div class="highlight"><pre><span></span><code><span class="c1"># delete a target</span>
<span class="n">delete_target_response</span> <span class="o">=</span> <span class="n">boto_client</span><span class="o">.</span><span class="n">delete_gateway_target</span><span class="p">(</span>
    <span class="n">gatewayIdentifier</span><span class="o">=</span><span class="s2">&quot;&lt;INSERT GATEWAY ID&gt;&quot;</span><span class="p">,</span>
    <span class="n">targetId</span><span class="o">=</span><span class="s2">&quot;&lt;INSERT TARGET ID&gt;&quot;</span>
<span class="p">)</span>
</code></pre></div>
</details>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>